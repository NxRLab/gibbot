(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    270793,       5807]
NotebookOptionsPosition[    269010,       5748]
NotebookOutlinePosition[    269383,       5764]
CellTagsIndexPosition[    269340,       5761]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["GibbotQnts Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.6289934659285192`*^9, 3.6289934747067785`*^9}, 3.629089629414613*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<GibbotQnts`\>\"", "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"DynamicQnts", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"DynamicQnts", "::", "usage"}], " ", "=", " ", 
      "\"\<Based on which magnet is on, state of the robot, and input torque, \
this function outputs the robot's acceleration and tangential forces felt by \
magnets on each link.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"ImpactQnts", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"ImpactQnts", "::", "usage"}], " ", "=", " ", 
      "\"\<Based on which magnet is on and the state of the robot, this \
function outputs the robot's post-impact velocity and tangential impulsive \
forces felt by magnets on each link.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MotorInput", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MotorInput", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns input torque u such that b.qdd \[Equal] 0.  b can be a \
vector or a matrix.  This function is useful if computing a (partial) \
feedback linearization term.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"FreeFlightVelocity", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"FreeFlightVelocity", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns velocity of robot at the beginning of free flight required \
to travel a horizontal distance \[CapitalDelta]x at a maximum height of \
\[CapitalDelta]y given configuration q.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MinimizeFreeFlight", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MinimizeFreeFlight", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns state that minimumizes velocity satisfying free flight \
required to travel a horizontal distance \[CapitalDelta]x at a maximum height \
of \[CapitalDelta]y.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MaximizeFreeFlight", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MaximizeFreeFlight", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns state that maximumizes velocity satisfying free flight \
required to travel a horizontal distance \[CapitalDelta]x at a maximum height \
of \[CapitalDelta]y.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"PE", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"PE", "::", "usage"}], " ", "=", " ", 
     "\"\<Potential Energy.\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"KE", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"KE", "::", "usage"}], " ", "=", " ", 
     "\"\<Kinetic Energy.\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"TE", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"TE", "::", "usage"}], " ", "=", " ", 
      "\"\<Total Energy.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"DrawGibbot", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"DrawGibbot", "::", "usage"}], " ", "=", " ", 
      "\"\<Draws the Gibbot.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"g", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"g", "::", "usage"}], " ", "=", " ", "\"\<gravity\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"m1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"m1", "::", "usage"}], " ", "=", " ", 
     "\"\<mass of link 1\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"m2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"m2", "::", "usage"}], " ", "=", " ", 
     "\"\<mass of link 2\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"I1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"I1", "::", "usage"}], " ", "=", " ", 
     "\"\<moment of inertia about com of link 1\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"I2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"I2", "::", "usage"}], " ", "=", " ", 
     "\"\<moment of inertia about com of link 2\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"r1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"r1", "::", "usage"}], " ", "=", " ", 
     "\"\<position of com of link 1\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"r2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"r2", "::", "usage"}], " ", "=", " ", 
     "\"\<position of com of link 2\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"L1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"L1", "::", "usage"}], " ", "=", " ", 
     "\"\<length of link 1\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"L2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"L2", "::", "usage"}], " ", "=", " ", 
     "\"\<length of link 2\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"T", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"T", "::", "usage"}], " ", "=", " ", 
      "\"\<mapping from motor torque to generalized forces\>\""}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"default", " ", "parameter", " ", "values"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", "=", " ", "9.81"}], ";"}], " ", 
  RowBox[{"(*", " ", "gravity", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1", " ", "=", " ", 
    RowBox[{"m2", " ", "=", " ", 
     RowBox[{"0.453592", " ", "4"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"lbs", " ", "to", " ", "kg"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1", " ", "=", " ", 
   RowBox[{"I2", " ", "=", " ", "0.04185679"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L1", " ", "=", " ", 
    RowBox[{"L2", " ", "=", " ", 
     RowBox[{"0.0254", " ", "9.5"}]}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"inches", " ", "to", " ", "m"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r1", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "0.7"}], ")"}], "L1"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"center", " ", "of", " ", "mass"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r2", " ", "=", " ", 
    RowBox[{"0.7", "L2"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"center", " ", "of", " ", "mass"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], " ",
    ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "transmission", " ", "matrix", " ", "from", " ", "motor", " ", "to", " ", 
     "robot"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Protect", "[", 
      RowBox[{
      "g", ",", " ", "m1", ",", " ", "I1", ",", " ", "I2", ",", " ", "L1", 
       ",", " ", "L2", ",", " ", "r1", ",", " ", "r2", ",", " ", "T"}], "]"}],
      ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", "c4", ",", " ", "c34", ",", " ", "s34", ",", " ",
         "A", ",", " ", "B", ",", " ", "C"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"m1", "+", "m2"}], "0"},
            {"0", 
             RowBox[{"m1", "+", "m2"}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B", " ", "=", " ", 
        TagBox[
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{
               RowBox[{"c3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L1", " ", "m2"}], "+", 
                  RowBox[{"m1", " ", "r1"}]}], ")"}]}], "+", 
               RowBox[{"c34", " ", "m2", " ", "r2"}]}], 
              RowBox[{"c34", " ", "m2", " ", "r2"}]},
             {
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L1", " ", "m2"}], "+", 
                  RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
               RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
              RowBox[{"m2", " ", "r2", " ", "s34"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"I1", "+", "I2", "+", 
             RowBox[{
              SuperscriptBox["L1", "2"], " ", "m2"}], "+", 
             RowBox[{"m1", " ", 
              SuperscriptBox["r1", "2"]}], "+", 
             RowBox[{"2", " ", "c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}], 
            RowBox[{"I2", "+", 
             RowBox[{"c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}]},
           {
            RowBox[{"I2", "+", 
             RowBox[{"c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}], 
            RowBox[{"I2", "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", " ", "B"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"B", "\[Transpose]"}], ",", " ", "C"}], "}"}]}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c3", ",", "s3", ",", "s4", ",", " ", "c34", ",", " ", "s34"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s4", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", 
         TagBox[GridBox[{
            {
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "m1", " ", "r1", " ", "s3", " ", 
                 SuperscriptBox[
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
                   "2"]}], "+", 
                RowBox[{"2", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "L1"}], " ", "s3", " ", 
                    SuperscriptBox[
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "-", 
                   RowBox[{"r2", " ", "s34", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "8", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
               ")"}]}]},
            {
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", "m2"}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "m1", " ", "r1", " ", "c3", " ", 
                  SuperscriptBox[
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "+", 
                 RowBox[{"2", " ", "m2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "c3", " ", 
                    SuperscriptBox[
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "+", 
                    RowBox[{"r2", " ", "c34", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "8", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
                ")"}]}]}]},
            {
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"L1", " ", "m2", " ", "s3"}], "+", 
                 RowBox[{"m1", " ", "r1", " ", "s3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "s34"}]}], ")"}]}], "-", 
              RowBox[{"2", " ", "L1", " ", "m2", " ", "r2", " ", "s4", " ", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              "-", 
              RowBox[{"L1", " ", "m2", " ", "r2", " ", "s4", " ", 
               SuperscriptBox[
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
                "2"]}]}]},
            {
             RowBox[{"m2", " ", "r2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "s34"}], "+", 
                RowBox[{"L1", " ", "s4", " ", 
                 SuperscriptBox[
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
                   "2"]}]}], ")"}]}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.5599999999999999]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}],
          Column], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fext", "[", 
     RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{"T", " ", "u"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J1", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      TagBox[
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0", "0", "0"},
           {"0", "1", "0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", " ", 
      TagBox[
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", "0", "0"},
           {"0", "0", "0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J2", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34", ",", " ", "J", ",", 
        " ", "Jdot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3"}], "+", 
             RowBox[{"L2", " ", "c34"}]}], 
            RowBox[{"L2", " ", "c34"}]},
           {"0", "1", 
            RowBox[{
             RowBox[{"L1", " ", "s3"}], "+", 
             RowBox[{"L2", " ", "s34"}]}], 
            RowBox[{"L2", " ", "s34"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Jdot", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "s3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"L2", " ", "s34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{
             RowBox[{"-", "L2"}], " ", "s34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]},
           {"0", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{"L2", " ", "c34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{"L2", " ", "c34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"J", ",", " ", "Jdot"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J3", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34", ",", " ", "J", ",", 
        " ", "Jdot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0"},
            {"0", "1", "0", "0"},
            {"1", "0", 
             RowBox[{
              RowBox[{"L1", " ", "c3"}], "+", 
              RowBox[{"L2", " ", "c34"}]}], 
             RowBox[{"L2", " ", "c34"}]},
            {"0", "1", 
             RowBox[{
              RowBox[{"L1", " ", "s3"}], "+", 
              RowBox[{"L2", " ", "s34"}]}], 
             RowBox[{"L2", " ", "s34"}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jdot", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", "0", "0"},
           {"0", "0", "0", "0"},
           {"0", "0", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "s3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"L2", " ", "s34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{
             RowBox[{"-", "L2"}], " ", "s34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]},
           {"0", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{"L2", " ", "c34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{"L2", " ", "c34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"J", ",", " ", "Jdot"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dPcom", "[", 
     RowBox[{"mag_", ",", " ", "q_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", " ", "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dPcom", " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dq"}], " ", "Pcom"}]}], ",", " ", 
        RowBox[{
        "where", " ", "Pcom", " ", "is", " ", "the", " ", "center", " ", "of",
          " ", "mass", " ", "of", " ", "the", " ", 
         RowBox[{"robot", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"This", " ", "function", " ", "satisfies", " ", "vcom"}], 
         " ", "=", " ", 
         RowBox[{"dPcom", ".", 
          RowBox[{"qd", "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}]}]}], ",", " ", 
        RowBox[{"where", " ", "vcom", " ", "is", " ", "the"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "velocity", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
        "mass", " ", "when", " ", "the", " ", "robot", " ", "has", " ", 
        "only", " ", "one", " ", "magnet"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"on", " ", "and", " ", "qd"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"d", "/", "dt"}], " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", " ", ",", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"m1", " ", "+", " ", "m2"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"total", " ", "mass"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}], " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"m1", "+", "m2"}], "0", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"L1", " ", "m2"}], "+", 
                   RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "c3"}], "+", 
                RowBox[{"m2", " ", "r2", " ", "c34"}]}], 
               RowBox[{"m2", " ", "r2", " ", "c34"}]},
              {"0", 
               RowBox[{"m1", "+", "m2"}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"L1", " ", "m2"}], "+", 
                   RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
                RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
               RowBox[{"m2", " ", "r2", " ", "s34"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          TagBox[
           TagBox[
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "m2"}], "+", 
                    RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "c3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "c34"}]}], 
                RowBox[{"m2", " ", "r2", " ", "c34"}]},
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "m2"}], "+", 
                    RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
                RowBox[{"m2", " ", "r2", " ", "s34"}]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.7]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", 
          TagBox[
           RowBox[{" ", 
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "m1"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "r1"}], ")"}], " ", "c3"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}], " ", "c34"}]}], 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}]}], " ", "c34"}]},
                {
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "m1"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "r1"}], ")"}], " ", "s3"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}], " ", "s34"}]}], 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}]}], " ", "s34"}]}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", "True", ",",
           " ", 
          RowBox[{
          "Throw", "[", "\"\<Invalid magnet state for dPcom\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "position", " ", "of", " ", "center", " ", "of", " ", "masses", " ", "and",
     " ", "end", " ", "points", " ", "on", " ", "each", " ", "link"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P0", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{"q", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P0", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"r1", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "]"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P3", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"r2", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}],
        ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P0", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"L1", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "]"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P4", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"P3", "[", "q", "]"}], " ", "+", " ", 
     RowBox[{"L2", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
          "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "energy", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KE", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ".", 
     RowBox[{"M", "[", "x", "]"}], ".", 
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PE", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{"g", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m1", " ", 
        RowBox[{"P1", "[", "q", "]"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"P2", "[", "q", "]"}]}]}], ")"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TE", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"KE", "[", "x", "]"}], " ", "+", " ", 
     RowBox[{"PE", "[", "x", "]"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DynamicQnts", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "qdd", ",", " ", "\[Lambda]", ",", " ", 
        "J", ",", " ", "Jd", ",", " ", "Minv", ",", " ", "\[CapitalLambda]"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J3", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for DynamicQnts\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "velocity", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"forces", " ", "on", " ", "magnets"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fext", "[", 
            RowBox[{"x", ",", " ", "u"}], "]"}], " ", "-", " ", 
           RowBox[{"c", "[", "x", "]"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", "acceleration", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"J", ".", "Minv", ".", 
             RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"\[CapitalLambda]", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
               RowBox[{"J", ".", "qdd"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qdd", " ", "=", " ", 
           RowBox[{"qdd", " ", "+", " ", 
            RowBox[{"Minv", ".", 
             RowBox[{"J", "\[Transpose]"}], ".", "\[Lambda]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
             RowBox[{"PadRight", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}], ",", " ", 
             RowBox[{"PadLeft", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qdd", ",", " ", "\[Lambda]"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImpactQnts", "[", 
     RowBox[{"mag_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "J", ",", " ", "Minv", ",", " ", "v", 
        ",", " ", "\[Lambda]", ",", " ", "\[CapitalLambda]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J1", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J2", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J3", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for DynamicQnts\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"pre", "-", 
         RowBox[{"impact", " ", "velocity"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"impulsive", " ", "force", " ", "on", " ", "magnets"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", "qd"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"post", "-", 
         RowBox[{"impact", " ", "velocity"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"J", ".", "Minv", ".", 
             RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"\[CapitalLambda]", ".", "J", ".", "v"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"v", " ", "+", " ", 
            RowBox[{"Minv", ".", 
             RowBox[{"J", "\[Transpose]"}], ".", "\[Lambda]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
             RowBox[{"PadRight", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}], ",", " ", 
             RowBox[{"PadLeft", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "\[Lambda]"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MotorInput", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", "b_", ",", " ", 
      RowBox[{"v_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "J", ",", " ", "Jd", ",", " ", "Minv", 
        ",", " ", "zi", ",", " ", "zs", ",", " ", "\[CapitalLambda]"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "returns", " ", "input", " ", "torque", " ", "u", " ", "such", " ", 
          "that", " ", 
          RowBox[{"b", ".", "qdd"}]}], " ", "\[Equal]", " ", "du"}], ",", " ",
         "where"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "^", "2"}], "/", 
          RowBox[{"dt", "^", "2"}]}], " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", " ", ",", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], ".", " ", "This"}], " ", "can", " ", "be", 
         " ", "used", " ", "to", " ", "apply", " ", "feedback"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "linearization", " ", "when", " ", "using", " ", "the", " ", 
        "optional", " ", "parameter", " ", 
        RowBox[{"du", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J3", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for MotorInput\>\"", "]"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "velocity", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fext", "[", 
            RowBox[{"x", ",", " ", "0"}], "]"}], " ", "-", " ", 
           RowBox[{"c", "[", "x", "]"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"input", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"Minv", ".", "T"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"state", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", "=", " ", 
            RowBox[{"Inverse", "[", 
             RowBox[{"J", ".", "Minv", ".", 
              RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zi", " ", "=", " ", 
            RowBox[{"zi", " ", "-", " ", 
             RowBox[{"Minv", ".", 
              RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
                RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zs", " ", "=", " ", 
            RowBox[{"zs", " ", "-", " ", 
             RowBox[{"Minv", ".", 
              RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", 
              "J", ".", "zs"}]}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Minv", ".", 
            RowBox[{"J", "\[Transpose]"}], ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{"J", ".", "Minv", ".", 
              RowBox[{"J", "\[Transpose]"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zi", " ", "=", " ", 
           RowBox[{"zi", " ", "-", " ", 
            RowBox[{"\[CapitalLambda]", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
               RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"\[CapitalLambda]", ".", "J"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zs", " ", "=", " ", 
           RowBox[{"zs", " ", "-", " ", 
            RowBox[{"\[CapitalLambda]", ".", "zs"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "cancel", " ", "out", " ", "dynamics", " ", "and", " ", "add", " ", 
         "controller", " ", "v"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"b", ".", "zi"}]}], "/", 
         RowBox[{"b", ".", "zs"}]}], " ", "+", " ", 
        RowBox[{"v", "/", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", "b", "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"#", " ", "zs"}], "]"}], "&"}], "/@", " ", "b"}], ",", 
           " ", 
           RowBox[{"Norm", "[", 
            RowBox[{"b", " ", "zs"}], "]"}]}], "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FreeFlightVelocity", "[", 
     RowBox[{
     "mag_", ",", " ", "q_", ",", " ", "\[CapitalDelta]x_", ",", " ", 
      "\[CapitalDelta]y_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vcom", ",", " ", "\[Theta]d", ",", " ", "qd", ",", " ", "dP", ",", 
        " ", "dq", ",", " ", "c3", ",", " ", "s3", ",", " ", "c34", ",", " ", 
        "s34"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "solve", " ", "\[Theta]d", " ", "such", " ", "that", " ", "vcom"}], 
         " ", "=", " ", 
         RowBox[{"dP", ".", "\[Theta]d"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "\[Theta]d"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dt"}], 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", " ", "\[Theta]2"}], "}"}]}]}], ","}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dP", " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dq"}], " ", "Pcom"}]}], ",", " ", 
        RowBox[{
        "where", " ", "Pcom", " ", "is", " ", "the", " ", "center", " ", "of",
          " ", "mass", " ", "of", " ", "the", " ", "robot"}], ","}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "and", " ", "vcom", " ", "is", " ", "the", " ", "velocity", " ", "of", 
        " ", "the", " ", "center", " ", "of", " ", 
        RowBox[{"mass", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "unique", " ", "solutions", " ", "do", " ", "not", " ", "exist", " ", 
         "whenever", " ", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], " ", 
        "\[Equal]", " ", 
        RowBox[{"0", " ", "mod", " ", "\[Pi]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], " ", 
         "\[Equal]", " ", "0"}], ",", " ", 
        RowBox[{
         RowBox[{
         "then", " ", "a", " ", "line", " ", "of", " ", "slns", " ", "exist", 
          " ", "\[CapitalDelta]y"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Tan", "[", 
            RowBox[{
            "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "]"}], "/", "2"}], " ", 
          RowBox[{"\[CapitalDelta]x", "."}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dP", " ", "=", " ", 
        RowBox[{"dPcom", "[", 
         RowBox[{"mag", ",", " ", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vcom", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"\[CapitalDelta]x", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", " ", "g", " ", "\[CapitalDelta]y"}], "]"}]}]}], ",",
           " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", " ", "g", " ", "\[CapitalDelta]y"}], "]"}]}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"dP", ",", " ", "vcom"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"return", " ", "qd"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dt"}], " ", 
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", ",", " ", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], " ", "subject", " ", "to", " ", "a", " ", 
          "magnet", " ", "being", " ", "on"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "dPcom", " ", "already", " ", "does", " ", "a", " ", "sanity", " ", 
         "check", " ", "on", " ", "magnet", " ", "values"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dq", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "0"},
              {"0", "0"},
              {"1", "0"},
              {"0", "1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", " ", 
          TagBox[
           TagBox[
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "c3"}], "-", 
                 RowBox[{"L2", " ", "c34"}]}], 
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "c34"}]},
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "s3"}], "-", 
                 RowBox[{"L2", " ", "s34"}]}], 
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "s34"}]},
               {"1", "0"},
               {"0", "1"}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.7]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dq", ".", "\[Theta]d"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinimizeFreeFlight", "[", 
     RowBox[{
     "mag_", ",", " ", "\[CapitalDelta]x_", ",", " ", "\[CapitalDelta]y_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", 
        "q\[Theta]2", ",", " ", "\[Theta]", ",", " ", "\[Theta]d"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "\[Theta]", " ", "such", " ", "that", " ", 
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"\[Theta]d", ".", "\[Theta]d"}], " ", "is", " ", 
         "minimized"}], ",", " ", 
        RowBox[{
        "where", " ", "\[Theta]d", " ", "is", " ", "the", " ", "initial"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "velocity", " ", "during", " ", "free", " ", "flight", " ", "required",
         " ", "to", " ", "travel", " ", "a", " ", "distance", " ", "of", " ", 
        "\[CapitalDelta]x", " ", "at"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", " ", "maximum", " ", "height", " ", "\[CapitalDelta]y"}],
         ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "\[Theta]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "for", 
          " ", "when", " ", "the", " ", "robot", " ", "has", " ", 
          "only"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"one", " ", "magnet", " ", "on", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", " ", "\"\<pinned\>\"", " ", "configuration"}], ")"}], 
         "."}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", 
              RowBox[{"Sin", "[", "q\[Theta]1", "]"}]}], "-", 
             RowBox[{"L2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"L1", " ", 
              RowBox[{"Cos", "[", "q\[Theta]1", "]"}]}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid magnet state for MinimizeFreeFlight\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
         "}"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeFlightVelocity", "[", 
           RowBox[{
           "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
            "\[CapitalDelta]y"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "=", " ", 
        RowBox[{"ArgMin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"\[Theta]d", ".", "\[Theta]d"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", " ", 
         RowBox[{"FreeFlightVelocity", "[", 
          RowBox[{
          "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
           "\[CapitalDelta]y"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaximizeFreeFlight", "[", 
     RowBox[{
     "mag_", ",", " ", "\[CapitalDelta]x_", ",", " ", "\[CapitalDelta]y_", 
      ",", " ", 
      RowBox[{"\[Alpha]_:", "1"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", 
        "q\[Theta]2", ",", " ", "\[Theta]", ",", " ", "\[Theta]d"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"solve", " ", "\[Theta]", " ", "such", " ", "that", " ", 
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"\[Theta]d", ".", "\[Theta]d"}], " ", "is", " ", 
          "maximized", " ", "subject", " ", "to", " ", 
          RowBox[{
          "\[Theta]d", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}]}], " ", "=", " ", 
         RowBox[{"\[Alpha]", " ", 
          RowBox[{
          "\[Theta]d", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}]}]}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "where", " ", "\[Theta]d", " ", "is", " ", "the", " ", "initial", " ", 
        "velocity", " ", "during", " ", "free", " ", "flight", " ", 
        "required", " ", "to", " ", "travel"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "a", " ", "distance", " ", "of", " ", "\[CapitalDelta]x", " ", "at", 
         " ", "a", " ", "maximum", " ", "height", " ", "\[CapitalDelta]y"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "\[Theta]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "for", 
          " ", "when", " ", "the"}]}]}], " ", "*)"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "robot", " ", "has", " ", "only", " ", "one", " ", "magnet", " ", "on",
         " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", " ", "\"\<pinned\>\"", " ", "configuration"}], ")"}], 
         "."}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", 
              RowBox[{"Sin", "[", "q\[Theta]1", "]"}]}], "-", 
             RowBox[{"L2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"L1", " ", 
              RowBox[{"Cos", "[", "q\[Theta]1", "]"}]}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid magnet state for MaximizeFreeFlight\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
         "}"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeFlightVelocity", "[", 
           RowBox[{
           "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
            "\[CapitalDelta]y"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "=", " ", 
        RowBox[{"ArgMax", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"\[Theta]d", ".", "\[Theta]d"}]}], ",", " ", 
            RowBox[{
             RowBox[{
             "\[Theta]d", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], " ", "\[Equal]", " ", 
             RowBox[{"\[Alpha]", " ", 
              RowBox[{
              "\[Theta]d", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"visualize", " ", "cost", " ", "function"}], ",", " ", 
         RowBox[{"useful", " ", "for", " ", "debugging"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{"\[Theta]d", ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]2", ",", " ", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
          RowBox[{"Epilog", "\[Rule]", " ", 
           RowBox[{"InfiniteLine", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"\[Alpha]", ",", "1"}], "}"}]}], "}"}], "]"}]}]}], 
         "]"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", " ", 
         RowBox[{"FreeFlightVelocity", "[", 
          RowBox[{
          "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
           "\[CapitalDelta]y"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawGibbot", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "Graphics", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "P", ",", " ", "psz", ",", " ", "ma", ",", " ", "com", ",", " ", "mo", 
        ",", " ", "li"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"psz", " ", "=", " ", 
        RowBox[{"0.01", " ", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"L1", ",", " ", "L2"}], "]"}], "/", "0.3"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"P1", "[", "x", "]"}], ",", " ", 
          RowBox[{"P2", "[", "x", "]"}], ",", " ", 
          RowBox[{"P3", "[", "x", "]"}], ",", " ", 
          RowBox[{"P4", "[", "x", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "motor", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mo", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Red", ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{"2", "psz"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "center", " ", "of", " ", "mass", " ", "of", " ", "each", " ", 
         "link"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"com", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}], ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"magnets", ":", " ", "on"}], " ", "\[Rule]", " ", "dark"}], 
         ",", " ", 
         RowBox[{"off", " ", "\[Rule]", " ", "light"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ma", " ", "=", " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"LightRed", ",", " ", "LightRed"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", " ", "LightRed"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"LightRed", ",", " ", "Red"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", " ", "Red"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ma", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "ma", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}], ",", " ", 
          RowBox[{
          "ma", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "links", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"li", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", "Black", ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"P", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4", ",", "5"}], "}"}], 
             "\[RightDoubleBracket]"}], "}"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"li", ",", " ", "mo", ",", " ", "ma", ",", " ", "com"}], 
          "}"}], ",", " ", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FixAngles", ",", " ", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngles", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{" ", 
        RowBox[{
        "make", " ", "sure", " ", "angles", " ", "are", " ", "btw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "pi"}], " ", "pi"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"q", ",", " ", 
          RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", ">", "\[Pi]"}], ",", " ", 
         RowBox[{"x", " ", "-", " ", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", "x"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixState", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", " ", "=", " ", "x"}], ",", " ", "n"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "4"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", 
          RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "y"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367653922082*^9, 3.5933676540470953`*^9}, {
   3.60224862205973*^9, 3.602248628162079*^9}, {3.618410239888734*^9, 
   3.618410243607942*^9}, {3.618411402838331*^9, 3.6184114053624744`*^9}, 
   3.618648264733282*^9, {3.618648379655821*^9, 3.6186484159840155`*^9}, {
   3.6186600689430113`*^9, 3.618660147690508*^9}, 3.61866274541527*^9, {
   3.6186633481607847`*^9, 3.6186633510349493`*^9}, 3.618663382293741*^9, {
   3.618664471157302*^9, 3.6186644734544353`*^9}, 3.618676224046091*^9, {
   3.6186981040546894`*^9, 3.6186981152563276`*^9}, {3.6196234592833757`*^9, 
   3.6196234777521663`*^9}, {3.619623515299116*^9, 3.6196235156741133`*^9}, 
   3.6196328601116304`*^9, 3.6196401674237742`*^9, {3.6196488597011433`*^9, 
   3.619648863131336*^9}, {3.6196492958539968`*^9, 3.6196493018480144`*^9}, {
   3.619650251272032*^9, 3.6196504742620487`*^9}, 3.619650665427994*^9, {
   3.6196507656223774`*^9, 3.619650833773438*^9}, {3.6196523917501316`*^9, 
   3.6196524111052427`*^9}, {3.6196528648799553`*^9, 3.619652901014676*^9}, {
   3.6196578897032647`*^9, 3.619657991034055*^9}, {3.619658030577319*^9, 
   3.6196580384157686`*^9}, {3.619658163576936*^9, 3.6196581661690845`*^9}, {
   3.619658254715153*^9, 3.619658255251199*^9}, {3.619658620842122*^9, 
   3.619658664420618*^9}, {3.6197419655520043`*^9, 3.6197419751613955`*^9}, {
   3.6197529087892003`*^9, 3.619752914554837*^9}, {3.6197529853674746`*^9, 
   3.6197531276802497`*^9}, {3.619831201246524*^9, 3.6198312626372876`*^9}, {
   3.6198321902485676`*^9, 3.6198322071392403`*^9}, {3.6198693533094535`*^9, 
   3.6198693660438504`*^9}, {3.6289931356527596`*^9, 
   3.6289931597278786`*^9}, {3.6289931990588293`*^9, 
   3.6289932002276473`*^9}, {3.6289935174160986`*^9, 
   3.6289935434786215`*^9}, {3.628999690999849*^9, 3.6289996940029626`*^9}, {
   3.6290874696346054`*^9, 3.629087496195485*^9}, {3.6290893794609632`*^9, 
   3.6290893878469396`*^9}, 3.6290896294286284`*^9, {3.6290896777369585`*^9, 
   3.629089856925326*^9}, {3.6290901996289024`*^9, 3.6290903470286636`*^9}, {
   3.6290903788752985`*^9, 3.6290904769489727`*^9}, {3.6290941716047225`*^9, 
   3.629094189846675*^9}, {3.629094236592229*^9, 3.629094250795303*^9}, {
   3.629094284635376*^9, 3.6290943321701436`*^9}, {3.6290950649229198`*^9, 
   3.6290950763900695`*^9}, {3.629096692277546*^9, 3.629096794749364*^9}, {
   3.6291371605944824`*^9, 3.6291371759584045`*^9}, {3.6293296264268723`*^9, 
   3.6293296570054536`*^9}, {3.629329828179557*^9, 3.629329851164239*^9}, {
   3.6293303783900037`*^9, 3.6293303895620413`*^9}, {3.6293316179533696`*^9, 
   3.6293317690178957`*^9}, {3.629333385556221*^9, 3.6293334228692465`*^9}, {
   3.6293335228862004`*^9, 3.6293335269956183`*^9}, {3.629333619715615*^9, 
   3.629333755795559*^9}, 3.629333835171608*^9, {3.6293341680041604`*^9, 
   3.629334181613716*^9}, {3.6293342520209026`*^9, 3.62933427814625*^9}, {
   3.6293343940540133`*^9, 3.6293343971009283`*^9}, {3.6293346816828413`*^9, 
   3.6293346820109997`*^9}, {3.6293354129957447`*^9, 3.629335442855516*^9}, {
   3.629335490621723*^9, 3.6293355244972005`*^9}, {3.629335585966768*^9, 
   3.62933559316999*^9}, {3.6293356337642803`*^9, 3.629335747609542*^9}, {
   3.6293357895944767`*^9, 3.6293358964771442`*^9}, {3.629336178762163*^9, 
   3.6293362466224403`*^9}, {3.629338835081946*^9, 3.629338837488228*^9}, {
   3.629469374846306*^9, 3.629469520599386*^9}, {3.6294696371502223`*^9, 
   3.6294696386572943`*^9}, {3.6294697994025893`*^9, 
   3.6294698796015825`*^9}, {3.6294699779865155`*^9, 
   3.6294699882988653`*^9}, {3.629470024010219*^9, 3.6294700654466753`*^9}, {
   3.629470145532591*^9, 3.629470233162876*^9}, {3.6294702664445305`*^9, 
   3.629470480376577*^9}, {3.6294705325987005`*^9, 3.6294705825211725`*^9}, {
   3.629470633836641*^9, 3.629470843753844*^9}, {3.6294709340320063`*^9, 
   3.6294710398922396`*^9}, {3.6294710849512625`*^9, 
   3.6294710858819284`*^9}, {3.629471160657074*^9, 3.6294711886569743`*^9}, {
   3.6294712261186223`*^9, 3.629471327358551*^9}, {3.6294789185643525`*^9, 
   3.629478968165583*^9}, {3.6294790760272665`*^9, 3.6294790858512487`*^9}, 
   3.6294792689984083`*^9, {3.629479348920209*^9, 3.62947936517177*^9}, {
   3.6294794720807533`*^9, 3.629479472167816*^9}, {3.6294802024698644`*^9, 
   3.6294803962515755`*^9}, {3.629480426413014*^9, 3.629480448688848*^9}, {
   3.6294805310213757`*^9, 3.629480531197501*^9}, {3.6294805806026073`*^9, 
   3.6294806036570005`*^9}, {3.6294806700131617`*^9, 
   3.6294806750417356`*^9}, {3.629480718810835*^9, 3.62948071937222*^9}, {
   3.6294807807848916`*^9, 3.62948079389318*^9}, {3.6294808463164663`*^9, 
   3.6294808465736485`*^9}, {3.629480880129498*^9, 3.6294808803366456`*^9}, {
   3.629481404771348*^9, 3.6294814952326717`*^9}, {3.629481650607094*^9, 
   3.629481655709719*^9}, {3.6294822726782255`*^9, 3.629482305426502*^9}, {
   3.6295020831260214`*^9, 3.629502115830265*^9}, 3.629502480571497*^9, 
   3.629502663221318*^9, {3.6296676436468954`*^9, 3.6296676716004066`*^9}, {
   3.629668043292823*^9, 3.629668133122157*^9}, {3.629668351468812*^9, 
   3.629668376797289*^9}, {3.6296684209228773`*^9, 3.62966848243932*^9}, {
   3.6296688800852356`*^9, 3.629669003055621*^9}, {3.6296690594782486`*^9, 
   3.629669206808332*^9}, 3.629669250605791*^9, {3.6296693133097496`*^9, 
   3.6296693164504166`*^9}, {3.6296700157409716`*^9, 
   3.6296700272723603`*^9}, {3.6296700730698586`*^9, 3.629670079960574*^9}, {
   3.629670529154052*^9, 3.6296705697795906`*^9}, {3.6296706037019176`*^9, 
   3.62967061459272*^9}, {3.6296706541244636`*^9, 3.6296706552807302`*^9}, {
   3.6296707370318174`*^9, 3.629670771235397*^9}, {3.629670859970951*^9, 
   3.629670861299096*^9}, 3.629670899908986*^9, 3.6296709316125326`*^9, {
   3.629672354975218*^9, 3.6296724440232563`*^9}, {3.6296726898103933`*^9, 
   3.6296727258577137`*^9}, {3.6296814222491016`*^9, 3.629681422717843*^9}, {
   3.62974088646299*^9, 3.6297408873692675`*^9}, {3.629740922416609*^9, 
   3.629740953213866*^9}, {3.629741219935405*^9, 3.6297412374356527`*^9}, {
   3.6297520612432384`*^9, 3.629752063446393*^9}, {3.629752346178745*^9, 
   3.6297523844605*^9}, {3.629752431929887*^9, 3.629752436523698*^9}, {
   3.6297525230248504`*^9, 3.629752575541169*^9}, {3.6297526214636602`*^9, 
   3.6297526266512284`*^9}, {3.6297529749199686`*^9, 
   3.6297529952014885`*^9}, {3.629753113437434*^9, 3.629753126906358*^9}, {
   3.6297534590623703`*^9, 3.6297534621717887`*^9}, {3.629753670221429*^9, 
   3.6297537353316727`*^9}, 3.629753835557296*^9, {3.6297545427237225`*^9, 
   3.6297546319124126`*^9}, {3.6297567457410374`*^9, 
   3.6297567463191805`*^9}, {3.6297575150921135`*^9, 
   3.6297575190764837`*^9}, {3.6297575693727417`*^9, 
   3.6297575869042463`*^9}, {3.6297576342017293`*^9, 3.629757634279849*^9}, {
   3.6298513958126945`*^9, 3.6298514023033075`*^9}, {3.6298529706009817`*^9, 
   3.6298529706664724`*^9}, {3.6298533121690636`*^9, 3.6298533182801228`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"robot", " ", 
     RowBox[{"configuration", ":", " ", "q"}]}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "qx", ",", " ", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
     "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mag", " ", "=", " ", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"magnet", " ", 
      RowBox[{"state", ":", " ", "0"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"both", " ", "off"}], "..."}], "3"}], " ", "=", " ", 
      RowBox[{"both", " ", "on"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", "8"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"robot", " ", 
     RowBox[{"state", ":", " ", 
      RowBox[{"{", 
       RowBox[{"q", ",", " ", 
        RowBox[{"dq", "/", "dt"}]}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"u", " ", "=", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"motor", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dx", " ", "=", " ", 
     RowBox[{"2", "L1"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"free", " ", "flight", " ", 
     RowBox[{"distance", " ", "@", " ", "maximum"}], " ", "height"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "maximum", " ", "height", " ", "during", " ", "free", " ", "flight"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "errors", " ", "and", " ", "bizarre", " ", "answers", " ", "may", " ", 
     "result", " ", "if", " ", "constraint", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Jmag", "[", "q", "]"}], ".", "dq"}], "/", "dt"}], " ", 
     RowBox[{"isn", "'"}], "t", " ", "satisfied"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"dynamics", " ", "and", " ", "impacts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicQnts", "[", 
    RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "accelerations", " ", "and", " ", "tangential", " ", 
     "loads", " ", "on", " ", "each", " ", "magnet"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImpactQnts", "[", 
    RowBox[{"mag", ",", " ", "x"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"returns", " ", "post"}], "-", 
     RowBox[{
     "impact", " ", "state", " ", "and", " ", "impulse", " ", "felt", " ", 
      "by", " ", "each", " ", "magnet"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"input", " ", "torque", " ", "from", " ", "motor"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "vector", " ", "for", " ", "finding", " ", "a", " ", "u", " ", "such", 
      " ", "that", " ", 
      RowBox[{"b", ".", "qdd"}]}], " ", "=", " ", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"u", " ", "=", " ", 
    RowBox[{"MotorInput", "[", 
     RowBox[{"mag", ",", " ", "x", ",", " ", "b"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "input", " ", "torque", " ", "needed", " ", "to", " ", "make", " ", 
      RowBox[{
       RowBox[{"d", "^", "2"}], "/", 
       RowBox[{"dt", "^", "2"}]}], " ", "q\[Theta]2"}], " ", "=", " ", "0"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DynamicQnts", "[", 
      RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", "//", " ", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "double", " ", "pendulum", " ", "to", " ", "free", " ", "flight"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeFlightVelocity", "[", 
      RowBox[{"mag", ",", " ", "x", ",", " ", "dx", ",", " ", "dy"}], "]"}]}],
     " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "returns", " ", "velocity", " ", "required", " ", "to", " ", "travel", 
      " ", 
      RowBox[{"(", 
       RowBox[{"dx", ",", " ", "dy"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"MinimizeFreeFlight", "[", 
      RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], "]"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "returns", " ", "state", " ", "that", " ", "minimizes", " ", "velocity", 
      " ", "required"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"MaximizeFreeFlight", "[", 
      RowBox[{"mag", ",", " ", "dx", ",", " ", "dy", ",", " ", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "returns", " ", "state", " ", "that", " ", "maximizes", " ", "velocity",
        " ", "subject", " ", "to", " ", 
       RowBox[{"d", "/", "dt"}], " ", "q3"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"d", "/", "dt"}], " ", "q4"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"DrawGibbot", "[", 
    RowBox[{"mag", ",", " ", "x"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "a", " ", "graphic", " ", "of", " ", "the", " ", 
     "gibbot"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHbt7dtVBzteOUe/ugOkTVVJrjwBpjQVMm0F0kVb8
LhC9yY5xL4jm87vr9wFI7zFgDgLRRxb4hYFopfQpySD6Vepx9o9AOujyBD4Q
fWmnzNxPQHofA8MCEL1ZstnmC5AWMrzmAKLZPCUngGif/jWTQfS3DReNObhe
O34qMTYB0dKFLXczgPSS2RP4MoH0EYVYERDdpPpQEkR3aSbLgWiDnYUGIPrY
nhITEC10YJYFiNb4IhoGoh+WvAXTerX8q1YB6SKVFWCa4az8eRAtLfIcTBvp
v47i4X7t+Gbj+VgQfWcXawaIfrKLG0zv+7Z6DYj+U71jE4iOmVj9ywRIawh2
gekv0mrspkA6TTGSF0QDAPjEn9g=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specs", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}, {3.629138508061183*^9, 
  3.629138516540187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"s_", "?", "NumericQ"}], ",", " ", "q_", ",", " ", "qd_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", "qd"}], "]"}]}], ";", " ", 
      RowBox[{"First", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"mag", ",", " ", "x", ",", " ", 
         RowBox[{"u", "[", 
          RowBox[{"s", ",", " ", "x"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.6297582460562477`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"E", ",", " ", "Emax"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Emax", " ", "=", " ", 
        RowBox[{"TE", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E", " ", "=", " ", 
        RowBox[{
         RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ke", " ", 
           RowBox[{"E", "^", "2"}]}], " ", "+", " ", 
          RowBox[{"kp", " ", 
           RowBox[{
            RowBox[{
            "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "^", 
            "2"}]}], " ", "+", " ", 
          RowBox[{"kd", " ", 
           RowBox[{
            RowBox[{
            "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], "^", 
            "2"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vdot", "[", 
     RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"E", ",", " ", "Emax", ",", " ", "qdd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"DynamicQnts", "[", 
          RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Emax", " ", "=", " ", 
        RowBox[{"TE", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E", " ", "=", " ", 
        RowBox[{
         RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ke", " ", "E", " ", "u"}], " ", "+", " ", 
          RowBox[{"kd", " ", 
           RowBox[{
           "qdd", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
          " ", "+", " ", 
          RowBox[{"kp", " ", 
           RowBox[{
           "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
         ")"}], 
        RowBox[{
        "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zizs", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "f", ",", " ", "J", ",", " ", "Jd", ",", " ", "Minv", ",", " ", "zi", 
        ",", " ", "zs", ",", " ", "\[CapitalLambda]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"GibbotQnts`Private`J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for zizs\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"GibbotQnts`Private`M", "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{"GibbotQnts`Private`fext", "[", 
          RowBox[{"x", ",", " ", "0"}], "]"}], " ", "-", " ", 
         RowBox[{"GibbotQnts`Private`c", "[", "x", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"Minv", ".", "f"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"input", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"Minv", ".", "T"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"state", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"J", "\[Transpose]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"J", ".", "Minv", ".", 
           RowBox[{"J", "\[Transpose]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"zi", " ", "-", " ", 
         RowBox[{"\[CapitalLambda]", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Jd", ".", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], " ", "+",
             " ", 
            RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", " ", 
        RowBox[{"\[CapitalLambda]", ".", "J"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"zs", " ", "-", " ", 
         RowBox[{"\[CapitalLambda]", ".", "zs"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"zi", ",", " ", "zs"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gains", "[", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "zsmin", ",", " ", "x3", ",", " ", "x4", ",", " ", "c4", ",", " ", 
        "c5"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{
         RowBox[{"zizs", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "0", 
            ",", "0"}], "}"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", " ", "4"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c5", " ", "=", " ", 
        RowBox[{"RegionProduct", "[", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]"}], "}"}]}], "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zsmin", " ", "=", " ", 
        RowBox[{"NMinValue", "[", 
         RowBox[{"c4", ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x3", ",", "x4"}], "}"}], " ", "\[Element]", " ", 
           "c5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{
         RowBox[{"m1", " ", "r1"}], " ", "+", " ", 
         RowBox[{"m2", " ", "L1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c5", " ", "=", " ", 
        RowBox[{"m2", " ", "r2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kd", "/", "ke"}], ",", " ", 
           RowBox[{"kp", "/", "ke"}]}], "}"}], " ", "\[GreaterEqual]"}], "  ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"c4", "+", "c5"}], ")"}], 
          RowBox[{"g", "/", "zsmin"}]}], ",", " ", 
         RowBox[{"2", " ", "c4", " ", "c5", " ", 
          RowBox[{"g", "^", "2"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"t_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E", ",", " ", "Emax", ",", " ", "zi", ",", " ", "zs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zi", ",", " ", "zs"}], "}"}], " ", "=", " ", 
       RowBox[{"zizs", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Emax", " ", "=", " ", 
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E", " ", "=", " ", 
       RowBox[{
        RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", " ", "<", " ", "tsw"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kv"}], " ", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
           " ", "-", " ", 
           RowBox[{"kp", " ", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
           " ", "-", " ", 
           RowBox[{"kd", " ", 
            RowBox[{
            "zi", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ke", " ", "E"}], " ", "+", " ", 
           RowBox[{"kd", " ", 
            RowBox[{
            "zs", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"-", 
         RowBox[{"K", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], " ", "-", " ", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
           ")"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.6296827077974305`*^9}, {
   3.629682747532361*^9, 3.629682777688982*^9}, {3.629682839908622*^9, 
   3.629682840471125*^9}, {3.629682910753313*^9, 3.6296830403487854`*^9}, {
   3.6296831144591465`*^9, 3.6296831716161275`*^9}, {3.629683252648484*^9, 
   3.6296832918364763`*^9}, {3.62968334083713*^9, 3.629683367446892*^9}, {
   3.629683429838312*^9, 3.6296834435729065`*^9}, {3.6296835105581694`*^9, 
   3.6296836574976234`*^9}, {3.62968375140512*^9, 3.6296837585770617`*^9}, {
   3.6296838301092625`*^9, 3.629683833906189*^9}, {3.629683949220255*^9, 
   3.629683970861135*^9}, {3.629684018893024*^9, 3.6296840190961533`*^9}, {
   3.629684460648903*^9, 3.629684465523967*^9}, 3.629684572087885*^9, {
   3.6296847025583706`*^9, 3.6296847158398275`*^9}, {3.6296847577935104`*^9, 
   3.6296848367633114`*^9}, {3.6296849951403885`*^9, 3.629685007984294*^9}, 
   3.629685109079439*^9, {3.62968542658366*^9, 3.6296856339301386`*^9}, {
   3.629685781322723*^9, 3.6296858570581055`*^9}, {3.6296858926835804`*^9, 
   3.629685927605919*^9}, {3.6296859627939157`*^9, 3.629686011544536*^9}, {
   3.6296860424356003`*^9, 3.629686093873789*^9}, {3.6296863984871564`*^9, 
   3.6296864446753297`*^9}, 3.6296864886133833`*^9, {3.6296865493329735`*^9, 
   3.629686551145496*^9}, {3.6296868389461985`*^9, 3.629686861665209*^9}, {
   3.6296869100252705`*^9, 3.629686910697156*^9}, {3.6296869727448573`*^9, 
   3.6296870568084135`*^9}, {3.6296870994652634`*^9, 3.629687358890588*^9}, {
   3.6296874521262035`*^9, 3.6296875187989655`*^9}, {3.6296875792528954`*^9, 
   3.629687633191144*^9}, {3.6296876641602736`*^9, 3.6296877958182755`*^9}, {
   3.629688020774394*^9, 3.6296881156819057`*^9}, {3.629688206511241*^9, 
   3.629688248808704*^9}, {3.6296883603882875`*^9, 3.629688405701391*^9}, {
   3.629689587447905*^9, 3.6296895876666117`*^9}, {3.6296916456627555`*^9, 
   3.629691699397847*^9}, {3.6296917673362837`*^9, 3.629691769930024*^9}, {
   3.6296918147118535`*^9, 3.6296918628375216`*^9}, {3.629691991323637*^9, 
   3.629692023620911*^9}, {3.6296920674027767`*^9, 3.6296920746528735`*^9}, 
   3.6296925878315425`*^9, {3.6296926341446595`*^9, 3.629692648207346*^9}, {
   3.6296926804421816`*^9, 3.6296927137863436`*^9}, {3.6296928114751434`*^9, 
   3.629692811537635*^9}, {3.629693017821638*^9, 3.629693063822282*^9}, {
   3.629693109791645*^9, 3.629693181511346*^9}, {3.6296932120898757`*^9, 
   3.629693329638316*^9}, {3.629693371013838*^9, 3.6296933743107567`*^9}, {
   3.629693420014526*^9, 3.6296934819059663`*^9}, {3.6296935131095095`*^9, 
   3.6296935405942183`*^9}, {3.629693578391631*^9, 3.6296936255953817`*^9}, {
   3.6296938633329177`*^9, 3.6296938872550807`*^9}, {3.6296939616623206`*^9, 
   3.6296939904439535`*^9}, {3.6296942176060266`*^9, 3.62969426363789*^9}, {
   3.6296943772019005`*^9, 3.6296943809207*^9}, {3.6296944378433323`*^9, 
   3.6296944386402173`*^9}, {3.6296957775174055`*^9, 
   3.6296958032365294`*^9}, {3.6296959760357018`*^9, 
   3.6296960153018193`*^9}, {3.629756736975297*^9, 3.6297567380065594`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gains", "[", "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ke", " ", "=", " ", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"kd", ",", " ", "kp"}], "}"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", " ", "1"}], "}"}], " ", 
   RowBox[{"gains", "[", "]"}], " ", "ke"}]}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.6296827077974305`*^9}, {
   3.629682747532361*^9, 3.629682777688982*^9}, {3.629682839908622*^9, 
   3.629682840471125*^9}, {3.629682910753313*^9, 3.6296830403487854`*^9}, {
   3.6296831144591465`*^9, 3.6296831716161275`*^9}, {3.629683252648484*^9, 
   3.6296832918364763`*^9}, {3.62968334083713*^9, 3.629683367446892*^9}, {
   3.629683429838312*^9, 3.6296834435729065`*^9}, {3.6296835105581694`*^9, 
   3.6296836574976234`*^9}, {3.62968375140512*^9, 3.6296837585770617`*^9}, {
   3.6296838301092625`*^9, 3.629683833906189*^9}, {3.629683949220255*^9, 
   3.629683970861135*^9}, {3.629684018893024*^9, 3.6296840190961533`*^9}, {
   3.629684460648903*^9, 3.629684465523967*^9}, 3.629684572087885*^9, {
   3.6296847025583706`*^9, 3.6296847158398275`*^9}, {3.6296847577935104`*^9, 
   3.6296848367633114`*^9}, {3.6296849951403885`*^9, 3.629685007984294*^9}, 
   3.629685109079439*^9, {3.62968542658366*^9, 3.6296856339301386`*^9}, {
   3.629685781322723*^9, 3.6296858570581055`*^9}, {3.6296858926835804`*^9, 
   3.629685927605919*^9}, {3.6296859627939157`*^9, 3.629686011544536*^9}, {
   3.6296860424356003`*^9, 3.629686093873789*^9}, {3.6296863984871564`*^9, 
   3.6296864446753297`*^9}, 3.6296864886133833`*^9, {3.6296865493329735`*^9, 
   3.629686551145496*^9}, {3.6296868389461985`*^9, 3.629686861665209*^9}, {
   3.6296869100252705`*^9, 3.629686910697156*^9}, {3.6296869727448573`*^9, 
   3.6296870568084135`*^9}, {3.6296870994652634`*^9, 3.629687358890588*^9}, {
   3.6296874521262035`*^9, 3.6296875187989655`*^9}, {3.6296875792528954`*^9, 
   3.629687633191144*^9}, {3.6296876641602736`*^9, 3.6296877958182755`*^9}, {
   3.629688020774394*^9, 3.6296881156819057`*^9}, {3.629688206511241*^9, 
   3.629688248808704*^9}, {3.6296883603882875`*^9, 3.629688405701391*^9}, {
   3.629689587447905*^9, 3.6296895876666117`*^9}, {3.6296916456627555`*^9, 
   3.629691699397847*^9}, {3.6296917673362837`*^9, 3.629691769930024*^9}, {
   3.6296918147118535`*^9, 3.6296918628375216`*^9}, {3.629691991323637*^9, 
   3.629692023620911*^9}, {3.6296920674027767`*^9, 3.6296920746528735`*^9}, 
   3.6296925878315425`*^9, {3.6296926341446595`*^9, 3.629692648207346*^9}, {
   3.6296926804421816`*^9, 3.6296927137863436`*^9}, {3.6296928114751434`*^9, 
   3.629692811537635*^9}, {3.629693017821638*^9, 3.629693063822282*^9}, {
   3.629693109791645*^9, 3.629693181511346*^9}, {3.6296932120898757`*^9, 
   3.629693329638316*^9}, {3.629693371013838*^9, 3.6296933743107567`*^9}, {
   3.629693420014526*^9, 3.6296934819059663`*^9}, {3.6296935131095095`*^9, 
   3.6296935405942183`*^9}, {3.629693578391631*^9, 3.629693717955987*^9}, {
   3.6296940394290104`*^9, 3.629694090679696*^9}, {3.629694462484317*^9, 
   3.6296944892659216`*^9}, {3.629695185978286*^9, 3.629695196540958*^9}, {
   3.6296953037298813`*^9, 3.629695303792379*^9}, {3.6296957982833385`*^9, 
   3.6296958000489855`*^9}, {3.6296999023836794`*^9, 3.62969991009516*^9}, 
   3.6297015785988555`*^9, {3.62970164258405*^9, 3.6297016441778517`*^9}, {
   3.6297017048505373`*^9, 3.629701724522669*^9}, {3.6297018934155436`*^9, 
   3.62970189499369*^9}, 3.629701956916388*^9, {3.629702088855646*^9, 
   3.629702103746436*^9}, {3.629702137731263*^9, 3.629702137809419*^9}, {
   3.629702430047685*^9, 3.6297024768607764`*^9}, {3.629702521548902*^9, 
   3.629702590040435*^9}, 3.629702627540934*^9, {3.62970283112177*^9, 
   3.6297028959350996`*^9}, 3.6297029710455055`*^9, {3.6297030308275485`*^9, 
   3.6297030938908873`*^9}, {3.6297031311257596`*^9, 3.629703175485727*^9}, {
   3.6297032083299165`*^9, 3.6297033228626823`*^9}, {3.6297034277390814`*^9, 
   3.6297034673333273`*^9}, {3.629703936870854*^9, 3.6297040060905247`*^9}, {
   3.629704047106666*^9, 3.6297041387953854`*^9}, {3.6297041857647324`*^9, 
   3.6297043448762817`*^9}, 3.6297043936269298`*^9, {3.629704944899835*^9, 
   3.6297049673689394`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.6927158887152225`", ",", "53.56610685783202`"}], "}"}]], "Output",
 CellChangeTimes->{3.6298272703052025`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"67.31789721788056`", ",", "1339.1526714458005`"}], "}"}]], "Output",
 CellChangeTimes->{3.6298272716361327`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"-", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"0", " ", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
    "=", " ", 
    RowBox[{"0", " ", "Degree"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsw", " ", "=", " ", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             "\"\<StopIntegration\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             "\"\<StopIntegration\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}], ",", " ", "\[IndentingNewLine]", "q", ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MaxStepSize", "\[Rule]", "0.01"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "tsw", \
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "'"}], "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"DrawGibbot", "[", 
    RowBox[{"mag", ",", " ", 
     RowBox[{"q", "[", "s", "]"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", 
      RowBox[{"1.5", 
       RowBox[{"(", 
        RowBox[{"L1", "+", "L2"}], ")"}]}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.629682700031763*^9}, {
   3.6296918820096855`*^9, 3.629691882306531*^9}, {3.62969196333889*^9, 
   3.6296919878235855`*^9}, {3.6296931933708487`*^9, 
   3.6296931939646363`*^9}, {3.629693399842346*^9, 3.6296934001704764`*^9}, {
   3.6296945694388647`*^9, 3.6296946616119633`*^9}, {3.629694870395962*^9, 
   3.6296948743647966`*^9}, 3.629695004085241*^9, {3.6296950726330566`*^9, 
   3.6296950889769955`*^9}, {3.62969516072795*^9, 3.629695160806061*^9}, {
   3.629695222150642*^9, 3.62969522219751*^9}, {3.6296953833090353`*^9, 
   3.6296954815290947`*^9}, 3.629695568577096*^9, {3.629695784251849*^9, 
   3.6296957861581454`*^9}, {3.62969602856765*^9, 3.62969604677102*^9}, {
   3.6296961218813615`*^9, 3.629696122756374*^9}, {3.6296965261523952`*^9, 
   3.6296965267461557`*^9}, {3.6296966300756226`*^9, 3.629696637638254*^9}, {
   3.629696673013726*^9, 3.6296967354520254`*^9}, {3.6296974850089045`*^9, 
   3.6296975422752604`*^9}, {3.6296975874008613`*^9, 3.629697732199662*^9}, {
   3.629697896811227*^9, 3.6296980364381175`*^9}, {3.6296981628928633`*^9, 
   3.6296982006121445`*^9}, {3.6296983156605496`*^9, 
   3.6296984317402444`*^9}, {3.6296984687407417`*^9, 3.629698477600232*^9}, {
   3.629698535866605*^9, 3.6296985359916058`*^9}, {3.6297002303152475`*^9, 
   3.6297002533312244`*^9}, {3.6297002848941116`*^9, 
   3.6297003005661964`*^9}, {3.6297004778810854`*^9, 3.629700541381899*^9}, {
   3.62970067960252*^9, 3.629700709696638*^9}, {3.62970086124553*^9, 
   3.6297009227775984`*^9}, {3.6297009722001643`*^9, 3.629701030310279*^9}, {
   3.6297010654670005`*^9, 3.6297012372505646`*^9}, {3.6297012830480165`*^9, 
   3.6297012845480375`*^9}, {3.629701397955795*^9, 3.6297014065340147`*^9}, {
   3.6297014753162003`*^9, 3.6297014932070923`*^9}, 3.6297016838346*^9, {
   3.6297019870886335`*^9, 3.6297020314642253`*^9}, {3.629702082261775*^9, 
   3.6297020823242593`*^9}, {3.6297021677941923`*^9, 
   3.6297021817475023`*^9}, {3.6297023925159025`*^9, 3.629702423688178*^9}, {
   3.6297026923073645`*^9, 3.629702735589245*^9}, {3.629702779371049*^9, 
   3.629702807199544*^9}, {3.62970293701377*^9, 3.6297029537483687`*^9}, {
   3.6297030072178297`*^9, 3.629703008733508*^9}, {3.6297033400503836`*^9, 
   3.6297034170201573`*^9}, {3.6297034795834894`*^9, 3.629703546943737*^9}, {
   3.6297035985381975`*^9, 3.629703655226452*^9}, {3.6297037071021423`*^9, 
   3.6297037210085773`*^9}, {3.6297037554309397`*^9, 
   3.6297038721512427`*^9}, {3.629703902307864*^9, 3.629703924651911*^9}, {
   3.6297043585326843`*^9, 3.629704358704561*^9}, {3.629704464518469*^9, 
   3.629704550582114*^9}, {3.6297550782067432`*^9, 3.629755082306635*^9}, {
   3.6297582385405226`*^9, 3.629758239509254*^9}}],

Cell[BoxData["2.1565833621823303`"], "Output",
 CellChangeTimes->{3.6298272772721395`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "9.574153094381336`*^-17"}], ",", "5.844371980031802`*^-17", 
   ",", 
   RowBox[{"-", "8.489416599576312`"}], ",", "7.787212310472604`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6298272772721395`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`s$$ = 2.1565833621823303`, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`s$$], 0, 2.1565833621823303`}}, Typeset`size$$ = {
    360., {178., 182.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`s$5930$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`s$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`s$$, $CellContext`s$5930$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      GibbotQnts`DrawGibbot[$CellContext`mag, 
        $CellContext`q[$CellContext`s$$], PlotRange -> 
        1.5 (GibbotQnts`L1 + GibbotQnts`L2)], 
      "Specifications" :> {{$CellContext`s$$, 0, 2.1565833621823303`, 
         AnimationRepetitions -> 1, 
         AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {215., 222.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.629827277688446*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "s", "]"}], "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "-", "\[Pi]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "'"}], "[", "s", "]"}], "\[LeftDoubleBracket]", "3", 
      "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "\[Pi]"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "\[Pi]"}], "}"}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"-", "\[Pi]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", 
           RowBox[{"-", "\[Pi]"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"q", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}], "]"}], "-", 
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ")"}], "/", 
     RowBox[{"TE", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
       RowBox[{"q", "[", "s", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"s", ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"q", "[", "s", "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RootMeanSquare", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"s", ",", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"q", "[", "s", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "t", ",", " ", 
      RowBox[{"t", "/", "200"}]}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6296946717370386`*^9, 3.629694826723506*^9}, 
   3.629694987850649*^9, {3.6296951276181345`*^9, 3.629695136149528*^9}, {
   3.6296952460103655`*^9, 3.6296952805420732`*^9}, {3.629695892393964*^9, 
   3.6296959347226505`*^9}, {3.629696158225628*^9, 3.629696192929185*^9}, {
   3.629696229257819*^9, 3.62969623219536*^9}, {3.6296962635394974`*^9, 
   3.6296962906805143`*^9}, {3.6296963253215694`*^9, 
   3.6296963553219495`*^9}, {3.6296963904161844`*^9, 
   3.6296964358855705`*^9}, {3.6296985122413225`*^9, 3.629698514022593*^9}, {
   3.6296985695858335`*^9, 3.629698611570766*^9}, {3.6296999590460553`*^9, 
   3.62970002607817*^9}, {3.6297001004072824`*^9, 3.629700101813551*^9}, 
   3.629700138814073*^9, {3.6297003987706585`*^9, 3.629700400458181*^9}, {
   3.6297005897888255`*^9, 3.62970059211698*^9}, 3.629701664881222*^9, {
   3.629701814820717*^9, 3.6297018204614167`*^9}, {3.629702219513629*^9, 
   3.6297022242949452`*^9}, 3.6297023294213123`*^9, {3.6297027636833706`*^9, 
   3.629702773855381*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwd13c81P8fAHDjjjsk2YpKiKRUdsnrSEZJUwOZRYOMzL5CKoVk75msMpIZ
SW8RkSQrq2zOzAp3Rr+33z88no/7fO5zn/f7td6iFnbnrjMxMDC04z8b/y3W
udXnk63VhPZpXlgRJSNJB7+bKPs4/JBRMd0w458UyZBsA0D9FK8Nl4RSNpmr
m4FWQljBhqdz3vi6Z1+HqTMXVzYsUbedIVTgNjyMzDZYxd4/V6NqoG4PBYJl
lRuu9/J07190BO/xFLU17OubFItts50h6V7A1w0zxE3N0czdwGIxynodO14q
TdZX4D+IOj+55R/2mKj/hdPq3tC4tBLIsIuMiqnDjnzxDyC5a/0qI/ajN+oh
3Ys+4MbUqcyEvfMo7Zt19mOQ4EtlJ2BPMxtM7mN9Ao36vxmJ2OX1eWwL5k9B
JMrn34YvXb6h7S0QAJMDLzaRsGtLb5vpqQeD7DnnqxzY661dndeyI6BG5j0H
H/b1d6Sx2iuR4D4Xw8OP3RCnuCzNGgU72i/yCmDHWoTyz5pHgxQjN4MQNqMW
kriwOQb+yVqObfjGnmn5kvIYOJmtXLcVW2FG9/x9gThwLhO4KYwd3+Jq0Vcd
B7elXCRFsJlK0hyOOcZD0ipT54ZvxrZ4p+9IgL9V4x7bsZvuMwaTvyWA5REj
7h3YSuaySTb3EiHy7sPoDSdqXs39LpkEtjvDOHdiE6UCPhxqS4KQoNK7Gy5+
bDxyQj0ZLuZK1G74luu87WpUMmgeYSGJYovc9P+bM50M6Ut+ChtuMhS9b3r8
BYh09upv+JHeO8KW+Bcge0Tp/IaV1U4/+zT3Ajq4kPqGJ2RHeJx0U0CQP0to
w4mi9+MkklPgKaN018bzzvHwiv1cTIGhIjufDbMQs14/PfUSku7mbdlw6aL6
ocOpL+HwlOiTjfexoXaUTtBfQuklev/G++/sslNPOJsKIyF2ohtu+cpSp5+Z
Cm8oJZob6+X7IeEMw79UOMjIenJjfQ+/ke94a5AGX2PD5bZhTyV/NbXMToP9
ByPX/r8/wUKFpmzpcM5F0F8Qe8DLmmR8Ix04P9fObOz3Vbsi48s16VD7N+3A
Rjx0mDC/vSCeAa+8i3V4sM/rnyWe9cmA+C/rSluwG48mXTnVlwEu4LvGiV0t
fIRJKz4TbrA7srJhA4ffRQ16Jkg3jeiyYpettL9Wu/wKhDzKTTbiN6/L8bwS
72tY7C1c2ciXvfUoQ87xNdyT+fOAjp1eyrkq2/QaWlJK2xc38if6darUsyzo
H1ahTmMLPF1eFh/PgnZWrpfj2KGuWqdEdbIhVaBEagT76cWBv0KEHKixqAnu
wWbWOnCC3yIHIsMvOfzE9lTwTORGOcB7j12oGfsu71Ztdo9c4I08XFazUQ+Y
b8SxduVCfdbYW4R9Y77oD7PyG1im7bItwzZpPhu9Ov8GkgyypXM26sWX6oXF
ojx4q5T2Kgh74OPE9r9DeXAoaHfaE+zkEm7deZ634MKgdtULe2uGWcIfh7dg
wdrwzxaby3f1OHVfPiTFkZe0sRvvi9mPGOfDjgstH49iBzifiB0KyIcelgg1
OWyW69HTfWP5oPXym6EI9uox+ajOtAKI38eyPLUTr/cRo8qfrQXwZ9DVsB/b
Vc5noo25ED55p9q0Ys/taoJm80JQOLc/oRSbymhDrRcpAsce063e2Om0UO46
vSJoPkYbtse2nC1Vrf2vCD6PuhmZY//uYw2p6iyCtUhzdXXslo8vVcojiiGS
qWJ4dQcZmZk2702oLIY797hEJ7Gn1xm2e04Vg8+WVxzd2GxqJkyU4yXArxs1
V4JNKRf8WrVQAjcei0/YYjcaaX9I3fkOJisMYw2xjVec3zzWewfyhJa/Wtiu
h1vCtFPfAaUy9c127Nx3gcZfz5fCee1B0frtZKR6uVw/26sUuEbldxdi1y+N
UwKzSmH7L8mWBOxhRR2J08xloNULEvbYwkVM0835ZeAk8i6RC9v/ratX15Zy
+KF+J5giQkaCZ9Md3h8th1C/h3/EsdNnWi3jb5ZDpvLhWRJ2pewhHZPKclgW
OdH9XZiMlnMmuQbsP4Dk8RD1K9hWr81Txr5XALvvspDhNjJa0A0Or1+pgHJ/
qwfK2D5jFb5Zkh9B6a3+E37sBCnh27ZeH0FoW53tj624fp2fiHETQJC2536y
BvaLH2kWqzUIZFfDPLiFyEgqxv2NZw8CAvHVgwlBnF9mp1YZ5hAMWKztrsZG
fxYiiCKVoOC/75wT9u9NmnWcdyuh5NfLPU0COB5PDMiK7vgEkm7F3c78ZBT+
afvacdcqYM/QL3HnwevjP6f75VkVrO4XbdHCfnm2JvJEShUInywJ4cHO77M9
cPobtvS25SxuMvqxXm55Wawa9stV23dsISPOI0b1t75XQ7JT29mdXDg/C6Ki
giRrIHf8itEdDvz+h2OihtRqoHlv7/692P9VxkapXKyBu7+lXo6yk9Gd7wlR
g49qwDSn394U+8LEyyilgRpgYk4oOsFGRjvE8qJ642vhx2pYJBcJ1//QL1Gy
3HVg+YHMa8aM99uBFvV99St0Nx4NP0UjoZqG9ZUI7gZQCiuTYMDOlCSYGUs1
QFb/QFr+MgnZ/OKUGjvfACHECFcB7Dkd8XdMWQ0gnvLOt2+RhNZ3nO5QuPIN
LAulnzsskJBgY6pgfFEjJP09GRjzh4ToUq89LL42QjHDvg962N0P3/RJ9TfC
4nFNdgbsRJWyzCKO72AlFUayniYhibTvyt8tv0Pv4/+KFKdISEjtvgwjuQlo
+iMnf4+T0G6+TD35kia49+39ScMREjqTot7BUNUEegd35nJi35PttvzW2ARL
IwJOVcMk9E2X8z+rkSZ4o1gotx/bydPpVTTfDyi5YYBIQyT0aZTCsnb3B1jZ
Eomt/SQ06dQVUuf1AwKLzuQEYfMzOYlEBvyAZOfVnpPYN4Uz5GVf/gC3PMPu
z30kxHV2k6V58w9oYTkainpJyKSs8+PnA83A+qW3tfkXCT3VvnsyVLUZnHOj
VqKw81s5fproNMO2vJyGq9jEPzC9ZNoMUO7kMtFDQtli6cLSQc3wYchebDN2
ex5kLsY2w5th6Y7ObhJiUOuUq0pvhuYtLDpp2Ocvc5w0rmgGfqYz5mrY9GeO
7s+nmiGIrzHfvYuExLdyEI1ozfB+ScP9BLZ+RlqwJLEF1FiG2ISxX1R2ZCDh
Foj9axdV2UlCOotq7XMnW6CGeiqAH9vxYYf5x0st8Nqrs2+qg4TiuBynAixb
4FLfe64a7GnpNILEfy3wrKuBxR07wpRd7tLrFjAJ2OU59pOEkqUeZk4WtcCu
V0/vfsF+PUsX8alsgb65BZ1M7IqH46ScjhaY8laLvYX9Rc/CU2OoBYiDIHQK
u5mva/7nnxbIFw/yPIA9klH3m4m1FULKpZno7SQ0Y69+IZq7FW69dxLrw6ar
lNbt294K1DHWg7XYnA2ZhZcVWiFy9Tt/NLZgxE7paUorZHV3zz7A3mUSnfRQ
rxUmfv+usMFWnHnin2vZCmMMx+SPY1NK//07ZtcKOw9d6D2EfcLH1bnzHv58
T/kDUewLJ/+M3/FthSspn4W3YJvwWpsRQluhbKjoLSP2jV+/22ISWuFNQ4P6
fBtez/SLJ2VftcL5r5qNw9gedo2ourAVLMfPXe7EfqKspWiIWsHk++7+b9ih
jBVZf762wquK8ZtV2PH1CqKPf7bC28Sq+VLs9LCcyK2DrcCz0uT1FjvPWIIj
b7oVPrDu2/wau0wi4cFxeivYp02mvMSunuZd6iK2wU+zHaqJ2I0lz2zst7TB
V/bv3THYHd6EAaJIGxT5//OJxB7Q9bgUJ9UGQ79yD4VjT3IvNByQb4MjMm0T
odiL3bc1agB/37drbzbMkDZYYnSyDYovnvAMw2a7Y7Rv9mIbWLywuRKBzavU
kuJr0QbRndnq0djbGU4KCt9pg3nfEaV47D11nwLfurdBaNQf1RfY8qGHmbUf
t8GnW9FnM7DVjPLdeoLbIL07yyUXW0dcetohvg1Utf9kF2Ofm3phyZrZBgIL
on8/YhsXC3XGF7TB1NDq6XpsK68Q/UMf2+BUoFxFG7a9Drm6tr4NtH7cpQxg
39vyQOVqexvwLl//+Qf7Uddy7lx/G9QkZj9cx37+0l786VQbDL8eOs6J9zdF
wWxzAaEdWl96cR7Ezl7/+UiHqx1WT/3j08Qurj1N/7WtHfw/vFK4jF1/BYZJ
cu3g897t40Ps1l0lholq7ZD+8Zl0HPbvif1NcifaQaLj1ZsC7Ln729+bmLdD
i2wSmYq9LWUtuDCoHaaHE1hMcD5sNXB95xPbDjIVwoIe2IKk2d4zae3wONhA
NA6b987Q/qmydkg+/H5bDzbH4a8NEiPtcPFcb+FNnK9sU5oL8zPtoGTR+jQI
m5Rcse3TSjs8M8k0KMYmsuTfMtnyE+aeKnSx4Hqw/iOaFKX6E4q0SMEF2KuP
uA9c1/4JWqflZfqx6UrPLsmd+wmc320rN+P6spjglf7d+id8etzdbof956aV
JinsJ6yuJ2YdwfWqj1He233sJ+zJCuhnxPXwd2FOhvbCT5DT380E2D3Wkt/5
/v2EM8fChO5jd37buj2ftwP4rKh7V7GbYxjLx6ED0mPp7URcf6sOfl8yiuyA
Z7vLGLVxvf40pLND+kUHcG3XsQnDRlGftJaz8PV3H37pwy5fK4oIr+yAc58s
L3gOkFBhXbzct8kOSLUj5FYP4vwyv2WndqwTqLt3Ejxxf7m6cG/mr34n/K55
ydOPzfskwCHHsBNeW6YqHh8lIZ/s7LvCjp2QYeNeyEUlIdOlaVd6cidwHnnm
UTiG9yfwrnfxeieYfzV5sR/3N793HiH7y7pAWnPTJirun5STgdwjn7tAgldD
0uYvCS3/SghL+NEF/UkiR2exrZg/RnCMdUHg0+DL67j/augzxo4LdMOrxSol
cdy/6YOPU9Kdu+HEtER/whru35uDCrYf7IGJzck7j7Hi88KzFyOcqj1gEHTm
TBf2J1Kh0D+tHuDZ5qrpiOcFIaZOr17jHhges3NNJZNRzcIuveSnPcDYQv67
Bc8jO7qKh0T7ekC/dK2IC88zzam/+SSCfgGD3GfXaDyvKR3e77Z36jf4fZQ6
m3kIf//c9oihpd9gdnCftLUcGelnbc5PYOoFqv58yG55PA8Kz05sFuwFVnEz
tgwFPG+tF5guaPTCR95E31xlMpr5pKL9IboXdrsMDLerkVFr2q4AyV19gBh9
k31PklHg/v2Gpd/6oNK5tlvCCp9nlUT3kjQGYHQz7XhTCj4PLl//6Kw9AHpb
f3/Jf0lGF0tfnx/UGwCHq7ZiEalk9PyIvEfFpQFglne+fCWdjBgo2t+cbAcg
d+BFcO8rfH7RsbXrjx6ASvVDuf15eN41LC0o+zMAv85WX8urICNZz7OqtgmD
UD5v5CHUiefPN+b3T78chBof3Xt/sXf2OVQcfDUImiMeDU1dZMStEUpZLBwE
/crrVo97yOgvsUXTq2EQ6u0/HR3pJaP3gRdOhawMwsdrt2YfjZCRdsIlk6Ir
Q7BP+X2r9Dw+HzRaJ0WZDsE5Du/N09jK/1z73K8PQXiOx628BTKSNo+2UHMY
gmG/gP8OLZLRJolOq9qnQ3DYqHlwLw2fT7IN7TpLhmAHe0/G3DoZmZZf9V7j
G4Z2hbW4WjIb0mG/qli9DXu53/4mGxs6YGg86S86DPlTwifY2NkQ07LhZcF9
w6Cmv5VFl4MNpctdPiCnOQzbLKOflXGyoenX5/puOA6Di/q5XbY8bOgn7Wyk
rNsw3La53b2OjXTO6i3eH4ZU94fPgnjZUOjI6XcP/YYhppO7NYePDSnsOhWc
mDwMTZ07Rn8JsCGPGG1Ka+Mw6M5kxrELs6HrVK3F2NZh0OPSCXyGra+klW3e
NQzpMcu2HCJsaGebpuCf4WGoP1tDJ21nQ9VcGjPktWGQDbyo+HcHG2J/qpoM
e0cg7z96f4wYG1poP3KR5eAIHIpljCSLs6EeiSMc3xRHwDHbXs4NO7dKxc1Q
YwTcxP33nJNgQ+f+KZ5xvjIC9rvsV5d3s6FYl4MMWU9GQKVrBx+3NBu6X3Zw
M2fgCJDusi7fxDZbP7jdIXQEcnwtRhD2bt9DqkoJI5BVAsO397Kh/Ag5t6r8
EWiOzLxVLMOG6gsVZrp/jYCqd2mYiCwbyllW+Kc2OALm8SBjhR2sqsiZQh0B
rvfmTTnYF6sVZW7Mj8BYQ8ORwwfY0ECL0o0F0iiYlM290D7IhmhzKn0c8qOw
FBlWKy+H30/x8B87lVHovZcheQe74t7h9Wa1UdCp8I1Ix37EdEQ4RncUZp64
xPHKsyEubtXLEqaj8PeNzMVh7HkDVeun10Zh/FeStIACG2qPUXWZuDkKfTey
OXWw40WPhr91ws9bjGXJwJY6qNZ01H8UzMTvfriiiNffWa03OQh/f5Mu/yPs
6Xdq08wRoxASTffOwS6kAEd90igAUSZwDZtyhqJzsWgUrrct+YUqsSGxcMql
0jL8vM7ye0XYLB0UK2E0Cgy1bN4/sRtM1R8N1I/CP613dYLKbOiynQa60zcK
Ejp/LYOxBcU4PbRGRqHu+sHTudg/2zuVtk+OQrOYyJ6v2BfVHN58WxqFeQ3x
LEYVNsQ/p3o7bW0UiOYGF7Zht6WRJO8zUyE13HxaDvvCpuREmc1UOMauv2SO
zVt525DARwWDPxesXbFbnJT4e7ZSwUjsUX0AdqgUc3PBTiqI7XQSTcI+19MY
GLCbConWH23eYm8JjtW1lKHCijdTzifspmNWxCOHqNC40D3QjH06a81j/CgV
KtbaDs5gc5rWKX86RgUZv6N6a9iN3BELMbpUsLhUZ0I+zIYCa8zyHE5TQblG
9BYvtt49GRtdAyr4ic7e2Y7NsX9ZUtSICrpJg7aS2F/7qwaXzaiQYpRhLYvt
HxGU1GRFBTaDSWNF7BO6RkaZNlQwvXFNXxWbbW23gLcjFVb1qlTVsevy5pov
uVGhM7hC6jj202sVz2U9qRAXvolHB1tH0P8E6yMqFD+5uaqLTWowYOn1o4L3
tcDhE9i1XqKfioOocHJS4fuGfeWm7j+PoEJ0qmjZxvVao+9UrOKoYN/OlaGN
zRL36O/RF1SQD/gcqYn9Wf/MW74MKsQ8ZfanHN6IZ2HbqWwqvNULfnAEW7N4
VOpzPhWoZDlPBWzCrYKh+HdUYH9Z6L0fu0rEK9mpggpaGb1+u7F9fpww1qum
wm5971gRbI3H/ILi9Xi/7l4r4MFmUhloWflOBZZwozYSduVkTlBLGxVEvygy
buyHd7L7yaxuKghVflHa2C/KheOsD/upQP487D6A/Y91S5XhKBXs3lh+acGu
eN/jeWiKCmFTQuLV2EfFnBb7l6lg0x7OkoK92g75petUGOHgCgrCLvdnvxNC
GINzGQekPLAPz6UMU7jGwCa1N+gcNj3tzgtB/jGofHjATBW79MrhqzPbxoC5
NEtTAlu58kdrkuQYHGUqPrWA43/ZKSHYdd8YuHPyOHVhl0jd1DstNwZDVxTz
P2IrBjNUr6uNgeHwPfcn2PKmsgVXL45BpNTiKQ7sadbV2h9GY3C73sp3Cudj
Rt6XnuPmY8C1vEL/hr2VyYJlv80YJNu8jXuGzZAWfmX9wRgIV538wYBddsr8
juOTMbi30sPQg/P/7uK+hyPP8O8ZHHYsxh7Rrs1ujBqD2CcxojexG8Zp/xJz
xiBu+Dz6jOuNb1gNL0/BGHiK3Ngahw2qYXuevBsD4xKvD3bY+YEy5+2qxmBn
JOcAP3b0AdN06BwDaZd95ca4vlm6VOv1EcbhsBfNsfYQGxLeEWJ+gW0cLvB3
fwrBbq+96vJl8zioWNncNMLWEVpKyts6DmNmohWTuN7uL98z731gHPyzAxNZ
semMQTGixuOwtUGUeQeu16GBV0YsCsZh+R1DYRfuB1LpsxknS8chquqocwB2
RYXfTfmP46DwYTrkCPb4n9JJ4tdx4IuwG4jZg+Pv3Nb5zIFxqOO7xHhaig3N
8nf/m94yAWqX+Y/F4/50JtlY6D/7CVg17z72Ffc7zgJTvbB9k9B+qjW8gpsN
hY+N+JjJTYKFR+3rs9hbd94p3acyCQn3Em4PbcH9KdBj9xfNSXjDdWyOhA3W
MQxrRpPw7oTXQf3NbMh+W0uhlf8k5JnLXq/H80DzQy2Rw6OTMPqI2BFMYEMR
F/ZN9yVPQeCpQauAv2SUJK/cpLkyDdGO3lNRHWQ0+Dho7qbKDBjcX8lNf0dG
nI0qRyVVZ0AqbYuTDPZh/qEnQ2oz8KCYmSu/hIyC05VFTDVngMTQXVteTEZq
tf3aF07PwKvpfr6mQjKKJsknqF2fAc5Kv81TeD47FdChzRMyA+iARuRiJhm5
tfiENoXNgODUtzgn7NRt+34FRs7A/qGPunMZZETPeuBIip8BQkBp1CSe/zIb
pBPW0mdAuH9XXQ+eD5k478+Nls9ASmxk16tkMioJFk0op86Al8SPB9QoMuqy
PrbLZmIGcjSNkwyx19WuZ2ybngGGKM09DZFkpDmV+fbe/AwM7NJxz4nA87Lu
gRrl9RnYZMHy9UYYGU0zwZ9CnlkQNfl5AD0nI3FnY/UctVl46rwm1/+IjHT0
PGuM1WchqlTplCr2bbHkkxyas7BZ3vxx5EMyyv8xaHBbF99/QExHx4eMYP/t
W3suzEJmvk1jshcZGY66h6XdnIUdrJEhYvfIKORK1HBC+CzwtNw0vXqHjFKo
2yufRM2CY1C+sa8tGRW6psc7xM5CRpnKVI4NGXVEFJ0/njwLfKYRZcu3yGh7
c0vlZNYsBOgyvPKwJqPsE1yJR6pmQdK0efawGT4vHPG72Dk7C2JNSjP3zuD7
67kOVS3MwuD5Z3z2p8lo7Er0ppwl/Psfn7llqU9GHG4Z1d5rs3Dzrk6Uph4Z
nS/8fEiKPAf1M4WFM9pk1CfDtNl15xwoLlrWTeH5ny7yXy3v6TmQMBDvvr2X
jJ5KPvzecHYOzktNOCtL4/PNwYCfjy7MwSFnP3XmPWQkrxk3unBlDtRWWa3D
dpOR3a33rG3X5mCTyaPvCaJkNFS8oh1xbw7aVJxMDAXI6Ptpjy986XPQIPRq
sx0jGZlcedT0LXMOKvNqnzIwkNGkxbOOx1lzcHbAanfwOj4/u8RT/+bNQQV/
ddOrFRLSjC8ntb+fA57Q1T81+LxWRl3VifwxB7fDCLOZ+PyX+uB+Hf/aHBjN
MGnxNJGQ6LEJSTLDPMiF/DHSbiShRMIV3xWmeQhSWLB1byCh6Cfyx/pI82Dn
Nxv08wsJBQROlL/inQeOuUhuj0oScoy5kqcqMw/nj6q53sjH58e3ClEWRvNw
/+SNh0OhJPSrb+pabuk8JDyVO6d0moSE19UTWx0XIGBH1chiBSuKLytcerzj
L3CvP/kgJceKshwjxhu6/kKYbUCsQywLWqkLX0v0W4Q0zkAPa04WdLbXNfef
/BI0zuyzb3tOROFiL56MKi3BwCGqW+MzIuqwrjf7fngJjn6pGfriT0RmM8I8
SZQlqF6enqn0JaI7jJ9c1fSWgNHuoORnTyLyF+NQv2+5BBeGhSy57Yio2jq5
hR6yBOIe0zu7zhARKbsueyB8CQ7EmaUQThPRyZm5x/VRSyCabN5x4BQRNbsd
V45NWILP4hq3n+sSUZ/feLzKqyXwurx620SDiNay5K3c0BK889n55bw8ESnO
fFn+O70EZ3KOB6QIEdFiruN61uwSRE/HHxYTJKISW2GCxcIS9HUfTErjJyLl
CbvNjbQlmOulBr7hIaIjI/y70wnLYFHzZk/HJiKi9Fw7f3HrMrBnzYXcZyIi
3S8MucXHl2HozH6tXVMExPbkdYGNzjLknZZR7pkgoPrjF0p3nVwGDQkXUvQ4
AelVZVQ/P7MMV3LO6/BRCUi/Qr/bymgZLhbbWe4eJKBzhfEkAYdluDwTMPOy
k4CMk5UtXeOXYTEzSJbnCwGxC+h8tE5aBk97s/KFGgIqC7y07XLKMvCayiZ1
fCYggf9cWpQzl0Fk6detjCoCajYoPEYvWIbQfR6K5h8JSJf9gPj9r8tw7l25
s1YJAS0/AG/bxmVAfEY/TxUTUPqyfs/VH8sQcIQ/8VIRARFGbMPVfi7DiuZZ
E8cCAkIoi8AwuAzp6Vcrq98QkKKL5LAPfRnGfOJqfmUS0PCkovrdtWWQsznT
w44dbqmVYMlAA6VbPZaqGQQ0d+a6gSYLDegV5l9T0wgoZ+/Lz0RuGiiUC3CF
peD3TckXXeSlwRD30y+tL/B6Cn26PyJAg4ZUx2VB7Bss/Qq1IjSgzN2ozEwi
IPH+7elP99BA9etNtpF4Amq5tJ/JXYYGviVaIUewfRqPmtyUpYGc4u/wsDgC
6n1vzH9CgQY6vtW8J2MJKDYy1pddnQbrvIOkjigC2qLHb/38Mg38x2tO3Aoj
INWj6X/0jGgw4/7WeSYUP3+/ohu7CQ166+Ra3bAR10W/p5Y0aNs+tC84hIDs
2yKyfO7QwOSrqHlnEAHF10jIqzvQ4FngioID9peSovJ/d2lQe1FWgx17R2zb
Nw93GkjaPmTSek5AjSZ8My6PaHD03oJs+zMCop9Oc1N4QgP70aIGL+zd6gqM
C3404FUMTt2L7SlmwO0QRIPGfY6s/gEE9Jp3OFY2lAY5DDZhqtjtRGex6XAa
HN9laTzrT0D7qOHyt2NpEKJzKMMc+3Kn+Ic9CTTgEGSQFsF+VF94nJpEg8Dh
4okuPwLqyW69eD2NBhZjP/ZdxX7mwOtumofXe+ZpmcdTAnpnkcq4vYAGjsXX
NU5gD52X9+8posHusxKbtmKrKl6Iu/KeBnERRrboCV4/ySExwQoaxF/uYY7C
Dhd0ym5HNBDQuNBrhz1BD/twvoYGC/YnraWw+SfFtLjraOAg2MtLwtb4VdDY
9JUGgvWh5HFfArrTeOxSUCMNUm8vHG/Ejv3Y0nvqBw1e3gurL8SuybO8wdFK
g9LtjNEJ2HMv5mfq22ngrdKU+xR7e9hDd79OGsCNiM0u2Cce8TDp9NDgEu9o
2XVsF+eX/iy9NPjue/XtJewUKzmez/00aF0JnT+J3XipKu7hEA3UisV8NLBp
OufFNUZpwMeTe/UItvjhwWyGceyEZl9F7DN77yp8nKTBoZ3y63LYHsLMFff/
0GDbB9fqDWduCtNSnaNB5apmlwJ26/qu7/QFGnQNHqccxmaYyb9UukQDSxbJ
JQq2TL9GnyudBtJxUf90sS83N99QXKOBcpiuoQH2oyqL2YV/OB+yZ1ktsfMK
59wLmOjA66xNvovdk+bD5Eikg5UZ0fQxNmsUd8ABEh06eqnkWGxpga36/Wx0
MEz3CcnD1o8S3RK6iQ5XOx9drsN2FNjTqsFFh8mh16ZD2JFRB6LmuelQd7Yg
gxHvV5mAsmEqHx0edpseFMX+HQUiBoLYvs5rGti7o/VfFovQ4b0Go1kg9gnB
i1bWO+lQFsS9XIR9J/rqHkExOhS8qGrrwy6OtnnjLkWHS18srx/F8dUl6OQo
vZcON8vZheyw16P/U+jeR4ci8898L7G1Yvzfq8rRweU2+/QWHL+3hEI9pxTo
MLDb4ase9vOYGPVEZTqQXOL++mG3x2TW/jtKh29TO+XZcT7QhfL88yh0SN/n
fuI09vbYklPmx+hAuRb8NgLbKram5ZMOHSQ7pV324Hzz39oYefckHbYrN7e5
YOfGtl0R16eDDvGBfw32YuxQ7+PzdDAZdFmywfn7OI5pUseEDuTUJwztgXj/
t7G9oZnh65XZ9ijietAQt8XxtSUd9Ab25kVj88bvXGa/SYeLWf6913D9SI1X
I3y/S4d2pQ6qEK4/X4S1ar1c6FDsckImEHsy/pT/AXc6XLns28mE65V8gjFX
qCcdfB+7uP7Frk64J2zgRwf6SNrUUjgBUUV8eonP6OB0KjnLM4KAOBL9Uoqf
00FJ2rqPNZKALiRGSwmG0+HBK7ciUVwvhxKL5bsT6fD7g6P63RgCYk6e0zMv
pIP2FDkxKBHnb4eplV4JHaL9T6eewvVaiuubl1IZHay/x5dwJuN+6J2RvwnR
oasmY0ssru/hZsaCZV/pEJjwfKotFceHaM0g9yAdPE/k6w9nEZDyFbm1tWE6
LDyted+WjeMlJJl/jIrf584lu7ocHC+M/+l+nKaDvMpKWRnuTyX9sm9u0+ng
+sPB7DPuXzopMfeqt6xAh8IWbq9yAjLsYgl/w7sCKclC/OkfCMiG2yknVgB/
fu7xm6YKAgrx0e+zF1mBe01fSg9U4nizYNYS2bMCEtE724Rx/70tZrvFhbIC
S9XjLa+bcD026pI2P7YCnRTh3ZzNBBQcpq2pp7UCqqQUN+cWAipk3uW6S28F
Ko7NHj3TTkCrg+09jZdWYJwpXkapB8djKiVT0m4F/hOflG3G84HIpf3TfQ4r
8Mr+/c6reH7IJgvLxzqtQA+3A3kSzxdf7yx95Li3Aq3C/EN8fwiIpJL7c/bR
CuwPuJMX+5eAHnzbxloeuwKcgYyv7ZmJiMubfMo5YQVeky6cBiIRJR9aCt2f
vAKZC/k+3KxEVBHVvP1F2gpw2alU1LAREd3cT9E3bwXW7/i/t+YmIqfFxetn
albg+nHOqYhdRMT8aiiLXLcCOdUZn/PFiSjUqHn209cVmP2lNda6m4jeopz7
Cj/w+nVHau3ZS0TT/tcitvasgLgGVzsPns+sdzRXD82u4Hm48cOqFhEZ6uSI
uYusQm6ZvJ+/A54v8xmQzc5V8ImV6c9yIiIDkQvGZmKrQB0rr21zJaIzc/Rw
7T2rsD7mnHwMz5da8Tos/AqrsCj6Ya9/ABEdnBmk5uutQnHcjQ8dGUSUa6j0
OP30KhhLZ+Q+zyIimc/+orHnViG/jVir/4aIdsceNHxweRUuG5t2TRUTkbCm
19fT11bB67FU6OsaPJ9Gb82d/A/fb0AjKlGJyJfpzok+z1Vw9zALip/E62Fb
OdLyYBXo7yJYOWeJaF39xo73T1aha5bzCB+diOYnioL9wlZh/zbFuRIOFvQb
zt7dnbUKOS/FGG/Ks6Ci0SfKZl2roM0jc0X/OQuS7j+3WevXKnSU1vieDmdB
yV0iI3v7VuHr8dx2UzyvP/tWELY0vAqzwe56ueksyKKgd/r57CrwV78OISIW
xOmllPaBtAbLAZeZi/6yoEduTB4v2ddgRWOYULTKgmgO3875ca7BVObmH5+Z
WdHQNUsGA941CI0o2LuVmxWVnQgymtyxBv3rxGfBsqzIin90yzalNXhXI0T6
YsuKejbnUxkOr4HyDXpSrzMrOku+/3FEdQ3kTrvcIHuyItVVbtt8jTUIpp3s
CHvOirgH1L7o6q/B2Gykkm8eK6rIifR0u74GmmkWqX+WWBH/ca2JtrA1YA10
WDkQQUKk0pBpv8g1OJD54MZiIgmtyPyaPRqzBqvj5+cbMkmoj9dpOS1xDTx1
Tt3KKSeh10MviC6v1oCHdYl+ZJiE1B6t7eD/uAbE10f/PlchI+uqwgsXx9cg
a7JZanKajN6pi1W0U9bhYc6z2WY/dhRj2yrw+dg6VHp6bqqLZkf3Yh47FGit
Q8Iffs3vGezoyOyoeLDeOlgt/7Zlr2FHFcnZAbqX1yFeOTRYjZkDVf9TuFJu
tw586XFutt4cqOmDzsKLxHWQ9D0/Xv1oExpTuSNtu7oOEq9PqBhkbUZGP34W
P8/6B79gSClmYgu6FRZqn7SXgTL+ItGqeIgHTR+xP/fpKQMFlXu+l+jgQzzy
V6tf9zJQjM+xjB5zF0A1YWda9/czUHapEptkvAXQvfljQ/kDDJQD169Mcz8R
QAP50oT3wwyUBt3CofZwAZR/cPnY1wkGikSahJ1angA6JxtWNbHEQLHZb/Ar
ZEQABUvXfZLhYqQsyrO4/HdWEGn6lzfnbWGk3FjKNBG8LIiWx94MyPMwUnSa
LU0LTASR2atIpqP8jBTnrW61g7cFkazUNY1TwoyUs/LyrLK+gqhR4l+lrRQj
xUrHedG5TBD5PJ77MbuHkXJzh+PCEhJEisPD/c57GSnFxKlHbrWCKDG1gdFz
PyMldTfJw7lVEN0Ri1V/Ls9I4b2tGmM6LYh2PQw8y63ISGHpD2P8uSCI2ge8
zSOVGCkXJCNUTq0IIrUU6weJhxkp/Mp0RUWSEJpjNArZpcpIESI9YX/FKYTS
zfVfpB9lpNxi3Ny4lU8IGVaqv5UGRspATf+jgG1CaJOoQmUuhZFyYO/BIyui
Quh/b9wcUg==
     "]]}, 
   {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
PVOZS6AjvOWg/YvcFEH/B9NxUD4=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    LineBox[
     NCache[{{0, Pi}, {2.1565833621823303`, Pi}}, {{0, 3.141592653589793}, {
       2.1565833621823303`, 3.141592653589793}}]], 
    LineBox[
     NCache[{{0, -Pi}, {2.1565833621823303`, -Pi}}, {{
       0, -3.141592653589793}, {2.1565833621823303`, -3.141592653589793}}]]},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6298272932284956`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
VLN48OTbQ/1nLw1D/vyA7/dHPPjXvN2TDYHDMFb8ZK1VGA/G1nY2zKBh+J2+
3+X5VR4cN2L75c79YcieLiH9duLBm9X3x6amDUNjSmv+HTUefDPRCrU2DMOa
y+qbuzO58enR3cyk1mHYqxs2zP+UGx/YsjvbrWsYVkfTrkhEcGPVNkv5qeFh
UPbV/VDiSfxPJXbQhDjDsPmTeeGjNdxYOMI0DdaPQN+1toeu/3HhpKuGpKzw
Ebjl+XHDXz8SDio0FBeLJvgrpqerTpKw65Khil/cCDgJczXG7Sfhtfc2mm5J
GQGpqjvK/9aRcF7CpsDyvBEQvK1uZFe8TKnJ30zr7h2Bon1vPq2JXqLMT2/r
FzH6A7W73eN6JNmUo747sE//H1C4ynv8eBWTYnRyw8cTjn9BavzUO4WrVEpc
9LER94//QNMo+Jr+QBmIfTxpE683Dmhvp9i6tzRIsNeb7E+bgJU3aWaZcssg
G/IpaG/GBHGuUb1wZ/8yPMkyE80n7nlxF5O8ne8QmPuAbnjBBGx4FczmTBL4
vc95vboJ4HcO1+bxIKGnIu9HrrEmoGLvzcjL27hQ0veNfZIHJoF8vs59ZpAb
PTPa+tNycRIerX/uwq/Cj9iNUSIaXFPwkpb/02QbPzp6oc+aS2AKit1aWSfs
+ZHki3ulxZJT8PODzG+fSH4UJt6WZ6wzBeotF4Tfz/Kjs//8EtYdI3gh3r2H
qwTQxrQsJ5HPU7DLL1b6n5MQerh9+cm/oikoqJI1UvIXQmPth1qqyqbgiH/M
vF6UEEoXXdh3t2EKdC/9t26yUAjJ3bA2WxqeghOHLz75Kb8CLb2dFg9cQQPu
4zJT8fUr0NDdmOlz22iQSA0YPCsrgsQatplpmdJgOn3P6ZXrRJCJLDWcak4D
nQ27iiO3iaDYjK3KJy1pULvyz+EJZxFk/mPAyt6WBsdq9rw8mSqCzok/iFt5
iAaH5A1db+aIoMdHjHsb7GkQ/20u5VSJCBr7E3lpjxMNhivVOx/3iqCngkYp
5qdpcJPJn+eqIIrKD/7+s+hJg77zRkMVWqJo8mnExq/naQCN9ZO0zaJol3bv
j00XaSAqLJOVYCeKpvfcm153gwYHdtwS5bsnilTiDMxGggh+LORiWJwo2tPV
Ff4yhAaNtNXfylNFUdr5Dcoq92gQnlk+F1wgivZHdVhJPSLmufoooHlQFAW2
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
c2kO4kIBw2un/BwX4H/8eexT
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6298272946004686`*^9}],

Cell[BoxData["3.5673121308286637`"], "Output",
 CellChangeTimes->{3.6298272947545776`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"s", ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"q", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"60", "/", "2"}], "/", "\[Pi]"}]}], "}"}], ".", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
    RowBox[{"AspectRatio", "\[Rule]", " ", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.629704708662342*^9, 3.629704759991125*^9}, {
  3.629704817773198*^9, 3.6297048189919353`*^9}, {3.6297048611956224`*^9, 
  3.6297048651488085`*^9}, {3.6297050040881767`*^9, 3.6297050155883303`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pcom", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"GibbotQnts`Private`P1", "[", "q", "]"}]}], " ", "+", " ", 
      RowBox[{"m2", " ", 
       RowBox[{"GibbotQnts`Private`P2", "[", "q", "]"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"m1", "+", "m2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vcom", "[", 
    RowBox[{"q_", ",", " ", "qd_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"GibbotQnts`Private`dPcom", "[", 
     RowBox[{"mag", ",", " ", "q"}], "]"}], ".", "qd"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.629759403686988*^9, 3.629759421017277*^9}, {
  3.6297594568632455`*^9, 3.6297595772399006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", " ", "=", " ", 
   RowBox[{"2", "L1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x", " ", "=", " ", 
  RowBox[{"MinimizeFreeFlight", "[", 
   RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"0", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m2", " ", "g", " ", "r2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{"2", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "g", " ", "dy"}], "]"}], "/", "g"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", "q", 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", " ", "=", " ", 
    RowBox[{
     RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DrawGibbot", "[", 
      RowBox[{"mag", ",", " ", 
       RowBox[{"q", "[", "s", "]"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}], "/", "2"}], ",", " ", 
            RowBox[{"3", "dx"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"L1", "+", "L2"}], ")"}]}], ",", " ", 
            RowBox[{"2", "dy"}]}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{"Epilog", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dx", ",", " ", "dy"}], "}"}], "+", 
            RowBox[{"Pcom", "[", 
             RowBox[{"q", "[", "0", "]"}], "]"}]}], "]"}], ",", " ", "Blue", 
          ",", " ", 
          RowBox[{"Point", "[", 
           RowBox[{"Pcom", "[", 
            RowBox[{"q", "[", "s", "]"}], "]"}], "]"}]}], "}"}]}]}], "]"}], 
     ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"s", " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ParametricPlot", " ", "is", " ", "a", " ", "whiny", " ", "little", 
         " ", "function"}], " ", "*)"}], 
       RowBox[{"Quiet", "@", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{
          RowBox[{"Pcom", "[", 
           RowBox[{"q", "[", "a", "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "0", ",", " ", "s"}], "}"}]}], "]"}]}], ",",
        " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6297547080228567`*^9, {3.6297548087273216`*^9, 3.6297548569779625`*^9}, {
   3.6297550733112416`*^9, 3.6297550741788635`*^9}, {3.6297551513407*^9, 
   3.629755270116463*^9}, {3.6297553314453526`*^9, 3.629755341883042*^9}, {
   3.629755377711646*^9, 3.6297554055869646`*^9}, {3.6297554539938574`*^9, 
   3.629755456493913*^9}, {3.629756535910117*^9, 3.6297565477540283`*^9}, 
   3.629756579660703*^9, {3.6297566140049133`*^9, 3.62975662509886*^9}, {
   3.6297566775682564`*^9, 3.6297566789276705`*^9}, {3.629756758788105*^9, 
   3.6297567638350496`*^9}, {3.6297568463673735`*^9, 
   3.6297569684158964`*^9}, {3.6297581472892766`*^9, 3.6297581484767923`*^9}, 
   3.62975821204011*^9, {3.6297582629627185`*^9, 3.629758304369521*^9}, {
   3.629758340807506*^9, 3.6297583433700104`*^9}, {3.629758440121299*^9, 
   3.629758446090128*^9}, {3.6297595869118986`*^9, 3.629759597927641*^9}, {
   3.6297597010071173`*^9, 3.629759738210757*^9}, {3.6297598346026955`*^9, 
   3.6297598530091605`*^9}, {3.6297598893846436`*^9, 3.62975990654115*^9}, {
   3.629759984198405*^9, 3.6297600194644794`*^9}, {3.629760110215736*^9, 
   3.6297601822224298`*^9}, {3.6297603037709*^9, 3.6297603050053444`*^9}, {
   3.629760359131014*^9, 3.6297603610685916`*^9}, {3.6297606044611297`*^9, 
   3.629760616955988*^9}, {3.629760817445223*^9, 3.6297608618357506`*^9}, {
   3.6297608996018476`*^9, 3.6297609374305058`*^9}, {3.6297609847279882`*^9, 
   3.629761110792143*^9}, {3.6297612101841364`*^9, 3.6297614026397905`*^9}, 
   3.629761461515573*^9, {3.6297615035161324`*^9, 3.629761536141597*^9}, {
   3.629761572407709*^9, 3.629761645986807*^9}, {3.6297620785550327`*^9, 
   3.6297620787581906`*^9}, {3.6297621579623384`*^9, 3.629762173962552*^9}, 
   3.6297660185077815`*^9}],

Cell[BoxData[{
 RowBox[{"q", "[", "0", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "'"}], "[", "0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Pcom", "[", 
  RowBox[{"q", "[", "0", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vcom", "[", 
  RowBox[{
   RowBox[{"q", "[", "0", "]"}], ",", " ", 
   RowBox[{
    RowBox[{"q", "'"}], "[", "0", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6297660830555153`*^9, 3.629766118571644*^9}, {
  3.6297661751660995`*^9, 3.6297661901819706`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"1", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", "t", "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImpactQnts", "[", 
    RowBox[{"2", ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"q", "[", "t", "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "t", "]"}]}], "]"}]}], "]"}], " ", "//", " ",
    "Chop"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"1", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"t", "/", "2"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"t", "/", "2"}], "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"2", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"t", "/", "2"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"t", "/", "2"}], "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.629761784269868*^9, 3.629761786926182*^9}, {
  3.6297618473644867`*^9, 3.6297618868806367`*^9}, {3.6297621101804843`*^9, 
  3.629762125274433*^9}}],

Cell[BoxData[
 RowBox[{"TE", "@", "x"}]], "Input",
 CellChangeTimes->{{3.629764462898757*^9, 3.629764466617585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m2", " ", "r2", " ", "g"}]], "Input",
 CellChangeTimes->{{3.629851442247698*^9, 3.6298514433925123`*^9}}],

Cell[BoxData["3.7975839890687997`"], "Output",
 CellChangeTimes->{3.629851445721137*^9, 3.629852977608531*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specs-old", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}, {3.629138508061183*^9, 
  3.629138516540187*^9}, {3.6296722233016214`*^9, 3.6296722236766243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", " ", "=", " ", 
   RowBox[{"2", "L1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{
    RowBox[{"MinimizeFreeFlight", "[", 
     RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], "]"}], " ", "//", " ", 
    "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m2", " ", "g", " ", "r2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]", ",", " ", "x", ",", " ", "x1", ",", "x2", ",", "x3", ",", 
         "x4", ",", "x5", ",", "x6", ",", "x7", ",", "x8", ",", " ", "u", ",",
          " ", "rep", ",", " ", "A", ",", " ", "B"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "x7", 
           ",", "x8"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"GibbotQnts`Private`P3", "[", "x", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x3", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x4", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x7", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"x8", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"First", "@", 
            RowBox[{"DynamicQnts", "[", 
             RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "/.", " ", "rep"}], 
           " ", "//", " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "u", "}"}]}], "]"}], "/.", " ", "rep"}], " ", "//",
            " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"StateSpaceModel", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
               "\[RightDoubleBracket]"}], "}"}], "\[Transpose]"}], ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"LQRegulatorGains", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pump", " ", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"x_", ",", " ", "kp_", ",", " ", "kd_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"kp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"72", "Degree", "  ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
           "]"}]}], " ", "-", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
        ")"}]}], " ", "-", " ", 
     RowBox[{"kd", " ", 
      RowBox[{
      "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"x_", ",", " ", "kp_", ",", " ", "kd_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "2"}], "-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         ")"}]}], ")"}], " ", "+", " ", 
      RowBox[{"kd", " ", 
       RowBox[{"(", 
        RowBox[{"0", "-", 
         RowBox[{
         "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
        ")"}]}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"t_", ",", " ", "x_", ",", " ", 
      RowBox[{"kp_:", "0"}], ",", " ", 
      RowBox[{"kd_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"pump", " ", "\[Equal]", " ", "True"}], ",", " ", 
      RowBox[{"MotorInput", "[", 
       RowBox[{"mag", ",", " ", "x", ",", " ", "b", ",", " ", 
        RowBox[{"v", "[", 
         RowBox[{"x", ",", " ", "kp", ",", " ", "kd"}], "]"}]}], "]"}], ",", 
      " ", 
      RowBox[{"-", 
       RowBox[{"K", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
           "\[RightDoubleBracket]"}], " ", "-", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "verify", " ", "that", " ", "the", " ", "sign", " ", "is", " ", "correct",
      " ", "for", " ", "v"}], ",", " ", 
    RowBox[{"it", " ", "should", " ", "be", " ", "positive"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "@", 
     RowBox[{"First", "@", 
      RowBox[{"DynamicQnts", "[", 
       RowBox[{"mag", ",", " ", "x", ",", " ", 
        RowBox[{"MotorInput", "[", 
         RowBox[{"mag", ",", " ", "x", ",", " ", "b", ",", " ", "v"}], 
         "]"}]}], "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pump", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{
    RowBox[{"-", "1"}], "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"0", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
    "=", " ", 
    RowBox[{"0", "\[Pi]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", 
     RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", " ", "All", ",", " ", "3"}], 
       "\[RightDoubleBracket]"}]}], " ", 
     RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "ensure", " ", "that", " ", "constraints", " ", "are", " ", "satisfied"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], "]"}], " ", 
   "\[Equal]", "  ", "0"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kp", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kd", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"s_", "?", "NumericQ"}], ",", " ", "q_", ",", " ", "qd_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", "qd"}], "]"}]}], ";", " ", 
      RowBox[{"First", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"mag", ",", " ", "x", ",", " ", 
         RowBox[{"u", "[", 
          RowBox[{"s", ",", " ", "x", ",", " ", "kp", ",", " ", "kd"}], 
          "]"}]}], "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsw", " ", "=", " ", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"catch", " ", "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], " ", 
             "\[Equal]", " ", "0"}], ",", " ", "\"\<StopIntegration\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], " ", 
             "\[Equal]", " ", "0"}], ",", " ", "\"\<StopIntegration\>\""}], 
           "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "-", "catch"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             RowBox[{"pump", " ", "=", " ", "False"}], ";", " ", 
             "\"\<RemoveEvent\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "catch"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             RowBox[{"pump", " ", "=", " ", "False"}], ";", " ", 
             "\"\<RemoveEvent\>\""}]}], "]"}]}], "\[IndentingNewLine]", "}"}],
         ",", " ", "\[IndentingNewLine]", "q", ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", "tsw", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"DrawGibbot", "[", 
    RowBox[{"mag", ",", " ", 
     RowBox[{"q", "[", "s", "]"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", 
      RowBox[{"2.5", "L1"}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]", ",", " ", "x", ",", " ", "x1", ",", "x2", ",", "x3", ",", 
         "x4", ",", "x5", ",", "x6", ",", "x7", ",", "x8", ",", " ", "u", ",",
          " ", "rep"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "x7", 
           ",", "x8"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"GibbotQnts`Private`P3", "[", "x", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x3", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x4", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x7", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"x8", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"First", "@", 
            RowBox[{"DynamicQnts", "[", 
             RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "/.", " ", "rep"}], 
           " ", "//", " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "u", "}"}]}], "]"}], "/.", " ", "rep"}], " ", "//",
            " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"StateSpaceModel", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
               "\[RightDoubleBracket]"}], "}"}], "\[Transpose]"}], ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"LQRegulatorGains", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"t_", ",", " ", "x_", ",", " ", 
      RowBox[{"kp_:", "0"}], ",", " ", 
      RowBox[{"kd_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"-", 
     RowBox[{"K", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
         "\[RightDoubleBracket]"}], " ", "-", " ", 
        RowBox[{"{", 
         RowBox[{"\[Pi]", ",", "\[Pi]", ",", "0", ",", "0"}], "}"}]}], 
       ")"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], " ", 
   "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"\[Pi]", " ", "-", " ", 
    RowBox[{"\[Pi]", "/", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
   "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", 
     RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", " ", "All", ",", " ", "3"}], 
       "\[RightDoubleBracket]"}]}], " ", 
     RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", " ", "=", " ", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Check", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "q", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"q", " ", "=", " ", 
     RowBox[{"q", "/.", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"f", "[", 
             RowBox[{"s", ",", " ", 
              RowBox[{"q", "[", "s", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
         ",", " ", "q", ",", " ", 
         RowBox[{"{", 
          RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}]}]}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"DrawGibbot", "[", 
       RowBox[{"mag", ",", " ", 
        RowBox[{"q", "[", "s", "]"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"2.5", "L1"}]}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
      RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\"\<NDSolve or Animate Failed.\>\""}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.629494374457761*^9, 3.6294944482462163`*^9}, {
   3.6294945064025493`*^9, 3.629494571884076*^9}, {3.6294946117254057`*^9, 
   3.629494612323839*^9}, {3.6294949485207815`*^9, 3.6294949535253487`*^9}, {
   3.629495016836317*^9, 3.629495074058013*^9}, {3.629495112521323*^9, 
   3.629495127961317*^9}, {3.6294951808919373`*^9, 3.6294952354236956`*^9}, {
   3.629495286185773*^9, 3.6294953167825136`*^9}, {3.6294953698272195`*^9, 
   3.629495380542836*^9}, {3.629495445283842*^9, 3.6294955032850747`*^9}, {
   3.6294955547486424`*^9, 3.6294956306766214`*^9}, {3.629495699591573*^9, 
   3.629495810453379*^9}, {3.6294958453601947`*^9, 3.629495879097166*^9}, {
   3.6294959340091934`*^9, 3.6294959498584757`*^9}, {3.6294960742538595`*^9, 
   3.629496107449472*^9}, {3.629496191860468*^9, 3.6294962264370394`*^9}, 
   3.62949652433075*^9, {3.6294966601703153`*^9, 3.629496698315421*^9}, 
   3.6294967676326747`*^9, {3.6294968843996677`*^9, 3.6294970789419394`*^9}, {
   3.629497112431743*^9, 3.6294971936724625`*^9}, 3.6294972273053665`*^9, {
   3.629497270286945*^9, 3.629497319080595*^9}, {3.62949743546131*^9, 
   3.6294974623904696`*^9}, {3.6294975127642727`*^9, 3.629497513097517*^9}, {
   3.629497812472268*^9, 3.6294978954702716`*^9}, {3.629497931042548*^9, 
   3.6294979957093353`*^9}, {3.6294980571319823`*^9, 
   3.6294980621265335`*^9}, {3.6294981257093678`*^9, 
   3.6294981435340347`*^9}, {3.629498225474272*^9, 3.629498229297993*^9}, {
   3.6294983057243185`*^9, 3.6294983065519056`*^9}, {3.6294983993988843`*^9, 
   3.6294985540698156`*^9}, {3.629498588176049*^9, 3.6294986184155474`*^9}, {
   3.629498686556981*^9, 3.6294987702274466`*^9}, {3.6294988013195443`*^9, 
   3.6294990090862193`*^9}, {3.62949907608383*^9, 3.629499096215144*^9}, {
   3.6294991365648174`*^9, 3.629499136650854*^9}, {3.629499180430971*^9, 
   3.6294992112499027`*^9}, {3.6295084503744373`*^9, 3.629508500371955*^9}}]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowSize->{783, 607},
WindowMargins->{{Automatic, 25}, {Automatic, 29}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 181, 2, 70, "Section"],
Cell[764, 26, 99341, 2394, 7314, "Input",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[100142, 2425, 148, 2, 70, "Section"],
Cell[100293, 2429, 6919, 178, 772, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[107249, 2612, 194, 3, 56, "Section"],
Cell[107446, 2617, 661, 20, 52, "Input"],
Cell[108110, 2639, 23332, 460, 1072, "Input"],
Cell[CellGroupData[{
Cell[131467, 3103, 12715, 179, 132, "Input"],
Cell[144185, 3284, 152, 3, 31, "Output"],
Cell[144340, 3289, 152, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144529, 3297, 15846, 272, 552, "Input"],
Cell[160378, 3571, 90, 1, 31, "Output"],
Cell[160471, 3574, 260, 7, 33, "Output"],
Cell[160734, 3583, 2094, 42, 454, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162865, 3630, 4847, 125, 152, "Input"],
Cell[167715, 3757, 35933, 604, 230, "Output"],
Cell[203651, 4363, 21888, 370, 229, "Output"],
Cell[225542, 4735, 90, 1, 31, "Output"]
}, Open  ]],
Cell[225647, 4739, 994, 25, 52, "Input"],
Cell[226644, 4766, 787, 21, 52, "Input"],
Cell[227434, 4789, 6526, 153, 572, "Input"],
Cell[233963, 4944, 500, 12, 92, "Input"],
Cell[234466, 4958, 1463, 44, 112, "Input"],
Cell[235932, 5004, 116, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[236073, 5010, 129, 2, 31, "Input"],
Cell[236205, 5014, 110, 1, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[236364, 5021, 248, 3, 70, "Section"],
Cell[236615, 5026, 22295, 490, 1392, "Input"],
Cell[258913, 5518, 10081, 227, 752, "Input"]
}, Closed]]
}
]
*)

(* End of internal cache information *)
