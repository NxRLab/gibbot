(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    315422,       6690]
NotebookOptionsPosition[    313460,       6627]
NotebookOutlinePosition[    313834,       6643]
CellTagsIndexPosition[    313791,       6640]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["GibbotQnts Package", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
   3.6289934659285192`*^9, 3.6289934747067785`*^9}, 3.629089629414613*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<GibbotQnts`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"DynamicQnts", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"DynamicQnts", "::", "usage"}], " ", "=", " ", 
      "\"\<Based on which magnet is on, state of the robot, and input torque, \
this function outputs the robot's acceleration and tangential forces felt by \
magnets on each link.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"ImpactQnts", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"ImpactQnts", "::", "usage"}], " ", "=", " ", 
      "\"\<Based on which magnet is on and the state of the robot, this \
function outputs the robot's post-impact velocity and tangential impulsive \
forces felt by magnets on each link.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MotorInput", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MotorInput", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns input torque u such that b.qdd \[Equal] 0.  b can be a \
vector or a matrix.  This function is useful if computing a (partial) \
feedback linearization term.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"FreeFlightVelocity", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"FreeFlightVelocity", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns velocity of robot at the beginning of free flight required \
to travel a horizontal distance \[CapitalDelta]x at a maximum height of \
\[CapitalDelta]y given configuration q.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MinimizeFreeFlight", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MinimizeFreeFlight", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns state that minimumizes velocity satisfying free flight \
required to travel a horizontal distance \[CapitalDelta]x at a maximum height \
of \[CapitalDelta]y.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"MaximizeFreeFlight", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"MaximizeFreeFlight", "::", "usage"}], " ", "=", " ", 
      "\"\<Returns state that maximumizes velocity satisfying free flight \
required to travel a horizontal distance \[CapitalDelta]x at a maximum height \
of \[CapitalDelta]y.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"PE", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"PE", "::", "usage"}], " ", "=", " ", 
     "\"\<Potential Energy.\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"KE", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"KE", "::", "usage"}], " ", "=", " ", 
     "\"\<Kinetic Energy.\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"TE", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"TE", "::", "usage"}], " ", "=", " ", 
      "\"\<Total Energy.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"DrawGibbot", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"DrawGibbot", "::", "usage"}], " ", "=", " ", 
      "\"\<Draws the Gibbot.\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"g", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"g", "::", "usage"}], " ", "=", " ", "\"\<gravity\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"m1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"m1", "::", "usage"}], " ", "=", " ", 
     "\"\<mass of link 1\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"m2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"m2", "::", "usage"}], " ", "=", " ", 
     "\"\<mass of link 2\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"I1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"I1", "::", "usage"}], " ", "=", " ", 
     "\"\<moment of inertia about com of link 1\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"I2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"I2", "::", "usage"}], " ", "=", " ", 
     "\"\<moment of inertia about com of link 2\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"r1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"r1", "::", "usage"}], " ", "=", " ", 
     "\"\<position of com of link 1\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"r2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"r2", "::", "usage"}], " ", "=", " ", 
     "\"\<position of com of link 2\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"L1", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"L1", "::", "usage"}], " ", "=", " ", 
     "\"\<length of link 1\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"ValueQ", "[", 
      RowBox[{"L2", "::", "usage"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"L2", "::", "usage"}], " ", "=", " ", 
     "\"\<length of link 2\>\""}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "@", 
      RowBox[{"ValueQ", "[", 
       RowBox[{"T", "::", "usage"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"T", "::", "usage"}], " ", "=", " ", 
      "\"\<mapping from motor torque to generalized forces\>\""}]}], "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"default", " ", "parameter", " ", "values"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", " ", "=", " ", "9.81"}], ";"}], " ", 
  RowBox[{"(*", " ", "gravity", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m1", " ", "=", " ", 
    RowBox[{"m2", " ", "=", " ", 
     RowBox[{"0.453592", " ", "4"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"lbs", " ", "to", " ", "kg"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"I1", " ", "=", " ", 
   RowBox[{"I2", " ", "=", " ", "0.04185679"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"L1", " ", "=", " ", 
    RowBox[{"L2", " ", "=", " ", 
     RowBox[{"0.0254", " ", "11"}]}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"inches", " ", "to", " ", "m"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r1", " ", "=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "0.7"}], ")"}], "L1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"center", " ", "of", " ", "mass"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r2", " ", "=", " ", 
    RowBox[{"0.7", "L2"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"center", " ", "of", " ", "mass"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b1", " ", "=", " ", "0.0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"bearing", " ", "friction"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b2", " ", "=", " ", "0.5"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"motor", " ", "friction"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", "1"}], "}"}]}], " ",
    ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "transmission", " ", "matrix", " ", "from", " ", "motor", " ", "to", " ", 
    "robot"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Protect", "[", 
     RowBox[{
     "g", ",", " ", "m1", ",", " ", "I1", ",", " ", "I2", ",", " ", "L1", ",",
       " ", "L2", ",", " ", "r1", ",", " ", "r2", ",", " ", "T"}], "]"}], 
    ";"}], "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"M", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", "c4", ",", " ", "c34", ",", " ", "s34", ",", " ",
         "A", ",", " ", "B", ",", " ", "C"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"m1", "+", "m2"}], "0"},
            {"0", 
             RowBox[{"m1", "+", "m2"}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B", " ", "=", " ", 
        TagBox[
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{
               RowBox[{"c3", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L1", " ", "m2"}], "+", 
                  RowBox[{"m1", " ", "r1"}]}], ")"}]}], "+", 
               RowBox[{"c34", " ", "m2", " ", "r2"}]}], 
              RowBox[{"c34", " ", "m2", " ", "r2"}]},
             {
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"L1", " ", "m2"}], "+", 
                  RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
               RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
              RowBox[{"m2", " ", "r2", " ", "s34"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"I1", "+", "I2", "+", 
             RowBox[{
              SuperscriptBox["L1", "2"], " ", "m2"}], "+", 
             RowBox[{"m1", " ", 
              SuperscriptBox["r1", "2"]}], "+", 
             RowBox[{"2", " ", "c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}], 
            RowBox[{"I2", "+", 
             RowBox[{"c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}]},
           {
            RowBox[{"I2", "+", 
             RowBox[{"c4", " ", "L1", " ", "m2", " ", "r2"}], "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}], 
            RowBox[{"I2", "+", 
             RowBox[{"m2", " ", 
              SuperscriptBox["r2", "2"]}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"A", ",", " ", "B"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"B", "\[Transpose]"}], ",", " ", "C"}], "}"}]}], "}"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"c", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c3", ",", "s3", ",", "s4", ",", " ", "c34", ",", " ", "s34"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s4", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", 
         TagBox[GridBox[{
            {
             RowBox[{
              FractionBox["1", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "m1", " ", "r1", " ", "s3", " ", 
                 SuperscriptBox[
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
                   "2"]}], "+", 
                RowBox[{"2", " ", "m2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "L1"}], " ", "s3", " ", 
                    SuperscriptBox[
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "-", 
                   RowBox[{"r2", " ", "s34", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "8", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
               ")"}]}]},
            {
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{"m1", "+", "m2"}], ")"}]}], "+", 
              RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "m1", " ", "r1", " ", "c3", " ", 
                  SuperscriptBox[
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "+", 
                 RowBox[{"2", " ", "m2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "c3", " ", 
                    SuperscriptBox[
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "2"]}], "+", 
                    RowBox[{"r2", " ", "c34", " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "7", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "8", 
                    "\[RightDoubleBracket]"}]}], ")"}], "2"]}]}], ")"}]}]}], 
                ")"}]}]}]},
            {
             RowBox[{
              RowBox[{"g", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"L1", " ", "m2", " ", "s3"}], "+", 
                 RowBox[{"m1", " ", "r1", " ", "s3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "s34"}]}], ")"}]}], "-", 
              RowBox[{"2", " ", "L1", " ", "m2", " ", "r2", " ", "s4", " ", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               " ", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              "-", 
              RowBox[{"L1", " ", "m2", " ", "r2", " ", "s4", " ", 
               SuperscriptBox[
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], 
                "2"]}]}]},
            {
             RowBox[{"m2", " ", "r2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"g", " ", "s34"}], "+", 
                RowBox[{"L1", " ", "s4", " ", 
                 SuperscriptBox[
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
                   "2"]}]}], ")"}]}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.5599999999999999]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}],
          Column], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fext", "[", 
     RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"T", " ", "u"}], " ", "-", " ", 
     RowBox[{"T", " ", "b2", " ", 
      RowBox[{
      "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J1", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      TagBox[
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0", "0", "0"},
           {"0", "1", "0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]], ",", " ", 
      TagBox[
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", "0", "0"},
           {"0", "0", "0", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]],
       Function[BoxForm`e$, 
        MatrixForm[BoxForm`e$]]]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J2", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34", ",", " ", "J", ",", 
        " ", "Jdot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"1", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3"}], "+", 
             RowBox[{"L2", " ", "c34"}]}], 
            RowBox[{"L2", " ", "c34"}]},
           {"0", "1", 
            RowBox[{
             RowBox[{"L1", " ", "s3"}], "+", 
             RowBox[{"L2", " ", "s34"}]}], 
            RowBox[{"L2", " ", "s34"}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Jdot", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "s3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"L2", " ", "s34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{
             RowBox[{"-", "L2"}], " ", "s34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]},
           {"0", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{"L2", " ", "c34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{"L2", " ", "c34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"J", ",", " ", "Jdot"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"J3", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34", ",", " ", "J", ",", 
        " ", "Jdot"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"J", " ", "=", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0"},
            {"0", "1", "0", "0"},
            {"1", "0", 
             RowBox[{
              RowBox[{"L1", " ", "c3"}], "+", 
              RowBox[{"L2", " ", "c34"}]}], 
             RowBox[{"L2", " ", "c34"}]},
            {"0", "1", 
             RowBox[{
              RowBox[{"L1", " ", "s3"}], "+", 
              RowBox[{"L2", " ", "s34"}]}], 
             RowBox[{"L2", " ", "s34"}]}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Jdot", " ", "=", " ", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", "0", "0", "0"},
           {"0", "0", "0", "0"},
           {"0", "0", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", "s3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "-", 
             RowBox[{"L2", " ", "s34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{
             RowBox[{"-", "L2"}], " ", "s34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]},
           {"0", "0", 
            RowBox[{
             RowBox[{"L1", " ", "c3", " ", 
              RowBox[{
              "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
             "+", 
             RowBox[{"L2", " ", "c34", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
                "+", 
                RowBox[{
                "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}],
                ")"}]}]}], 
            RowBox[{"L2", " ", "c34", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
              ")"}]}]}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"J", ",", " ", "Jdot"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dPcom", "[", 
     RowBox[{"mag_", ",", " ", "q_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m", ",", " ", "c3", ",", "s3", ",", " ", "c34", ",", " ", "s34"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dPcom", " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dq"}], " ", "Pcom"}]}], ",", " ", 
        RowBox[{
        "where", " ", "Pcom", " ", "is", " ", "the", " ", "center", " ", "of",
          " ", "mass", " ", "of", " ", "the", " ", 
         RowBox[{"robot", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"This", " ", "function", " ", "satisfies", " ", "vcom"}], 
         " ", "=", " ", 
         RowBox[{"dPcom", ".", 
          RowBox[{"qd", "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}]}]}], ",", " ", 
        
        RowBox[{"where", " ", "vcom", " ", "is", " ", "the"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "velocity", " ", "of", " ", "the", " ", "center", " ", "of", " ", 
        "mass", " ", "when", " ", "the", " ", "robot", " ", "has", " ", 
        "only", " ", "one", " ", "magnet"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"on", " ", "and", " ", "qd"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"d", "/", "dt"}], " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", " ", ",", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], "."}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", 
        RowBox[{"m1", " ", "+", " ", "m2"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"total", " ", "mass"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "m"}], ")"}], " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"m1", "+", "m2"}], "0", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"L1", " ", "m2"}], "+", 
                   RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "c3"}], "+", 
                RowBox[{"m2", " ", "r2", " ", "c34"}]}], 
               RowBox[{"m2", " ", "r2", " ", "c34"}]},
              {"0", 
               RowBox[{"m1", "+", "m2"}], 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"L1", " ", "m2"}], "+", 
                   RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
                RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
               RowBox[{"m2", " ", "r2", " ", "s34"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          TagBox[
           TagBox[
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "m2"}], "+", 
                    RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "c3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "c34"}]}], 
                RowBox[{"m2", " ", "r2", " ", "c34"}]},
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"L1", " ", "m2"}], "+", 
                    RowBox[{"m1", " ", "r1"}]}], ")"}], " ", "s3"}], "+", 
                 RowBox[{"m2", " ", "r2", " ", "s34"}]}], 
                RowBox[{"m2", " ", "r2", " ", "s34"}]}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.7]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", 
          TagBox[
           RowBox[{" ", 
            TagBox[
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "m1"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "r1"}], ")"}], " ", "c3"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}], " ", "c34"}]}], 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}]}], " ", "c34"}]},
                {
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "m1"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"L1", "-", "r1"}], ")"}], " ", "s3"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}], " ", "s34"}]}], 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"L2", " ", 
                    RowBox[{"(", 
                    RowBox[{"m1", "+", "m2"}], ")"}]}], "-", 
                    RowBox[{"m2", " ", "r2"}]}], ")"}]}], " ", "s34"}]}
               },
               
               GridBoxAlignment->{
                "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
               GridBoxSpacings->{"Columns" -> {
                   Offset[0.27999999999999997`], {
                    Offset[0.7]}, 
                   Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                 "Rows" -> {
                   Offset[0.2], {
                    Offset[0.4]}, 
                   Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
             Function[BoxForm`e$, 
              MatrixForm[BoxForm`e$]]]}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", "\[IndentingNewLine]", "True", ",",
           " ", 
          RowBox[{
          "Throw", "[", "\"\<Invalid magnet state for dPcom\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "position", " ", "of", " ", "center", " ", "of", " ", "masses", " ", "and",
     " ", "end", " ", "points", " ", "on", " ", "each", " ", "link"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P0", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{"q", "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P1", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P0", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"r1", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "]"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P3", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"r2", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "+", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], "]"}],
        ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P3", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"P0", "[", "q", "]"}], " ", "+", " ", 
    RowBox[{"L1", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "]"}], ",", " ", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"P4", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"P3", "[", "q", "]"}], " ", "+", " ", 
     RowBox[{"L2", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", " ", 
        RowBox[{"-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{
           "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
          "]"}]}]}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "energy", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KE", "[", "x_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], 
    RowBox[{
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ".", 
     RowBox[{"M", "[", "x", "]"}], ".", 
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PE", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{"g", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"m1", " ", 
        RowBox[{"P1", "[", "q", "]"}]}], "+", 
       RowBox[{"m2", " ", 
        RowBox[{"P2", "[", "q", "]"}]}]}], ")"}], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TE", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"KE", "[", "x", "]"}], " ", "+", " ", 
     RowBox[{"PE", "[", "x", "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DynamicQnts", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "qdd", ",", " ", "\[Lambda]", ",", " ", 
        "J", ",", " ", "Jd", ",", " ", "Minv", ",", " ", "\[CapitalLambda]"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J3", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for DynamicQnts\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "velocity", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"forces", " ", "on", " ", "magnets"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fext", "[", 
            RowBox[{"x", ",", " ", "u"}], "]"}], " ", "-", " ", 
           RowBox[{"c", "[", "x", "]"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", "acceleration", " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"J", ".", "Minv", ".", 
             RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"\[CapitalLambda]", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
               RowBox[{"J", ".", "qdd"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"qdd", " ", "=", " ", 
           RowBox[{"qdd", " ", "+", " ", 
            RowBox[{"Minv", ".", 
             RowBox[{"J", "\[Transpose]"}], ".", "\[Lambda]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
             RowBox[{"PadRight", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}], ",", " ", 
             RowBox[{"PadLeft", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qdd", ",", " ", "\[Lambda]"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ImpactQnts", "[", 
     RowBox[{"mag_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "J", ",", " ", "Minv", ",", " ", "v", 
        ",", " ", "\[Lambda]", ",", " ", "\[CapitalLambda]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J1", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J2", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"J3", "[", "x", "]"}]}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for DynamicQnts\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"pre", "-", 
         RowBox[{"impact", " ", "velocity"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Lambda]", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"impulsive", " ", "force", " ", "on", " ", "magnets"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"v", " ", "=", " ", "qd"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"post", "-", 
         RowBox[{"impact", " ", "velocity"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Inverse", "[", 
            RowBox[{"J", ".", "Minv", ".", 
             RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"\[CapitalLambda]", ".", "J", ".", "v"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{"v", " ", "+", " ", 
            RowBox[{"Minv", ".", 
             RowBox[{"J", "\[Transpose]"}], ".", "\[Lambda]"}]}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", " ", "=", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
             RowBox[{"PadRight", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}], ",", " ", 
             RowBox[{"PadLeft", "[", 
              RowBox[{"\[Lambda]", ",", " ", "4"}], "]"}]}], "]"}]}], ";"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"v", ",", " ", "\[Lambda]"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MotorInput", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", "b_", ",", " ", 
      RowBox[{"v_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qd", ",", " ", "J", ",", " ", "Jd", ",", " ", "Minv", 
        ",", " ", "zi", ",", " ", "zs", ",", " ", "\[CapitalLambda]"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "returns", " ", "input", " ", "torque", " ", "u", " ", "such", " ", 
          "that", " ", 
          RowBox[{"b", ".", "qdd"}]}], " ", "\[Equal]", " ", "du"}], ",", " ",
         "where"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"d", "^", "2"}], "/", 
          RowBox[{"dt", "^", "2"}]}], " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", " ", ",", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], ".", " ", "This"}], " ", "can", " ", "be", 
         " ", "used", " ", "to", " ", "apply", " ", "feedback"}]}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "linearization", " ", "when", " ", "using", " ", "the", " ", 
        "optional", " ", "parameter", " ", 
        RowBox[{"du", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
         RowBox[{"J", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "off"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"J3", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"both", " ", "magnets", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for MotorInput\>\"", "]"}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"qd", " ", "=", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ";", " ", 
       RowBox[{"(*", " ", "velocity", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"M", "[", "q", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"fext", "[", 
            RowBox[{"x", ",", " ", "0"}], "]"}], " ", "-", " ", 
           RowBox[{"c", "[", "x", "]"}]}], ")"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"input", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"Minv", ".", "T"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"state", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"J", " ", "\[NotEqual]", " ", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", "=", " ", 
            RowBox[{"Inverse", "[", 
             RowBox[{"J", ".", "Minv", ".", 
              RowBox[{"J", "\[Transpose]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zi", " ", "=", " ", 
            RowBox[{"zi", " ", "-", " ", 
             RowBox[{"Minv", ".", 
              RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
                RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"zs", " ", "=", " ", 
            RowBox[{"zs", " ", "-", " ", 
             RowBox[{"Minv", ".", 
              RowBox[{"J", "\[Transpose]"}], ".", "\[CapitalLambda]", ".", 
              "J", ".", "zs"}]}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"Minv", ".", 
            RowBox[{"J", "\[Transpose]"}], ".", 
            RowBox[{"Inverse", "[", 
             RowBox[{"J", ".", "Minv", ".", 
              RowBox[{"J", "\[Transpose]"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zi", " ", "=", " ", 
           RowBox[{"zi", " ", "-", " ", 
            RowBox[{"\[CapitalLambda]", ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Jd", ".", "qd"}], " ", "+", " ", 
               RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[CapitalLambda]", " ", "=", " ", 
           RowBox[{"\[CapitalLambda]", ".", "J"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"zs", " ", "=", " ", 
           RowBox[{"zs", " ", "-", " ", 
            RowBox[{"\[CapitalLambda]", ".", "zs"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "cancel", " ", "out", " ", "dynamics", " ", "and", " ", "add", " ", 
         "controller", " ", "v"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"b", ".", "zi"}]}], "/", 
         RowBox[{"b", ".", "zs"}]}], " ", "+", " ", 
        RowBox[{"v", "/", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatrixQ", "[", "b", "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"#", " ", "zs"}], "]"}], "&"}], "/@", " ", "b"}], ",", 
           " ", 
           RowBox[{"Norm", "[", 
            RowBox[{"b", " ", "zs"}], "]"}]}], "]"}]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FreeFlightVelocity", "[", 
     RowBox[{
     "mag_", ",", " ", "q_", ",", " ", "\[CapitalDelta]x_", ",", " ", 
      "\[CapitalDelta]y_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vcom", ",", " ", "\[Theta]d", ",", " ", "qd", ",", " ", "dP", ",", 
        " ", "dq", ",", " ", "c3", ",", " ", "s3", ",", " ", "c34", ",", " ", 
        "s34"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
         "solve", " ", "\[Theta]d", " ", "such", " ", "that", " ", "vcom"}], 
         " ", "=", " ", 
         RowBox[{"dP", ".", "\[Theta]d"}]}], ",", " ", 
        RowBox[{
         RowBox[{"where", " ", "\[Theta]d"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dt"}], 
          RowBox[{"{", 
           RowBox[{"\[Theta]1", ",", " ", "\[Theta]2"}], "}"}]}]}], ","}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"dP", " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dq"}], " ", "Pcom"}]}], ",", " ", 
        RowBox[{
        "where", " ", "Pcom", " ", "is", " ", "the", " ", "center", " ", "of",
          " ", "mass", " ", "of", " ", "the", " ", "robot"}], ","}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "and", " ", "vcom", " ", "is", " ", "the", " ", "velocity", " ", "of", 
        " ", "the", " ", "center", " ", "of", " ", 
        RowBox[{"mass", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "unique", " ", "solutions", " ", "do", " ", "not", " ", "exist", " ", 
         "whenever", " ", 
         RowBox[{
         "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], " ", 
        "\[Equal]", " ", 
        RowBox[{"0", " ", "mod", " ", "\[Pi]"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], " ", 
         "\[Equal]", " ", "0"}], ",", " ", 
        RowBox[{
         RowBox[{
         "then", " ", "a", " ", "line", " ", "of", " ", "slns", " ", "exist", 
          " ", "\[CapitalDelta]y"}], " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Tan", "[", 
            RowBox[{
            "q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "]"}], "/", "2"}], " ", 
          RowBox[{"\[CapitalDelta]x", "."}]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dP", " ", "=", " ", 
        RowBox[{"dPcom", "[", 
         RowBox[{"mag", ",", " ", "q"}], "]"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"vcom", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"g", " ", 
           RowBox[{"\[CapitalDelta]x", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"2", " ", "g", " ", "\[CapitalDelta]y"}], "]"}]}]}], ",",
           " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"2", " ", "g", " ", "\[CapitalDelta]y"}], "]"}]}], "}"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"dP", ",", " ", "vcom"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"return", " ", "qd"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"d", "/", "dt"}], " ", 
          RowBox[{"{", 
           RowBox[{
           "qx", ",", " ", "qy", ",", " ", "q\[Theta]1", ",", " ", 
            "q\[Theta]2"}], "}"}], " ", "subject", " ", "to", " ", "a", " ", 
          "magnet", " ", "being", " ", "on"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"c3", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s3", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c34", " ", "=", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"s34", " ", "=", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"q", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
           "+", 
          RowBox[{
          "q", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "dPcom", " ", "already", " ", "does", " ", "a", " ", "sanity", " ", 
         "check", " ", "on", " ", "magnet", " ", "values"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dq", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          TagBox[
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"0", "0"},
              {"0", "0"},
              {"1", "0"},
              {"0", "1"}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]], ",", " ", 
          TagBox[
           TagBox[
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "c3"}], "-", 
                 RowBox[{"L2", " ", "c34"}]}], 
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "c34"}]},
               {
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "L1"}], " ", "s3"}], "-", 
                 RowBox[{"L2", " ", "s34"}]}], 
                RowBox[{
                 RowBox[{"-", "L2"}], " ", "s34"}]},
               {"1", "0"},
               {"0", "1"}
              },
              
              GridBoxAlignment->{
               "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
                "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
              GridBoxSpacings->{"Columns" -> {
                  Offset[0.27999999999999997`], {
                   Offset[0.7]}, 
                  Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
                "Rows" -> {
                  Offset[0.2], {
                   Offset[0.4]}, 
                  Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
            Function[BoxForm`e$, 
             MatrixForm[BoxForm`e$]]],
           Function[BoxForm`e$, 
            MatrixForm[BoxForm`e$]]]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dq", ".", "\[Theta]d"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MinimizeFreeFlight", "[", 
     RowBox[{
     "mag_", ",", " ", "\[CapitalDelta]x_", ",", " ", "\[CapitalDelta]y_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", 
        "q\[Theta]2", ",", " ", "\[Theta]", ",", " ", "\[Theta]d"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"solve", " ", "\[Theta]", " ", "such", " ", "that", " ", 
         RowBox[{"1", "/", "2"}], " ", 
         RowBox[{"\[Theta]d", ".", "\[Theta]d"}], " ", "is", " ", 
         "minimized"}], ",", " ", 
        RowBox[{
        "where", " ", "\[Theta]d", " ", "is", " ", "the", " ", "initial"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "velocity", " ", "during", " ", "free", " ", "flight", " ", "required",
         " ", "to", " ", "travel", " ", "a", " ", "distance", " ", "of", " ", 
        "\[CapitalDelta]x", " ", "at"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"a", " ", "maximum", " ", "height", " ", "\[CapitalDelta]y"}],
         ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "\[Theta]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "for", 
          " ", "when", " ", "the", " ", "robot", " ", "has", " ", 
          "only"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"one", " ", "magnet", " ", "on", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", " ", "\"\<pinned\>\"", " ", "configuration"}], ")"}], 
         "."}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", 
              RowBox[{"Sin", "[", "q\[Theta]1", "]"}]}], "-", 
             RowBox[{"L2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"L1", " ", 
              RowBox[{"Cos", "[", "q\[Theta]1", "]"}]}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid magnet state for MinimizeFreeFlight\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
         "}"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeFlightVelocity", "[", 
           RowBox[{
           "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
            "\[CapitalDelta]y"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "=", " ", 
        RowBox[{"ArgMin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "2"}], 
           RowBox[{"\[Theta]d", ".", "\[Theta]d"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", " ", 
         RowBox[{"FreeFlightVelocity", "[", 
          RowBox[{
          "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
           "\[CapitalDelta]y"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MaximizeFreeFlight", "[", 
     RowBox[{
     "mag_", ",", " ", "\[CapitalDelta]x_", ",", " ", "\[CapitalDelta]y_", 
      ",", " ", 
      RowBox[{"\[Alpha]_:", "1"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", 
        "q\[Theta]2", ",", " ", "\[Theta]", ",", " ", "\[Theta]d"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"solve", " ", "\[Theta]", " ", "such", " ", "that", " ", 
          RowBox[{"1", "/", "2"}], " ", 
          RowBox[{"\[Theta]d", ".", "\[Theta]d"}], " ", "is", " ", 
          "maximized", " ", "subject", " ", "to", " ", 
          RowBox[{
          "\[Theta]d", "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}]}], " ", "=", " ", 
         RowBox[{"\[Alpha]", " ", 
          RowBox[{
          "\[Theta]d", "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}]}]}], ","}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "where", " ", "\[Theta]d", " ", "is", " ", "the", " ", "initial", " ", 
        "velocity", " ", "during", " ", "free", " ", "flight", " ", 
        "required", " ", "to", " ", "travel"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "a", " ", "distance", " ", "of", " ", "\[CapitalDelta]x", " ", "at", 
         " ", "a", " ", "maximum", " ", "height", " ", "\[CapitalDelta]y"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"and", " ", "\[Theta]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "for", 
          " ", "when", " ", "the"}]}]}], " ", "*)"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "robot", " ", "has", " ", "only", " ", "one", " ", "magnet", " ", "on",
         " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", " ", "\"\<pinned\>\"", " ", "configuration"}], ")"}], 
         "."}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"qx", ",", " ", "qy"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "L1"}], " ", 
              RowBox[{"Sin", "[", "q\[Theta]1", "]"}]}], "-", 
             RowBox[{"L2", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}], ",", " ", 
            RowBox[{
             RowBox[{"L1", " ", 
              RowBox[{"Cos", "[", "q\[Theta]1", "]"}]}], "+", 
             RowBox[{"L2", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"q\[Theta]1", "+", "q\[Theta]2"}], "]"}]}]}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid magnet state for MaximizeFreeFlight\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "qx", ",", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
         "}"}]}], ";", " ", 
       RowBox[{"(*", " ", "configuration", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]d", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"FreeFlightVelocity", "[", 
           RowBox[{
           "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
            "\[CapitalDelta]y"}], "]"}], "\[LeftDoubleBracket]", 
          RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "//", " ",
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}], " ", "=", " ", 
        RowBox[{"ArgMax", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", "2"}], 
             RowBox[{"\[Theta]d", ".", "\[Theta]d"}]}], ",", " ", 
            RowBox[{
             RowBox[{
             "\[Theta]d", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], " ", "\[Equal]", " ", 
             RowBox[{"\[Alpha]", " ", 
              RowBox[{
              "\[Theta]d", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", "q\[Theta]2"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"visualize", " ", "cost", " ", "function"}], ",", " ", 
         RowBox[{"useful", " ", "for", " ", "debugging"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{"\[Theta]d", ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]1", ",", " ", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"q\[Theta]2", ",", " ", 
            RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", " ", 
          RowBox[{"Epilog", "\[Rule]", " ", 
           RowBox[{"InfiniteLine", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"\[Alpha]", ",", "1"}], "}"}]}], "}"}], "]"}]}]}], 
         "]"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", " ", 
         RowBox[{"FreeFlightVelocity", "[", 
          RowBox[{
          "mag", ",", " ", "q", ",", " ", "\[CapitalDelta]x", ",", " ", 
           "\[CapitalDelta]y"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawGibbot", "[", 
     RowBox[{"mag_", ",", " ", "x_", ",", " ", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "Graphics", "]"}]}]}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "P", ",", " ", "psz", ",", " ", "ma", ",", " ", "com", ",", " ", "mo", 
        ",", " ", "li"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"psz", " ", "=", " ", 
        RowBox[{"0.01", " ", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"L1", ",", " ", "L2"}], "]"}], "/", "0.3"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"P1", "[", "x", "]"}], ",", " ", 
          RowBox[{"P2", "[", "x", "]"}], ",", " ", 
          RowBox[{"P3", "[", "x", "]"}], ",", " ", 
          RowBox[{"P4", "[", "x", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "motor", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"mo", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Red", ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], ",", 
            " ", 
            RowBox[{"2", "psz"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "center", " ", "of", " ", "mass", " ", "of", " ", "each", " ", 
         "link"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"com", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Gray", ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}], ",", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"magnets", ":", " ", "on"}], " ", "\[Rule]", " ", "dark"}], 
         ",", " ", 
         RowBox[{"off", " ", "\[Rule]", " ", "light"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ma", " ", "=", " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mag", " ", "\[Equal]", " ", "0"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"LightRed", ",", " ", "LightRed"}], "}"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", " ", "LightRed"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"LightRed", ",", " ", "Red"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"mag", " ", "\[Equal]", " ", "3"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"Red", ",", " ", "Red"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ma", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "ma", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}], ",", " ", 
          RowBox[{
          "ma", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
          " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{
            "P", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}], ",", 
            " ", "psz"}], "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "links", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"li", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"Thick", ",", " ", "Black", ",", " ", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"P", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"1", ",", "4", ",", "5"}], "}"}], 
             "\[RightDoubleBracket]"}], "}"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"li", ",", " ", "mo", ",", " ", "ma", ",", " ", "com"}], 
          "}"}], ",", " ", "opts"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"FixAngles", ",", " ", "Listable"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixAngles", "[", "q_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "x", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{" ", 
        RowBox[{
        "make", " ", "sure", " ", "angles", " ", "are", " ", "btw", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "pi"}], " ", "pi"}]}]}], "]"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", " ", "=", " ", 
        RowBox[{"Mod", "[", 
         RowBox[{"q", ",", " ", 
          RowBox[{"2", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"x", ">", "\[Pi]"}], ",", " ", 
         RowBox[{"x", " ", "-", " ", 
          RowBox[{"2", "\[Pi]"}]}], ",", " ", "x"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FixState", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", " ", "=", " ", "x"}], ",", " ", "n"}], "}"}], ",", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", "4"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"ListQ", "[", 
          RowBox[{"y", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", 
            RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}], " ", "=", 
          " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", " ", 
             RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
         ",", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"y", "\[LeftDoubleBracket]", 
           RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
          RowBox[{"FixAngles", "[", 
           RowBox[{"y", "\[LeftDoubleBracket]", 
            RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "y"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.5844197483839703`*^9, {3.5844250604318256`*^9, 3.5844250721475377`*^9}, {
   3.5844251233785*^9, 3.5844251234877005`*^9}, {3.5844253988774505`*^9, 
   3.5844254390946617`*^9}, {3.5844254919948354`*^9, 3.5844254990149255`*^9}, 
   3.584425543397398*^9, {3.584425574800518*^9, 3.584425581945394*^9}, {
   3.5844256737523947`*^9, 3.5844257230957055`*^9}, {3.5844279668250203`*^9, 
   3.5844279860756264`*^9}, {3.584428374816189*^9, 3.584428378919037*^9}, {
   3.5914865865694637`*^9, 3.591486626255737*^9}, {3.5914867823906765`*^9, 
   3.5914867827646985`*^9}, {3.591486817520689*^9, 3.5914868205858636`*^9}, {
   3.591486965884186*^9, 3.5914869664642324`*^9}, {3.5915022447717495`*^9, 
   3.5915022459698176`*^9}, {3.591542902441803*^9, 3.591542929051241*^9}, {
   3.59154329988008*^9, 3.591543327692632*^9}, 3.5915439898189273`*^9, {
   3.5915443331789765`*^9, 3.5915443348977413`*^9}, {3.591544409656703*^9, 
   3.591544412687962*^9}, {3.591721260928192*^9, 3.591721326772053*^9}, {
   3.5922422663532963`*^9, 3.592242267056429*^9}, {3.5922818277082567`*^9, 
   3.59228183637475*^9}, {3.593367653922082*^9, 3.5933676540470953`*^9}, {
   3.60224862205973*^9, 3.602248628162079*^9}, {3.618410239888734*^9, 
   3.618410243607942*^9}, {3.618411402838331*^9, 3.6184114053624744`*^9}, 
   3.618648264733282*^9, {3.618648379655821*^9, 3.6186484159840155`*^9}, {
   3.6186600689430113`*^9, 3.618660147690508*^9}, 3.61866274541527*^9, {
   3.6186633481607847`*^9, 3.6186633510349493`*^9}, 3.618663382293741*^9, {
   3.618664471157302*^9, 3.6186644734544353`*^9}, 3.618676224046091*^9, {
   3.6186981040546894`*^9, 3.6186981152563276`*^9}, {3.6196234592833757`*^9, 
   3.6196234777521663`*^9}, {3.619623515299116*^9, 3.6196235156741133`*^9}, 
   3.6196328601116304`*^9, 3.6196401674237742`*^9, {3.6196488597011433`*^9, 
   3.619648863131336*^9}, {3.6196492958539968`*^9, 3.6196493018480144`*^9}, {
   3.619650251272032*^9, 3.6196504742620487`*^9}, 3.619650665427994*^9, {
   3.6196507656223774`*^9, 3.619650833773438*^9}, {3.6196523917501316`*^9, 
   3.6196524111052427`*^9}, {3.6196528648799553`*^9, 3.619652901014676*^9}, {
   3.6196578897032647`*^9, 3.619657991034055*^9}, {3.619658030577319*^9, 
   3.6196580384157686`*^9}, {3.619658163576936*^9, 3.6196581661690845`*^9}, {
   3.619658254715153*^9, 3.619658255251199*^9}, {3.619658620842122*^9, 
   3.619658664420618*^9}, {3.6197419655520043`*^9, 3.6197419751613955`*^9}, {
   3.6197529087892003`*^9, 3.619752914554837*^9}, {3.6197529853674746`*^9, 
   3.6197531276802497`*^9}, {3.619831201246524*^9, 3.6198312626372876`*^9}, {
   3.6198321902485676`*^9, 3.6198322071392403`*^9}, {3.6198693533094535`*^9, 
   3.6198693660438504`*^9}, {3.6289931356527596`*^9, 
   3.6289931597278786`*^9}, {3.6289931990588293`*^9, 
   3.6289932002276473`*^9}, {3.6289935174160986`*^9, 
   3.6289935434786215`*^9}, {3.628999690999849*^9, 3.6289996940029626`*^9}, {
   3.6290874696346054`*^9, 3.629087496195485*^9}, {3.6290893794609632`*^9, 
   3.6290893878469396`*^9}, 3.6290896294286284`*^9, {3.6290896777369585`*^9, 
   3.629089856925326*^9}, {3.6290901996289024`*^9, 3.6290903470286636`*^9}, {
   3.6290903788752985`*^9, 3.6290904769489727`*^9}, {3.6290941716047225`*^9, 
   3.629094189846675*^9}, {3.629094236592229*^9, 3.629094250795303*^9}, {
   3.629094284635376*^9, 3.6290943321701436`*^9}, {3.6290950649229198`*^9, 
   3.6290950763900695`*^9}, {3.629096692277546*^9, 3.629096794749364*^9}, {
   3.6291371605944824`*^9, 3.6291371759584045`*^9}, {3.6293296264268723`*^9, 
   3.6293296570054536`*^9}, {3.629329828179557*^9, 3.629329851164239*^9}, {
   3.6293303783900037`*^9, 3.6293303895620413`*^9}, {3.6293316179533696`*^9, 
   3.6293317690178957`*^9}, {3.629333385556221*^9, 3.6293334228692465`*^9}, {
   3.6293335228862004`*^9, 3.6293335269956183`*^9}, {3.629333619715615*^9, 
   3.629333755795559*^9}, 3.629333835171608*^9, {3.6293341680041604`*^9, 
   3.629334181613716*^9}, {3.6293342520209026`*^9, 3.62933427814625*^9}, {
   3.6293343940540133`*^9, 3.6293343971009283`*^9}, {3.6293346816828413`*^9, 
   3.6293346820109997`*^9}, {3.6293354129957447`*^9, 3.629335442855516*^9}, {
   3.629335490621723*^9, 3.6293355244972005`*^9}, {3.629335585966768*^9, 
   3.62933559316999*^9}, {3.6293356337642803`*^9, 3.629335747609542*^9}, {
   3.6293357895944767`*^9, 3.6293358964771442`*^9}, {3.629336178762163*^9, 
   3.6293362466224403`*^9}, {3.629338835081946*^9, 3.629338837488228*^9}, {
   3.629469374846306*^9, 3.629469520599386*^9}, {3.6294696371502223`*^9, 
   3.6294696386572943`*^9}, {3.6294697994025893`*^9, 
   3.6294698796015825`*^9}, {3.6294699779865155`*^9, 
   3.6294699882988653`*^9}, {3.629470024010219*^9, 3.6294700654466753`*^9}, {
   3.629470145532591*^9, 3.629470233162876*^9}, {3.6294702664445305`*^9, 
   3.629470480376577*^9}, {3.6294705325987005`*^9, 3.6294705825211725`*^9}, {
   3.629470633836641*^9, 3.629470843753844*^9}, {3.6294709340320063`*^9, 
   3.6294710398922396`*^9}, {3.6294710849512625`*^9, 
   3.6294710858819284`*^9}, {3.629471160657074*^9, 3.6294711886569743`*^9}, {
   3.6294712261186223`*^9, 3.629471327358551*^9}, {3.6294789185643525`*^9, 
   3.629478968165583*^9}, {3.6294790760272665`*^9, 3.6294790858512487`*^9}, 
   3.6294792689984083`*^9, {3.629479348920209*^9, 3.62947936517177*^9}, {
   3.6294794720807533`*^9, 3.629479472167816*^9}, {3.6294802024698644`*^9, 
   3.6294803962515755`*^9}, {3.629480426413014*^9, 3.629480448688848*^9}, {
   3.6294805310213757`*^9, 3.629480531197501*^9}, {3.6294805806026073`*^9, 
   3.6294806036570005`*^9}, {3.6294806700131617`*^9, 
   3.6294806750417356`*^9}, {3.629480718810835*^9, 3.62948071937222*^9}, {
   3.6294807807848916`*^9, 3.62948079389318*^9}, {3.6294808463164663`*^9, 
   3.6294808465736485`*^9}, {3.629480880129498*^9, 3.6294808803366456`*^9}, {
   3.629481404771348*^9, 3.6294814952326717`*^9}, {3.629481650607094*^9, 
   3.629481655709719*^9}, {3.6294822726782255`*^9, 3.629482305426502*^9}, {
   3.6295020831260214`*^9, 3.629502115830265*^9}, 3.629502480571497*^9, 
   3.629502663221318*^9, {3.6296676436468954`*^9, 3.6296676716004066`*^9}, {
   3.629668043292823*^9, 3.629668133122157*^9}, {3.629668351468812*^9, 
   3.629668376797289*^9}, {3.6296684209228773`*^9, 3.62966848243932*^9}, {
   3.6296688800852356`*^9, 3.629669003055621*^9}, {3.6296690594782486`*^9, 
   3.629669206808332*^9}, 3.629669250605791*^9, {3.6296693133097496`*^9, 
   3.6296693164504166`*^9}, {3.6296700157409716`*^9, 
   3.6296700272723603`*^9}, {3.6296700730698586`*^9, 3.629670079960574*^9}, {
   3.629670529154052*^9, 3.6296705697795906`*^9}, {3.6296706037019176`*^9, 
   3.62967061459272*^9}, {3.6296706541244636`*^9, 3.6296706552807302`*^9}, {
   3.6296707370318174`*^9, 3.629670771235397*^9}, {3.629670859970951*^9, 
   3.629670861299096*^9}, 3.629670899908986*^9, 3.6296709316125326`*^9, {
   3.629672354975218*^9, 3.6296724440232563`*^9}, {3.6296726898103933`*^9, 
   3.6296727258577137`*^9}, {3.6296814222491016`*^9, 3.629681422717843*^9}, {
   3.62974088646299*^9, 3.6297408873692675`*^9}, {3.629740922416609*^9, 
   3.629740953213866*^9}, {3.629741219935405*^9, 3.6297412374356527`*^9}, {
   3.6297520612432384`*^9, 3.629752063446393*^9}, {3.629752346178745*^9, 
   3.6297523844605*^9}, {3.629752431929887*^9, 3.629752436523698*^9}, {
   3.6297525230248504`*^9, 3.629752575541169*^9}, {3.6297526214636602`*^9, 
   3.6297526266512284`*^9}, {3.6297529749199686`*^9, 
   3.6297529952014885`*^9}, {3.629753113437434*^9, 3.629753126906358*^9}, {
   3.6297534590623703`*^9, 3.6297534621717887`*^9}, {3.629753670221429*^9, 
   3.6297537353316727`*^9}, 3.629753835557296*^9, {3.6297545427237225`*^9, 
   3.6297546319124126`*^9}, {3.6297567457410374`*^9, 
   3.6297567463191805`*^9}, {3.6297575150921135`*^9, 
   3.6297575190764837`*^9}, {3.6297575693727417`*^9, 
   3.6297575869042463`*^9}, {3.6297576342017293`*^9, 3.629757634279849*^9}, {
   3.6298513958126945`*^9, 3.6298514023033075`*^9}, {3.6298529706009817`*^9, 
   3.6298529706664724`*^9}, {3.6298533121690636`*^9, 
   3.6298533182801228`*^9}, {3.630762287146578*^9, 3.6307623468585434`*^9}, {
   3.6307624095314655`*^9, 3.6307624761200447`*^9}, {3.6307644620563707`*^9, 
   3.63076446207938*^9}, {3.6312825570987663`*^9, 3.63128256013291*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"robot", " ", 
     RowBox[{"configuration", ":", " ", "q"}]}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "qx", ",", " ", "qy", ",", " ", "q\[Theta]1", ",", " ", "q\[Theta]2"}], 
     "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mag", " ", "=", " ", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"magnet", " ", 
      RowBox[{"state", ":", " ", "0"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"both", " ", "off"}], "..."}], "3"}], " ", "=", " ", 
      RowBox[{"both", " ", "on"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", " ", "8"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"robot", " ", 
     RowBox[{"state", ":", " ", 
      RowBox[{"{", 
       RowBox[{"q", ",", " ", 
        RowBox[{"dq", "/", "dt"}]}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"u", " ", "=", " ", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"motor", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dx", " ", "=", " ", 
     RowBox[{"2", "L1"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"free", " ", "flight", " ", 
     RowBox[{"distance", " ", "@", " ", "maximum"}], " ", "height"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "maximum", " ", "height", " ", "during", " ", "free", " ", "flight"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "errors", " ", "and", " ", "bizarre", " ", "answers", " ", "may", " ", 
     "result", " ", "if", " ", "constraint", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Jmag", "[", "q", "]"}], ".", "dq"}], "/", "dt"}], " ", 
     RowBox[{"isn", "'"}], "t", " ", "satisfied"}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"dynamics", " ", "and", " ", "impacts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicQnts", "[", 
    RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "accelerations", " ", "and", " ", "tangential", " ", 
     "loads", " ", "on", " ", "each", " ", "magnet"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ImpactQnts", "[", 
    RowBox[{"mag", ",", " ", "x"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"returns", " ", "post"}], "-", 
     RowBox[{
     "impact", " ", "state", " ", "and", " ", "impulse", " ", "felt", " ", 
      "by", " ", "each", " ", "magnet"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"input", " ", "torque", " ", "from", " ", "motor"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "vector", " ", "for", " ", "finding", " ", "a", " ", "u", " ", "such", 
      " ", "that", " ", 
      RowBox[{"b", ".", "qdd"}]}], " ", "=", " ", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"u", " ", "=", " ", 
    RowBox[{"MotorInput", "[", 
     RowBox[{"mag", ",", " ", "x", ",", " ", "b"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "input", " ", "torque", " ", "needed", " ", "to", " ", "make", " ", 
      RowBox[{
       RowBox[{"d", "^", "2"}], "/", 
       RowBox[{"dt", "^", "2"}]}], " ", "q\[Theta]2"}], " ", "=", " ", "0"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DynamicQnts", "[", 
      RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], " ", "//", " ", 
    "Chop"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "double", " ", "pendulum", " ", "to", " ", "free", " ", "flight"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"FreeFlightVelocity", "[", 
      RowBox[{"mag", ",", " ", "x", ",", " ", "dx", ",", " ", "dy"}], "]"}]}],
     " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "returns", " ", "velocity", " ", "required", " ", "to", " ", "travel", 
      " ", 
      RowBox[{"(", 
       RowBox[{"dx", ",", " ", "dy"}], ")"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"MinimizeFreeFlight", "[", 
      RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], "]"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "returns", " ", "state", " ", "that", " ", "minimizes", " ", "velocity", 
      " ", "required"}], " ", "*)"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"0", " ", "<", " ", "mag", " ", "<", " ", "3"}], ",", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"MaximizeFreeFlight", "[", 
      RowBox[{"mag", ",", " ", "dx", ",", " ", "dy", ",", " ", 
       RowBox[{"1", "/", "2"}]}], "]"}]}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "returns", " ", "state", " ", "that", " ", "maximizes", " ", "velocity",
        " ", "subject", " ", "to", " ", 
       RowBox[{"d", "/", "dt"}], " ", "q3"}], " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"d", "/", "dt"}], " ", "q4"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", "]"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"DrawGibbot", "[", 
    RowBox[{"mag", ",", " ", "x"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "a", " ", "graphic", " ", "of", " ", "the", " ", 
     "gibbot"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQHbt7dtVBzteOUe/ugOkTVVJrjwBpjQVMm0F0kVb8
LhC9yY5xL4jm87vr9wFI7zFgDgLRRxb4hYFopfQpySD6Vepx9o9AOujyBD4Q
fWmnzNxPQHofA8MCEL1ZstnmC5AWMrzmAKLZPCUngGif/jWTQfS3DReNObhe
O34qMTYB0dKFLXczgPSS2RP4MoH0EYVYERDdpPpQEkR3aSbLgWiDnYUGIPrY
nhITEC10YJYFiNb4IhoGoh+WvAXTerX8q1YB6SKVFWCa4az8eRAtLfIcTBvp
v47i4X7t+Gbj+VgQfWcXawaIfrKLG0zv+7Z6DYj+U71jE4iOmVj9ywRIawh2
gekv0mrspkA6TTGSF0QDAPjEn9g=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Specs", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}, {3.629138508061183*^9, 
  3.629138516540187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"s_", "?", "NumericQ"}], ",", " ", "q_", ",", " ", "qd_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", "qd"}], "]"}]}], ";", " ", 
      RowBox[{"First", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"mag", ",", " ", "x", ",", " ", 
         RowBox[{"u", "[", 
          RowBox[{"s", ",", " ", "x"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.6297582460562477`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"E", ",", " ", "Emax"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Emax", " ", "=", " ", 
        RowBox[{"TE", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E", " ", "=", " ", 
        RowBox[{
         RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", "/", "2"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ke", " ", 
           RowBox[{"E", "^", "2"}]}], " ", "+", " ", 
          RowBox[{"kp", " ", 
           RowBox[{
            RowBox[{
            "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "^", 
            "2"}]}], " ", "+", " ", 
          RowBox[{"kd", " ", 
           RowBox[{
            RowBox[{
            "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], "^", 
            "2"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Vdot", "[", 
     RowBox[{"x_", ",", " ", "u_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"E", ",", " ", "Emax", ",", " ", "qdd"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"qdd", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"DynamicQnts", "[", 
          RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Emax", " ", "=", " ", 
        RowBox[{"TE", "[", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E", " ", "=", " ", 
        RowBox[{
         RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ke", " ", "E", " ", "u"}], " ", "+", " ", 
          RowBox[{"kd", " ", 
           RowBox[{
           "qdd", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
          " ", "+", " ", 
          RowBox[{"kp", " ", 
           RowBox[{
           "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
         ")"}], 
        RowBox[{
        "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zizs", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "f", ",", " ", "J", ",", " ", "Jd", ",", " ", "Minv", ",", " ", "zi", 
        ",", " ", "zs", ",", " ", "\[CapitalLambda]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mag", " ", "\[Equal]", " ", "1"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "1", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mag", " ", "\[Equal]", " ", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"J", ",", " ", "Jd"}], "}"}], " ", "=", " ", 
          RowBox[{"GibbotQnts`Private`J2", "[", "x", "]"}]}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"magnet", " ", "on", " ", "link", " ", "2", " ", "on"}], 
          " ", "*)"}], "\[IndentingNewLine]", "True", ",", " ", 
         RowBox[{
         "Throw", "[", "\"\<Invalid Magnet State for zizs\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Minv", " ", "=", " ", 
        RowBox[{"Inverse", "[", 
         RowBox[{"GibbotQnts`Private`M", "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"f", " ", "=", " ", 
        RowBox[{
         RowBox[{"GibbotQnts`Private`fext", "[", 
          RowBox[{"x", ",", " ", "0"}], "]"}], " ", "-", " ", 
         RowBox[{"GibbotQnts`Private`c", "[", "x", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"Minv", ".", "f"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"input", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"Minv", ".", "T"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"zero", "-", 
         RowBox[{"state", " ", "acceleration"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", " ", 
        RowBox[{"Minv", ".", 
         RowBox[{"J", "\[Transpose]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"J", ".", "Minv", ".", 
           RowBox[{"J", "\[Transpose]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zi", " ", "=", " ", 
        RowBox[{"zi", " ", "-", " ", 
         RowBox[{"\[CapitalLambda]", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Jd", ".", 
             RowBox[{"x", "\[LeftDoubleBracket]", 
              RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], " ", "+",
             " ", 
            RowBox[{"J", ".", "zi"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalLambda]", " ", "=", " ", 
        RowBox[{"\[CapitalLambda]", ".", "J"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"zs", " ", "=", " ", 
        RowBox[{"zs", " ", "-", " ", 
         RowBox[{"\[CapitalLambda]", ".", "zs"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"zi", ",", " ", "zs"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gains", "[", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "zsmin", ",", " ", "x3", ",", " ", "x4", ",", " ", "c4", ",", " ", 
        "c5"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{
         RowBox[{"zizs", "[", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "0", 
            ",", "0"}], "}"}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", " ", "4"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c5", " ", "=", " ", 
        RowBox[{"RegionProduct", "[", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", "\[Pi]"}], "}"}]}], "}"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zsmin", " ", "=", " ", 
        RowBox[{"NMinValue", "[", 
         RowBox[{"c4", ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x3", ",", "x4"}], "}"}], " ", "\[Element]", " ", 
           "c5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"c4", " ", "=", " ", 
        RowBox[{
         RowBox[{"m1", " ", "r1"}], " ", "+", " ", 
         RowBox[{"m2", " ", "L1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c5", " ", "=", " ", 
        RowBox[{"m2", " ", "r2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"kd", "/", "ke"}], ",", " ", 
           RowBox[{"kp", "/", "ke"}]}], "}"}], " ", "\[GreaterEqual]"}], "  ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{"c4", "+", "c5"}], ")"}], 
          RowBox[{"g", "/", "zsmin"}]}], ",", " ", 
         RowBox[{"2", " ", "c4", " ", "c5", " ", 
          RowBox[{"g", "^", "2"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"t_", ",", " ", "x_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"E", ",", " ", "Emax", ",", " ", "zi", ",", " ", "zs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zi", ",", " ", "zs"}], "}"}], " ", "=", " ", 
       RowBox[{"zizs", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Emax", " ", "=", " ", 
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E", " ", "=", " ", 
       RowBox[{
        RowBox[{"TE", "[", "x", "]"}], " ", "-", " ", "Emax"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"t", " ", "<", " ", "tsw"}], ",", " ", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "kv"}], " ", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}], 
           " ", "-", " ", 
           RowBox[{"kp", " ", 
            RowBox[{
            "x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
           " ", "-", " ", 
           RowBox[{"kd", " ", 
            RowBox[{
            "zi", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
          ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ke", " ", "E"}], " ", "+", " ", 
           RowBox[{"kd", " ", 
            RowBox[{
            "zs", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", "0"}], 
       RowBox[{"(*", 
        RowBox[{"-", 
         RowBox[{"K", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], " ", "-", " ", 
            RowBox[{"{", 
             RowBox[{"\[Pi]", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
           ")"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.6296827077974305`*^9}, {
   3.629682747532361*^9, 3.629682777688982*^9}, {3.629682839908622*^9, 
   3.629682840471125*^9}, {3.629682910753313*^9, 3.6296830403487854`*^9}, {
   3.6296831144591465`*^9, 3.6296831716161275`*^9}, {3.629683252648484*^9, 
   3.6296832918364763`*^9}, {3.62968334083713*^9, 3.629683367446892*^9}, {
   3.629683429838312*^9, 3.6296834435729065`*^9}, {3.6296835105581694`*^9, 
   3.6296836574976234`*^9}, {3.62968375140512*^9, 3.6296837585770617`*^9}, {
   3.6296838301092625`*^9, 3.629683833906189*^9}, {3.629683949220255*^9, 
   3.629683970861135*^9}, {3.629684018893024*^9, 3.6296840190961533`*^9}, {
   3.629684460648903*^9, 3.629684465523967*^9}, 3.629684572087885*^9, {
   3.6296847025583706`*^9, 3.6296847158398275`*^9}, {3.6296847577935104`*^9, 
   3.6296848367633114`*^9}, {3.6296849951403885`*^9, 3.629685007984294*^9}, 
   3.629685109079439*^9, {3.62968542658366*^9, 3.6296856339301386`*^9}, {
   3.629685781322723*^9, 3.6296858570581055`*^9}, {3.6296858926835804`*^9, 
   3.629685927605919*^9}, {3.6296859627939157`*^9, 3.629686011544536*^9}, {
   3.6296860424356003`*^9, 3.629686093873789*^9}, {3.6296863984871564`*^9, 
   3.6296864446753297`*^9}, 3.6296864886133833`*^9, {3.6296865493329735`*^9, 
   3.629686551145496*^9}, {3.6296868389461985`*^9, 3.629686861665209*^9}, {
   3.6296869100252705`*^9, 3.629686910697156*^9}, {3.6296869727448573`*^9, 
   3.6296870568084135`*^9}, {3.6296870994652634`*^9, 3.629687358890588*^9}, {
   3.6296874521262035`*^9, 3.6296875187989655`*^9}, {3.6296875792528954`*^9, 
   3.629687633191144*^9}, {3.6296876641602736`*^9, 3.6296877958182755`*^9}, {
   3.629688020774394*^9, 3.6296881156819057`*^9}, {3.629688206511241*^9, 
   3.629688248808704*^9}, {3.6296883603882875`*^9, 3.629688405701391*^9}, {
   3.629689587447905*^9, 3.6296895876666117`*^9}, {3.6296916456627555`*^9, 
   3.629691699397847*^9}, {3.6296917673362837`*^9, 3.629691769930024*^9}, {
   3.6296918147118535`*^9, 3.6296918628375216`*^9}, {3.629691991323637*^9, 
   3.629692023620911*^9}, {3.6296920674027767`*^9, 3.6296920746528735`*^9}, 
   3.6296925878315425`*^9, {3.6296926341446595`*^9, 3.629692648207346*^9}, {
   3.6296926804421816`*^9, 3.6296927137863436`*^9}, {3.6296928114751434`*^9, 
   3.629692811537635*^9}, {3.629693017821638*^9, 3.629693063822282*^9}, {
   3.629693109791645*^9, 3.629693181511346*^9}, {3.6296932120898757`*^9, 
   3.629693329638316*^9}, {3.629693371013838*^9, 3.6296933743107567`*^9}, {
   3.629693420014526*^9, 3.6296934819059663`*^9}, {3.6296935131095095`*^9, 
   3.6296935405942183`*^9}, {3.629693578391631*^9, 3.6296936255953817`*^9}, {
   3.6296938633329177`*^9, 3.6296938872550807`*^9}, {3.6296939616623206`*^9, 
   3.6296939904439535`*^9}, {3.6296942176060266`*^9, 3.62969426363789*^9}, {
   3.6296943772019005`*^9, 3.6296943809207*^9}, {3.6296944378433323`*^9, 
   3.6296944386402173`*^9}, {3.6296957775174055`*^9, 
   3.6296958032365294`*^9}, {3.6296959760357018`*^9, 
   3.6296960153018193`*^9}, {3.629756736975297*^9, 3.6297567380065594`*^9}, {
   3.6300124119611435`*^9, 3.630012412679869*^9}, {3.6300124863836937`*^9, 
   3.6300125117121077`*^9}, {3.63001262861942*^9, 3.6300126314319487`*^9}, {
   3.630012763745719*^9, 3.63001279368349*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kv", " ", "=", " ", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ke", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"kd", ",", " ", "kp"}], "}"}], " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", " ", "1"}], "}"}], " ", 
   RowBox[{"gains", "[", "]"}], " ", "ke"}]}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.6296827077974305`*^9}, {
   3.629682747532361*^9, 3.629682777688982*^9}, {3.629682839908622*^9, 
   3.629682840471125*^9}, {3.629682910753313*^9, 3.6296830403487854`*^9}, {
   3.6296831144591465`*^9, 3.6296831716161275`*^9}, {3.629683252648484*^9, 
   3.6296832918364763`*^9}, {3.62968334083713*^9, 3.629683367446892*^9}, {
   3.629683429838312*^9, 3.6296834435729065`*^9}, {3.6296835105581694`*^9, 
   3.6296836574976234`*^9}, {3.62968375140512*^9, 3.6296837585770617`*^9}, {
   3.6296838301092625`*^9, 3.629683833906189*^9}, {3.629683949220255*^9, 
   3.629683970861135*^9}, {3.629684018893024*^9, 3.6296840190961533`*^9}, {
   3.629684460648903*^9, 3.629684465523967*^9}, 3.629684572087885*^9, {
   3.6296847025583706`*^9, 3.6296847158398275`*^9}, {3.6296847577935104`*^9, 
   3.6296848367633114`*^9}, {3.6296849951403885`*^9, 3.629685007984294*^9}, 
   3.629685109079439*^9, {3.62968542658366*^9, 3.6296856339301386`*^9}, {
   3.629685781322723*^9, 3.6296858570581055`*^9}, {3.6296858926835804`*^9, 
   3.629685927605919*^9}, {3.6296859627939157`*^9, 3.629686011544536*^9}, {
   3.6296860424356003`*^9, 3.629686093873789*^9}, {3.6296863984871564`*^9, 
   3.6296864446753297`*^9}, 3.6296864886133833`*^9, {3.6296865493329735`*^9, 
   3.629686551145496*^9}, {3.6296868389461985`*^9, 3.629686861665209*^9}, {
   3.6296869100252705`*^9, 3.629686910697156*^9}, {3.6296869727448573`*^9, 
   3.6296870568084135`*^9}, {3.6296870994652634`*^9, 3.629687358890588*^9}, {
   3.6296874521262035`*^9, 3.6296875187989655`*^9}, {3.6296875792528954`*^9, 
   3.629687633191144*^9}, {3.6296876641602736`*^9, 3.6296877958182755`*^9}, {
   3.629688020774394*^9, 3.6296881156819057`*^9}, {3.629688206511241*^9, 
   3.629688248808704*^9}, {3.6296883603882875`*^9, 3.629688405701391*^9}, {
   3.629689587447905*^9, 3.6296895876666117`*^9}, {3.6296916456627555`*^9, 
   3.629691699397847*^9}, {3.6296917673362837`*^9, 3.629691769930024*^9}, {
   3.6296918147118535`*^9, 3.6296918628375216`*^9}, {3.629691991323637*^9, 
   3.629692023620911*^9}, {3.6296920674027767`*^9, 3.6296920746528735`*^9}, 
   3.6296925878315425`*^9, {3.6296926341446595`*^9, 3.629692648207346*^9}, {
   3.6296926804421816`*^9, 3.6296927137863436`*^9}, {3.6296928114751434`*^9, 
   3.629692811537635*^9}, {3.629693017821638*^9, 3.629693063822282*^9}, {
   3.629693109791645*^9, 3.629693181511346*^9}, {3.6296932120898757`*^9, 
   3.629693329638316*^9}, {3.629693371013838*^9, 3.6296933743107567`*^9}, {
   3.629693420014526*^9, 3.6296934819059663`*^9}, {3.6296935131095095`*^9, 
   3.6296935405942183`*^9}, {3.629693578391631*^9, 3.629693717955987*^9}, {
   3.6296940394290104`*^9, 3.629694090679696*^9}, {3.629694462484317*^9, 
   3.6296944892659216`*^9}, {3.629695185978286*^9, 3.629695196540958*^9}, {
   3.6296953037298813`*^9, 3.629695303792379*^9}, {3.6296957982833385`*^9, 
   3.6296958000489855`*^9}, {3.6296999023836794`*^9, 3.62969991009516*^9}, 
   3.6297015785988555`*^9, {3.62970164258405*^9, 3.6297016441778517`*^9}, {
   3.6297017048505373`*^9, 3.629701724522669*^9}, {3.6297018934155436`*^9, 
   3.62970189499369*^9}, 3.629701956916388*^9, {3.629702088855646*^9, 
   3.629702103746436*^9}, {3.629702137731263*^9, 3.629702137809419*^9}, {
   3.629702430047685*^9, 3.6297024768607764`*^9}, {3.629702521548902*^9, 
   3.629702590040435*^9}, 3.629702627540934*^9, {3.62970283112177*^9, 
   3.6297028959350996`*^9}, 3.6297029710455055`*^9, {3.6297030308275485`*^9, 
   3.6297030938908873`*^9}, {3.6297031311257596`*^9, 3.629703175485727*^9}, {
   3.6297032083299165`*^9, 3.6297033228626823`*^9}, {3.6297034277390814`*^9, 
   3.6297034673333273`*^9}, {3.629703936870854*^9, 3.6297040060905247`*^9}, {
   3.629704047106666*^9, 3.6297041387953854`*^9}, {3.6297041857647324`*^9, 
   3.6297043448762817`*^9}, 3.6297043936269298`*^9, {3.629704944899835*^9, 
   3.6297049673689394`*^9}, {3.629853408236723*^9, 3.629853426309946*^9}, {
   3.6298534761049137`*^9, 3.629853510341093*^9}, {3.6298535422848177`*^9, 
   3.6298536203752007`*^9}, {3.629853658527918*^9, 3.629853687221178*^9}, 
   3.6298556756336613`*^9, 3.6298557154130397`*^9, {3.6298558442583604`*^9, 
   3.6298558458411236`*^9}, {3.629856333561937*^9, 3.629856352888467*^9}, {
   3.629856814364602*^9, 3.6298568444996743`*^9}, {3.6300127000264015`*^9, 
   3.630012746979952*^9}, {3.6307625489181967`*^9, 3.630762613294297*^9}, {
   3.630762648654248*^9, 3.6307626649514008`*^9}, {3.630762723858659*^9, 
   3.63076274429648*^9}, {3.6307627877503767`*^9, 3.6307628309230223`*^9}, {
   3.6307628764706736`*^9, 3.630762914111884*^9}, {3.6307629500813084`*^9, 
   3.6307630041916103`*^9}, {3.630763041817234*^9, 3.6307630696146064`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"21.864536366085616`", ",", "450.1040923470607`"}], "}"}]], "Output",\

 CellChangeTimes->{3.6314470843094277`*^9, 3.632571613532398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"30", " ", "Degree"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
    "=", " ", 
    RowBox[{"0", " ", "Degree"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsw", " ", "=", " ", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], ",", " ", 
            "\"\<StopIntegration\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
              RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             "\"\<StopIntegration\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             "\"\<StopIntegration\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ".", 
             RowBox[{"GibbotQnts`Private`P4", "[", 
              RowBox[{"q", "[", "s", "]"}], "]"}]}], ",", " ", 
            RowBox[{
             RowBox[{"ty", " ", "=", " ", "s"}], ";"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", "q", 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MaxStepSize", "\[Rule]", "0.01"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "tsw", \
"\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "'"}], "[", "t", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"DrawGibbot", "[", 
     RowBox[{"mag", ",", " ", 
      RowBox[{"q", "[", "s", "]"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", " ", 
       RowBox[{"1.5", 
        RowBox[{"(", 
         RowBox[{"L1", "+", "L2"}], ")"}]}]}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
    RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}, {3.629672241692461*^9, 3.6296722792867427`*^9}, {
   3.629672651622384*^9, 3.6296726735445476`*^9}, {3.6296727594519424`*^9, 
   3.629673070471675*^9}, {3.629673129800623*^9, 3.6296731544102707`*^9}, {
   3.6296732120829215`*^9, 3.629673267458641*^9}, {3.6296733218031445`*^9, 
   3.629673476945864*^9}, {3.629673509508767*^9, 3.6296735172120256`*^9}, {
   3.629673562025119*^9, 3.629673582415995*^9}, {3.6296744407086887`*^9, 
   3.629674442505555*^9}, 3.6296745310379825`*^9, {3.629674604663962*^9, 
   3.629674604913965*^9}, {3.629675481706911*^9, 3.629675482519391*^9}, {
   3.6296755512859654`*^9, 3.6296757340539885`*^9}, {3.629675791804788*^9, 
   3.6296758172113447`*^9}, {3.629677221019473*^9, 3.6296772320196486`*^9}, {
   3.6296818215356655`*^9, 3.6296818437234945`*^9}, {3.6296819356934633`*^9, 
   3.629681951928025*^9}, 3.629682031429082*^9, {3.629682110008253*^9, 
   3.6296821391023903`*^9}, {3.6296821980250816`*^9, 3.629682240478725*^9}, {
   3.6296822842136955`*^9, 3.629682313526616*^9}, {3.6296823630584955`*^9, 
   3.629682365699145*^9}, {3.629682593639717*^9, 3.629682700031763*^9}, {
   3.6296918820096855`*^9, 3.629691882306531*^9}, {3.62969196333889*^9, 
   3.6296919878235855`*^9}, {3.6296931933708487`*^9, 
   3.6296931939646363`*^9}, {3.629693399842346*^9, 3.6296934001704764`*^9}, {
   3.6296945694388647`*^9, 3.6296946616119633`*^9}, {3.629694870395962*^9, 
   3.6296948743647966`*^9}, 3.629695004085241*^9, {3.6296950726330566`*^9, 
   3.6296950889769955`*^9}, {3.62969516072795*^9, 3.629695160806061*^9}, {
   3.629695222150642*^9, 3.62969522219751*^9}, {3.6296953833090353`*^9, 
   3.6296954815290947`*^9}, 3.629695568577096*^9, {3.629695784251849*^9, 
   3.6296957861581454`*^9}, {3.62969602856765*^9, 3.62969604677102*^9}, {
   3.6296961218813615`*^9, 3.629696122756374*^9}, {3.6296965261523952`*^9, 
   3.6296965267461557`*^9}, {3.6296966300756226`*^9, 3.629696637638254*^9}, {
   3.629696673013726*^9, 3.6296967354520254`*^9}, {3.6296974850089045`*^9, 
   3.6296975422752604`*^9}, {3.6296975874008613`*^9, 3.629697732199662*^9}, {
   3.629697896811227*^9, 3.6296980364381175`*^9}, {3.6296981628928633`*^9, 
   3.6296982006121445`*^9}, {3.6296983156605496`*^9, 
   3.6296984317402444`*^9}, {3.6296984687407417`*^9, 3.629698477600232*^9}, {
   3.629698535866605*^9, 3.6296985359916058`*^9}, {3.6297002303152475`*^9, 
   3.6297002533312244`*^9}, {3.6297002848941116`*^9, 
   3.6297003005661964`*^9}, {3.6297004778810854`*^9, 3.629700541381899*^9}, {
   3.62970067960252*^9, 3.629700709696638*^9}, {3.62970086124553*^9, 
   3.6297009227775984`*^9}, {3.6297009722001643`*^9, 3.629701030310279*^9}, {
   3.6297010654670005`*^9, 3.6297012372505646`*^9}, {3.6297012830480165`*^9, 
   3.6297012845480375`*^9}, {3.629701397955795*^9, 3.6297014065340147`*^9}, {
   3.6297014753162003`*^9, 3.6297014932070923`*^9}, 3.6297016838346*^9, {
   3.6297019870886335`*^9, 3.6297020314642253`*^9}, {3.629702082261775*^9, 
   3.6297020823242593`*^9}, {3.6297021677941923`*^9, 
   3.6297021817475023`*^9}, {3.6297023925159025`*^9, 3.629702423688178*^9}, {
   3.6297026923073645`*^9, 3.629702735589245*^9}, {3.629702779371049*^9, 
   3.629702807199544*^9}, {3.62970293701377*^9, 3.6297029537483687`*^9}, {
   3.6297030072178297`*^9, 3.629703008733508*^9}, {3.6297033400503836`*^9, 
   3.6297034170201573`*^9}, {3.6297034795834894`*^9, 3.629703546943737*^9}, {
   3.6297035985381975`*^9, 3.629703655226452*^9}, {3.6297037071021423`*^9, 
   3.6297037210085773`*^9}, {3.6297037554309397`*^9, 
   3.6297038721512427`*^9}, {3.629703902307864*^9, 3.629703924651911*^9}, {
   3.6297043585326843`*^9, 3.629704358704561*^9}, {3.629704464518469*^9, 
   3.629704550582114*^9}, {3.6297550782067432`*^9, 3.629755082306635*^9}, {
   3.6297582385405226`*^9, 3.629758239509254*^9}, 3.6298533631088195`*^9, {
   3.629853397495614*^9, 3.6298533977263546`*^9}, {3.629853439787386*^9, 
   3.6298534403465834`*^9}, {3.6298535981088753`*^9, 3.629853598176324*^9}, {
   3.6298549776992793`*^9, 3.6298550656830587`*^9}, 3.6298551255788975`*^9, 
   3.629855388416956*^9, {3.629855720237568*^9, 3.629855742005224*^9}, {
   3.629855821997023*^9, 3.629855822325505*^9}, 3.630012682807435*^9, 
   3.6300127684957995`*^9, 3.630762762328099*^9, 3.6314470969654565`*^9}],

Cell[BoxData["1.5362383997744917`"], "Output",
 CellChangeTimes->{{3.631447085790485*^9, 3.6314470978070416`*^9}, 
   3.632571614418044*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6.261311053059352`*^-16"}], ",", "5.264949550387539`*^-16", 
   ",", "5.5296579201268425`", ",", 
   RowBox[{"-", "7.528469139625237`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.631447085790485*^9, 3.6314470978070416`*^9}, 
   3.6325716144190407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "s", "]"}], "\[LeftDoubleBracket]", "3", 
       "\[RightDoubleBracket]"}], "-", "\[Pi]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "'"}], "[", "s", "]"}], "\[LeftDoubleBracket]", "3", 
      "\[RightDoubleBracket]"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "\[Pi]"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", "\[Pi]"}], "}"}]}], "}"}], "]"}], ",", " ", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"-", "\[Pi]"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"t", ",", " ", 
           RowBox[{"-", "\[Pi]"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"q", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}], "]"}], "-", 
       RowBox[{"TE", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ")"}], "/", 
     
     RowBox[{"TE", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"\[Pi]", ",", " ", "0"}], "}"}], ",", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", " ", "4"}], "]"}]}], "]"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
       RowBox[{"q", "[", "s", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"u", "[", 
    RowBox[{"s", ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"q", "[", "s", "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{
       RowBox[{"60", "/", "2"}], "/", "\[Pi]"}]}], "}"}], ".", 
    RowBox[{
     RowBox[{"q", "'"}], "[", "s", "]"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RootMeanSquare", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"s", ",", " ", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"q", "[", "s", "]"}], ",", " ", 
        RowBox[{
         RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "t", ",", " ", 
      RowBox[{"t", "/", "200"}]}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"RootMeanSquare", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"60", "/", "2"}], "/", "\[Pi]"}]}], "}"}], ".", 
     RowBox[{
      RowBox[{"q", "'"}], "[", "s", "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "t", ",", " ", 
      RowBox[{"t", "/", "200"}]}], "}"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6296946717370386`*^9, 3.629694826723506*^9}, 
   3.629694987850649*^9, {3.6296951276181345`*^9, 3.629695136149528*^9}, {
   3.6296952460103655`*^9, 3.6296952805420732`*^9}, {3.629695892393964*^9, 
   3.6296959347226505`*^9}, {3.629696158225628*^9, 3.629696192929185*^9}, {
   3.629696229257819*^9, 3.62969623219536*^9}, {3.6296962635394974`*^9, 
   3.6296962906805143`*^9}, {3.6296963253215694`*^9, 
   3.6296963553219495`*^9}, {3.6296963904161844`*^9, 
   3.6296964358855705`*^9}, {3.6296985122413225`*^9, 3.629698514022593*^9}, {
   3.6296985695858335`*^9, 3.629698611570766*^9}, {3.6296999590460553`*^9, 
   3.62970002607817*^9}, {3.6297001004072824`*^9, 3.629700101813551*^9}, 
   3.629700138814073*^9, {3.6297003987706585`*^9, 3.629700400458181*^9}, {
   3.6297005897888255`*^9, 3.62970059211698*^9}, 3.629701664881222*^9, {
   3.629701814820717*^9, 3.6297018204614167`*^9}, {3.629702219513629*^9, 
   3.6297022242949452`*^9}, 3.6297023294213123`*^9, {3.6297027636833706`*^9, 
   3.629702773855381*^9}, {3.6307631355531845`*^9, 3.630763164413101*^9}, {
   3.6307631982105536`*^9, 3.630763210945116*^9}, {3.6312826504931297`*^9, 
   3.63128265336817*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
l/qkY3NwvHhlGtfwfzSKD8A=
     "]]}, 
   {RGBColor[0.880722, 0.611041, 0.142051], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
JAMyQxS9KLv4UMKft8+iZBkgcs30zNntfEhj8vgIrsIAVb7fqTUUPhTU8NnX
xJgB4eNtr8X6eREzzc9Pz5kBFUEYPnOCF5Xwo9v27gzQW1FIu3KUFyXHkHPP
eTPA4z8XG/o+XrQ97Bf9w2kGpH97lempzIvOu2w9rXGFAdGtHGGVNB60KNd4
Zls2Axr+fK3d7cGDyjK3JVo8YYB1vbZFwQEelCYS8c7nBQPepln5cZryIH1O
1ZmnbxnwxmJ3g4kYDwql3zgrjTPgxZaYiYUGbrT63uD8lgEGfH543i9Anxv9
2/noErfsJFxfoqh+GN2MOtchi6owCXl2o6xljZvRp5/9qFh5EuLC47k/f9uM
/PdIbTqtPQmJ2r1fpZM3o3ab7LQabBIUtvF+32a8Gb0/nvkx3m0S1q39s77d
3IS8LqVP8mdNwmXx6g+qfziQqbEBifZoEraLr0dyDnIgsb/tuujZJJi48K5/
KuNADZGU8KC8SdD+erzn+n8cyCQmjauxeBLou/TbaPIciHzv7rbkrkmw/Dn6
MdZsI6r4lOQhLDoFJ45c+0X8EqCdh9WegMQUsFxaHS/azobyZ8uH/KWnwPsy
3xdNATaUqbHu9VNpCuZ4pWLtKlhR0KsA3zOGU9BAZWp76bEiSqbVqQqnKShp
8uM+zboB+V5nvxCeRfCnjYH/KtfwbplHn18+noK9cdZjSmfXcDtkvNj0fAoK
EmVa8ylruNHf4IvKb6fgY86T5EHPPzjfxcFLbT+mQIzlsX7y7Ar+xf9HhNbA
FCwsuvyOmF7ENx4KjRmWnQb/GlmX9BMz+A1Dl5oKxWk4MFTy3p9lBmeXMRN4
ozINZwTYnm3XnsbZZ7jTL+hMQ0nLyjQlYRJnT3j4ksOMeC6++buzAR1nrSor
U/KYhsGOP52/91NxFjORjQEPp+HKv/Zu0YafeKTy6r6DT6cBsxqXfNlSjLOQ
+uP0Xk6DkV+Gc+XfjzjLwCvhf2+nYfn2PeX2giR8/YqJfOKPaXCTNNwzsFoM
/7567f7QOw1fO/jvt2S1wz/RTrTKOwN0C4Edb2MmodvSS4jKPwPHe8eDZV5P
QWHYpE81aQau5HCsc9RPw7meDdyZIjNwdHPiwVTeWaA9VHHYuXUGtDSuywV6
zkGjYvj4VbUZ0JQ991VCcxme6UoJbrSegZj/BszOqmzArOx8vPhjZqDiaNDZ
zb482PnAAHOZOzNwMOsK1lvLg2UnXFDYHjcD7XezEGUHL8asuTnmmDQD/w5e
2Ypz8mEZli9OZafPQLBHWkzVO36MYTZ2Tj1nBrh8rltq3yZh8Xp+N6yrZkBj
4fLEIz4RrEEs4Hk0zyyIef8VT42TwD5yZNtJx8xC+etso9exCtj7wopdBndm
IUmCEWydq4Dl+c/p2MXNQrvTt28dFQrYs7p9IpFJs3Cc20CtcKMilpY219mf
PgvDzDNcYRGKWJiipdfDnFmIMP0YEnNqG7bLYv6CZPUs/ONOGWnWVMZMlyVP
7KidhWnap5UVK2XMKNfyqG39LCjIt4j98VHGdPgeGkU0z0KKdcOZuAxlTL7N
cr23exYO+ZyY7GFXwTb5PozJYsyCEYd82+96Faz+plWGBB8THLDAwcu71TC7
ni18JAEmXDpuKJh7RA1r0hmP3CjIBHbD8/GvT6lhbf3RvlMiTODU+bJjW4oa
1mf4WxttZYKIobHzSr8aNjUJFV7qTNAbLfKuD1LHgsz5jY9qMmH9g+EWwWvq
GPNB3xsbbSbsKt3LIZ+iji3uvZKip8cE2crGb58+qWN/Hxe5cu5kgm/raZsb
C+oYj6PeQq4NE8wqUrZ+CtDAEvLYTz60ZcKryvsxLZc1MAG2lq4UOyZs4jh3
5edtDUz4fTAKt2dCdZPTbZbnGpg41/tYW2cmnHA4sMzfqYFlul/9Z+bKBDW2
+2H/jWhgkgW2Z/XdmbB2VfxF36wGJus96SjtzYSwJJE33Zs1MZUfKrLMU0xo
0Pn52lVfE8sTXr07GsCEg41BmcZmmpjGqUrO7kAmbOQr/kq10cR0RE9O/jrH
hJv779ukemhihsHPC1MvE/vPqvSEx2hiRRXnVe9cIfphqzDJ/08TM5Eyz464
yoRQ06L7+Q80Maxm6PqJ60woa7a0Fs7TxPYpSh8wjGUCR0RV0/EaTWzMMJop
F88ENyx95lezJnZr/1QqXyITfvgO6610aWKl57/1UJMJvSsGPKppmphXjFxk
3V0mJOz/6n5yWhNjzbwj9zWNCV9xloKmBU1s16+j/gkPmCCY39rIuUELG2jD
eS9lMkFC+j+1WTYtLJKu+MErmwk1bymHfnJoYT9IC0sGTwg9gjxkyDxamIuC
c4bcMyZkOCv1PeDTwtYMfpnyvSD639UYy0HSwozc/7tJzWFC4P5btGQRLazz
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
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Epilog->{
    LineBox[
     NCache[{{0, Pi}, {1.5362383997744917`, Pi}}, {{0, 3.141592653589793}, {
       1.5362383997744917`, 3.141592653589793}}]], 
    LineBox[
     NCache[{{0, -Pi}, {1.5362383997744917`, -Pi}}, {{
       0, -3.141592653589793}, {1.5362383997744917`, -3.141592653589793}}]]},
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6325716175282545`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1: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
WSdIUfSuD++i4DcPSsuM8jthKvK1buMeChYI+rw+v7wTJNNj9cnuFKzvaTvh
XdUJ09TC3LijFHzIsfmZRkMnVF5/q918koJf6/bIPerqhOJftUGNgRS8b3iO
5+5iJxxuHJJ+E0nBV76fp1lxd4Fy5LqE8tsU/OIj13luwS54TtPJSYym4OU0
4Zkw2S64UTS3suw+BVOi4nONVLvgtOi2K3zJFOx4XuYoU6sLJuDGCrVUCs7a
p9HhbdwF3T6v7tU8puBvli8SNFAXON0NG3B8SsEc/fX2/Tu6oOPrlw85zyhY
RbVE4JFDF8jlCNR/e07BNqJbP7m4dMGXhE0FlbkUHLT88ZK4excUBJ6QjXhJ
wekTO4wbj3fBDtOa12vyKbi24yvrjl8X3LFGKn6vKJhZsyffKqQLmOZhckmv
KViupOMEd3gXzDxud7xTQMGWWe5qFZFdQGWGh9oUUrBf/HB3WHQXzKOEHT8J
Tr7i88AosQvsZHyD1hZRcKUf04n5qAuK7wu/cyB44tA54fysLhB96/JtK8ES
tsvV3nld8NFXOWSOuN7M5PpVjeIuuOuucTaEYG/NVVv7y7rAfuen65XE/eMl
Y9mpn7rA/fLNgHaivvKVkoUuXwg9K5tWviPqH2am+Ih/74LOwj6uI4Q+kX4V
SmNnFxxoazP6Tug3/pbdf2egC9jd786KvCDyU66bakXvgstJnjfW5BD5eVG0
l5vVBZeaNu3sI/wdd1pvc3SxC87Z1ZDMCP+tfuebVXN3g31W+9mDRH+yHlMN
tIS64Y1fwZZNaRS8Ymeu5h3xbjDprrJofkjBbjMUhUn5blh3odRdO4moNymL
ZK/RDY1vmX4QT8Ehwxm/xYy6Qde9qyeLyE9rlOJ0oGk3OLOZ3HMRFLzBMHXg
x/Zu6Hkmlc11hYInryV9ebivGzqL9RV3B1OwtY4E/uPWDelSu1qTzlBwdvO9
4sMnukFl5O63ZCK/R1Si01RDu4GuUxTUeoiCK2oE469f6QbNU1ZKIvsoWOHM
rRvDt7rBa2YLH68DBf/8cP1M7sNu2KbDfK2DKNju4HnzDWXd8PrZL/o+ZQrO
5V4wSvjUDbZ+4pwLUhTM9yJYZ/5LN7hKOrW4rabgjwv+4qXd3bDCYDbIjdjv
G5NODKO/3dA/UfreupmME0yHOzL5eoDCY3n8SDUZM4Y8v/GI9kC8b8EG4zIy
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
4v8Byt3rlQ==
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6325716185259542`*^9}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
    1.], LineBox[CompressedData["
1:eJwV2Xc4le8bAHAkVAilIbLLSiKF4n7JJuOc1x5HNGWvxldFKHskMyRRUWZD
KJ4WQlb23vMcjnVo/97fP1yf63ifcT/3fb/PuYg6e5LOsTAxMd0nfvz/N7eW
eeRah5PG3trCIvW94igFcd00GNUANueeydvS4oiUclyGbdQEHrNYU+pUxVHx
beOgiRFHWCoQ2HPOVhw5blg+/z7iAYc/xxT2PhBHykoDWOPITeDyZvz7ICyB
HrVmbasbiYWonytXzshKIithpqXPI1ngcDHdVZZ0EK0kJ8w+2FUCZaO72J30
5NDACX9prulyELTsNol9poA6LU7XY/E10BXMNTpur4RemXse7l78BK18xde3
5RxDLpuYtRNa66A5y/lQwB41NGziiV9kbYL7LGMZBz01kM+crKEZXyvM5OB8
Pys10UzZZ+6Fv22wlhFnz3lbG2nXG5kL8HfABYtvhdp79NEOlysq9exdwN35
IZ661Rgd2OdU/oTeDZ55T2+/VzRDalfIl+kb3UCrotvcOmmGTL7rCqsx94D0
yRkxLV0zFBB16O433h7YOnplX4ONGfry66flqmIPeHrouIwEmaGzA0kMTf8e
iII3mzhbzNDjzEblwR89oCqxLuTtao7e/KiePcDSC9Y3+F34/MxRg0VZptfW
XiiX9NYpuWGOlrnSNrPu6wX9Cubto/HmSOvm+U6Zk72QV+wVw1tujsYcmf2v
3uyFnYWBjeEsJCQicvzVjk19sKy7ae+V+yRkyP3eo2VrH7wuGestzyAhv99a
0lF8fYDbyOjQc0morscki0WsD/JlqvX1XpOQR8L58CWsDxYMZvZHdJJQFUuy
fcvNPpgvixQ+upOMJuj7dkfd6QM1sR8PeveREffwozbd2D648ye4y1ecjJyr
CnWrM/vA9nB3U5giGXH4fVEofNcHldF3bwuYkZHl5Cpr1M8+2NGoGjAYTkZB
36/X6LL0Q9Yzy7S3cWRU8IHpOsvWfvisuCU0LJmM/mRyLl7b2w8+d4JpK4/J
KNdSoveiSj8Mrkv8Eqomo6U6cqFuQD+4p/pa3lwkI4E3vRdYbvbDIxLzVqc1
MtLOpYhVh/VD245zeQq/yCg16HKKclI/zFzdNpzJhiMN1ZBgiVf9YPNbK+qx
II6iC8osWJb7waLVu+mYDo5mzRUMz/7sh/96bV5aGeJI90ehRi3LABSfqbt8
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
FgXxBmssK9ZfUimaDrOBLeS2SmtsuSls2jKeDtxqvS/WHlhjDwyeXM5KpYOp
X5WQo4M1RtWa9j2UTwdb8xfO+QNWWIzypVCjBjr8h3OH/mqyxN7i3uccmujg
/+tat32VJTbme03Xs5kOjdUarwryLbFjZREcie10SDogNLvtjiU2JF8Q3ddH
zBcuLj2ubonJS83fvzRPhytcmq0D+RZYq4B73l3OJcjcfujEOx8cCxrayxHA
vQSfzX9HMig4djin1vUszxI89FNd3H8ax2KlRRQ0dy6B62jgiOpBHDNW+V75
c98SJCn7dqb0kbGvFqqt7rJLYHp1k82iOhn7GL/5F9lwCb7E+zevM8yxl2xZ
ZiLhS3CnVEeu+ZwJVvK2XlMlcgm6VOd3n1EywV64riiaRS/B7evJl5qYTLDc
Zn3+oPgl4DZY4Tr04DSWnLzSO5y6BBu+HU8Fm42x6wcMXB7mL0FQ2ODOOTkj
TFN31X9/4xJIbBZS1WjVw1rCDB8Ici/DXae7sps+YZj+ARFT1ahl2H/9bhEW
uBebVr27LB6zDEHrvTO7e3djd04vJHHHLcNkZruM97Fd2Ge/dwPj95ZhPelW
zZtlPkzzk7VrbPoynHd/o9UyzoGpOSWEjecvQ4k9s7VK8ruaQ+ks72Lql6Eg
RjH8cMlexMc9KTW2eQWOzC6/6bNVRH+3N9gy2FfA9NxgQ/Z7RTTHWxy9desK
3JHnPsojooQ+8l+jK3KvgIZqzMTMuBLyEeJ6G7JrBRJkWC/4XlBG3+WU9SQP
rsCtgjmTEAcVdN8o7NxF/RW4eFjwRAeLBgo67ZoSaLgCJ/gDRuk2GsjN1PRr
vPEK4F/Zdj0v0UDa5L2HKsxWoDGPfG3dHtCqbeHqFpsVYDZ6vOhvjSEL186Q
55dWQE/j67sdjzXRrgjJnIXIFXiibfb7G582Cj9cbDEcvQL+DV09ecra6Een
ypbW2BVoEZi9RrLWRgNixl6l91agmo1HRyZTG+W889HwS18B7o7Zrk4JHSRP
r+n7kb8CLDYntQ7J6SJdK9sdm7+ugIBuS/+dffro7Z/x2rWGFRifv+omqqqP
pHPdr081rUDGWafFREt9xLkUNFrXugK2HhxWzAn6qD3yaXFkzwpM3K95wsxq
gByrV414ZlYgOdCQpXLMAAVIxoXuY18FnZX3QgdDjdDRyuRa5S2r4H4/YV74
oRFaMcniMNu2CvSfXpWLFUbI62phdOj2VSjeogz8i0boUmPjfdruVdDHNWRv
Whkje2+OvBqpVRjhrab9EDmNTr0P/uJiuAq6C992yKSaIBZSBPtN41XYZVE9
411kgtBUvEGqySrx/W66M+WzCTrJk/2tibQKxmeKW27STdAxl+pOZbtVOFh4
QrxG1xTJbPk1ye5GjGfSmnCcZop4LPzYXsSsggdPTFRpghmiPtlx7V3cKrwe
Ygl9n26G6jfK5psSVsHB9+3ed4/N0K2MpVZa0iqk5SR6Jrw2QwvjHg8OZ61C
vM7BrqweM9Toc0nhZdEqVFtfmccFzdGdeEfbypZVyCPnGOWnmyPnsT9NDW2r
oM5EXpfNMUfqRzOh//sqqOVVnHmcb45Wu/slfnevwoAfPd/rrTlyESbKfGQV
tqvF373TaY6wInLoB/oqdEwxNgq4SOhXo35RPe8aHP+GfKUCSMj+Y3TO6x1r
EIxn59H/I6Hqt63JOfxrwHLG1agkmISC8qxvBe5dg27TBzy7YkiI9dZFMwXR
NZhUOKcf+JiEuBTDl1MU1sBN+DW5opmEhFPrjl0wXYMKn8VZEWEyCordJoub
r8HfzIeCE+JkNBZqKqxJXgMhoeyQh1JklOvdzb7Pag3cx1eZ/x0hIymj6Z5m
xzX4PZp46ow2GR35y/bfMQ9ifZdKK99cIKNTZ3VrNsesAf7jYNGHZ2S0rM+h
JRi3Bp/EP7yffEFG2YcaPismrMH7p9TjzKVk9JtxuoGStAb2yyY39leQ0asI
i86KzDXI/+mGluvJSKL47Lx70Rq01IYFbp4mo/bEAx6hJWvwQmEzV84csf6r
M/T0sjXYQZ8+dWyBjAY03Rh1b9agtkv5pc4aGd3v8GUWq1mDP4v+G0ybcMT6
8/burpY1OBQRMzEviKOyIe10atsabN+/6yyrCI6cPrEJbepYg9jy5aqd4jh6
Fx0pptCzBkYVg0xC0jjyE753KHJkDXYtlx5pOoqjCe1HpzSW1qC86Xj8U0Mc
3ZN2qcVXiPNxfD+hcRpHGLekweW1NXjSfeVksymOMrqfmaT+WIP2z3uZOnEc
4a4lNsvMDPiomiIc4oijz3E1nk/4GNDBJd7j4oWjjT0H/NJ2MsBBjCJq44Mj
2Zzoq9G7GFB1TSNJz4+Y75VNsI8AA36UR7HyXCXW37tyT0OMAQy1XGXTWzi6
72ybckSCAa5C5zm4g3FUN48eSBxggHNi8M7a2ziS/xuTu1WGAa+WXw2L3sHR
bzGpN11HGPB7w9E7PBpHCi9iK78qMUA+9LwGbyyOXJTXqt8pM+DmmDApMQ5H
DXof63JUGZCa0oGH3MNRqpt9r4cmA66JM23wpeKoae3j4JlTDDDtypE9n4aj
fzelx3AdBgTRvrwsS8fR+QTGnJoBA6RYZeuPZ+JI6U38bzZzBvwxW5dffkR8
DutMP0kMkOk9eZTnMY7S6x0203AGPHg4kn4wF0dM/TLc360ZYG8ad0/rCY6a
/30WfuhEzN/IsJEuwBFLhKzEPWcG1Mx+TeF7jiNlvntSYWeJeLjs0F4jnCFB
OXL5IgOm/O4sPCnEkavBD63jXgwwer1UXlWCo6x2ip6MDwNMpCOSvUpx1GZX
ayTkx4BRlzP0/WU4UvFIxDddZQAlapfgxZc4clv/Yc24xgBePp4lllc4ehjk
5DD7HzH+vRC9FMJsiYfOt9xiwA1+kVsvXuNITfC+68dgBhjLbj576A2O3PN+
erwOIeYPPtT2lHC2/BnfZ2EMIOtsr99XjqOO8rorD+4yYIeUpGEEYQ5N+cDY
CAbsdFiwphM+0XA/KDiKAeXpC2tmb3GUM3Am4kIcA+JTKkb+El4Rc6o2S2BA
6xHHd4YVONK+5LiimsiAyOuubvGE7xfbS4knMWBxwGm5hfDkmq0DZwoDhhfq
TLdU4ujYSZt7a6kMGPGSuXOS8J3bVnVD6QyQM9mdcolwd73F77oMBuRmiIbG
E5bajh8pzWJAd8aISSnhaxak8+nZDPhbsbjRSLjhgdmDkBwGsEQuhIwQFhgz
aXXLZYDPt6ClBcKXpU5vtnxCrN/T5NQ64XceRmrwjDhP4/XrPwhzvjbwlCpg
wP1brWlrhB1+6eXyvmDA8orho3nCRZq6vT8LGWBZN3avn/C/u9rcE8UMCKnd
5fWFsFmz1qlvpQwIdL+olk84e6fm1TcviXhM263cIbxkC4UPXzNAafvVDEfC
Wo/Ux8LLGXDKQ/e4AuF70yd2+1QwoE6d/OUXEa/xQ2rGdlUM4D5/SP8D4aN+
KsHa7xnw4ub5D0GEwyqPvTlUwwDf5nuKaoS7mJTnd31gwH9GBpk04nwO6CmJ
MH1iwL4H4pseEL4Sc8Ri9jMDlnirz2kRrv9+OLK9lgE9L8trx4nz3iMgX1NV
T+xXqezgLcKVT2SkY5sYEMquQX9M5M82mpTjlWYG3D0kYvf//LJXOpjo1MqA
yvKcphIi//7UiP9R7GBA1KPMr3lEfpqwiSkKdjEgllnbejfhLGORC5t7iHqr
61u5TeQ31ivY1t1PfH7JxVqfyP8E4X1sHwYZkJKeJZFD1MfYub0nCoYZsNBv
z8og6idkmT8vcJwBh8M5NkcX46h22/ZrovMMSMrgUPN+gaPdJK6irTQGJAqe
bHtA1OPF1G3jKwsMEMHcIhBRv1skOU7XLhP5fz/bZeMZjow1mEUv/yT636O6
RdE8on5D/1ngvxngJnq0RojoB7SGP5HqfxlA2nX1/Q6iX8Ra/VzdzrIOQcmp
pxeyifr1Wql/tWUd9gcJLzhk4MgjzzO6bts6pOyR38P7gMinvnnTPq51wAOd
rr8n+pX+qYmuf7zr8KvvNp05BUfV/J0ThgLrMMMTPqmagKMX//83jsw6aHlI
bbkYiiPDRcXPK3LrcHj4cnsx0V+nxYvvsh1eB8cx25/0IByJxTzlllNaB+y4
gRflBo7SKKmCV06sw4+PVido/kQ9sV5X4TJeB6Ul09jmcziSUGX8EjZZB96/
Dv6FLjj64O5To2i2DgbziRNhZ4h+3eWqa42vg3iP0XlxBxz55tvhj+3XoaXh
/Cle4v3iZKLupeq+DpuUD7dXYkS/SWV6di52HXyCr9nY8BP14i1Kw+PXweOn
6lA2H46CDLUUte+tw2rPJ97x7cR5/Q55J5a8Dsncp+OstuKIfIa9bThzHWLn
L8ky/yMjNxnunzaF63B+YUrGhng/Z77bZ2zStA4Tc1WD8q/ICCWdTFBvXocs
4xumbSVkNOHh0CXXug7af0K/eBSSkYzoQ6dtHetwY7Xka/oTMnoTJuZf378O
V/moweWpZNRsIp2lNb8O2zgHlNgCyYhp9Bj92NYNuMqruYML/v9+P9JC4dwA
jxJWnYdqxP2kXq4onHsD5jvC3sgeIyOzYjG3Pr4N+Gnw+pLSIeL+cYN75sa+
DXgXzRT+V4CMNAWmhj/LbYD75A2Xu2skdJuc1EIy3YBXRW2TwU9IaJdefNF/
5hsw+1HgwtlHJFSgFhWTS94Azq/9ZZoZJNQuGmzEsNoA3WyXKmoCCYnR3erS
nDbAVZ2Lc/MNEvoYrV0z4r1BfP/4HaFFIiHLIMja4rcBv48Gfv5uTEJzvmo3
FAM2wODLVh4nPRLis1M4EXp9A2xLqfOXTpKQs7Rg+cGQDeBfmDxy6gAJMQR3
J5uFbUCpDZNXoQgJRfLw+V+7uwEtPlZjfPtIqGydXakxagNWFMz9W7aTkO48
C99qzAZcvFyddWArCfUN/aELxm+A6s0/XNdYScijfaNF594GVCS5DXr+Mkeb
aleKPO5vgLre5wCeH+bof1Gpih0=
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{"DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.6325716185619836`*^9}],

Cell[BoxData["7.80076295643099`"], "Output",
 CellChangeTimes->{3.632571618661042*^9}],

Cell[BoxData["74.17664259983097`"], "Output",
 CellChangeTimes->{3.63257161867105*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"N2lbf", " ", "=", " ", 
   RowBox[{"1", "/", "4.4482216"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"N2lbf", " ", 
     RowBox[{"Rest", "@", 
      RowBox[{"DynamicQnts", "[", 
       RowBox[{"mag", ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"q", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}], ",", " ", 
        RowBox[{"u", "[", 
         RowBox[{"s", ",", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"q", "[", "s", "]"}], ",", " ", 
            RowBox[{
             RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}]}], 
       "]"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"N2lbf", " ", 
  RowBox[{"Max", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"Rest", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"mag", ",", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"q", "[", "s", "]"}], ",", " ", 
           RowBox[{
            RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}], ",", " ", 
         RowBox[{"u", "[", 
          RowBox[{"s", ",", " ", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}]}], 
        "]"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "t", ",", " ", 
       RowBox[{"t", "/", "200"}]}], "}"}]}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6312826747903357`*^9, 3.6312827097439413`*^9}, {
  3.63128276260401*^9, 3.6312827817448936`*^9}, {3.6312828425813284`*^9, 
  3.631282885969198*^9}, {3.631282972259715*^9, 3.6312830187759757`*^9}, {
  3.6312830877144165`*^9, 3.631283121355502*^9}}],

Cell[BoxData[
 RowBox[{"Quiet", "@", 
  RowBox[{"ParametricPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"s", ",", " ", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"q", "[", "s", "]"}], ",", " ", 
          RowBox[{
           RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", 
         RowBox[{
          RowBox[{"60", "/", "2"}], "/", "\[Pi]"}]}], "}"}], ".", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "s", "]"}]}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
    RowBox[{"AspectRatio", "\[Rule]", " ", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.629704708662342*^9, 3.629704759991125*^9}, {
  3.629704817773198*^9, 3.6297048189919353`*^9}, {3.6297048611956224`*^9, 
  3.6297048651488085`*^9}, {3.6297050040881767`*^9, 3.6297050155883303`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpeedTorqueCurve", "[", 
  RowBox[{"10", ",", " ", "25", ",", " ", 
   RowBox[{"Point", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Abs", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"s", ",", " ", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"q", "[", "s", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], "]"}], " ", 
          "1000"}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "s", "]"}], "\[LeftDoubleBracket]", "4", 
           "\[RightDoubleBracket]"}], " ", 
          RowBox[{
           RowBox[{"60", "/", "2"}], "/", "\[Pi]"}]}]}], "}"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", "t", ",", " ", 
        RowBox[{"t", "/", "200"}]}], "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6307646487411795`*^9, 3.6307647622587137`*^9}, {
   3.630764800087515*^9, 3.6307648320880423`*^9}, {3.630764936206891*^9, 
   3.630764941431609*^9}, 3.6307650420599003`*^9, {3.631447117125819*^9, 
   3.631447117198871*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[
    GraphicsComplexBox[CompressedData["
1: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
6Z8AhO8dV7IUvgk1bSk9/qPeiHqvxCUyWQTacL6mRqwbrpuaqXKp3sWmrlqt
pNyjCJ5u/8f4ThnER/mFTPio0Hp2M36BWCUOKeumfbCxxIYyYaO2oDrYBNje
2x6mAbUFOh384g3g7T666T2LIqYS33FLO11DjNvDn1/6QnDKt0jtVUcuFuV1
B0Y98AX1IXqvRhRChn9L/r4znkipZHPYcbYYnHycAkb9TvAebfVu0mHe9+9y
RWGHbfCt43irPdGArxHc7ukvJGDEy6AUX7iKkUn/v9m1p/C7M7G4fHsONi5T
SeWp8Mer/hyz9ZHM9efVI+5YyuLeD1rmij8pOL//1F59tiiIZtpT7anM8+uL
6drnPEPRu7PTP+z0ZRRlWAilF0WgXfcYd/vOLBjFTyaWpQTiQ+qxtO+Z+bDe
UOg28cQbnLd83yQ8KILqiHydySJ3ZG7taVeaLUHz1SqBLH4aov54BobRy6DY
O8n50JKKNFez8b7BCvCvF7W79tIS9R6X9dzt6xC+8mtA3ApNCOt+LTo9XY+C
qBP2QmpK2O2WkaDPeg2J7s4Pkw1D8S4hT1zINRdLh95K5G/zQ5NYmc4WsUJM
/25YyzfgiSWhutvKDxdD2o3DuNfAGYuyTDyOKtQjpTsi4+s5NexfWFjJeNkA
Qer1ComI5RhtouwTaErHtE6/+DOtMJh/ikr82pWN2cfd3/o16SiWM1TNcmqA
X7+ALh9jHaTVa5TrlqXAvFs0XXQ0CmOjvBpvtRrxburVUZ1+Lnxrohmx2VyE
h+GBJ6afYpBOPzzbJsB8PiAv7LVJFOqWVWEfgxoRQk1YG202QklJmJ29I30Z
gnkZWt+5IhFi4vDz46IsXCgVfl39byAk67OMalzy8e6GsGc8qw8az6Tuac0t
wuqrEwxbPWZ/vLF8ufZACWBQwOjVpIE/oE566ZEynD3Hu8UpjIqH2zfKGrZU
gJLXMDIlYoWEJ0daas3q4Ehde3expyZmXXbLNIzVI8SoIcS4WwmjViHP7Nsy
8COpaP3h6FCcSc3i2qiWi1WSw2vlff0wRfk+w/ruFgr61guq8Xqhy84lc3JX
McwKDR/TIp3xgkVyrGwl8/sEkn9Fym+H+ibW9TMtDcib2nDU2l0Gqll/23dY
p8NBkvGaIz4MXFPhJ3kzs6Hmx3dwcTQd6fqZ2e+sGvDyoe6N0HE5dPbS6Odu
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
ch42V5lp8kmO7RfI+VfdmnGD/e3ZZP4fwb2CtQ==
     "], {{{}, {}, {}, {
        EdgeForm[], 
        Directive[
         RGBColor[1, 0, 0], 
         Opacity[0.2]], 
        GraphicsGroupBox[{
          PolygonBox[CompressedData["
1:eJwt0uc2FgAAgOGPO+mGHGQfe4X0GdkkJET2HtmULWSnrMqKygV5nNOP5wre
90l6QWQwNBAIhNBEGIkkcc8+f5niH7vc0coefxjnC78pY5IdbnnLMOtckE0L
Y2xyTQGv6WWRUxIopZEh1vhFFkFq6WGBE+KJI5ZMXvCKbj5xTAwZ5FNDFx/5
TjTpPKeaTub5RhQlvGGQVX6SRh5VdDDHEU95SQMDrPCDVHKppJ1ZvhJJMfX0
s8w5KTQzygZX5FDBe2Y4JIIi6uhjiTOS/zcd4TOXPKOcNqY5IJx3fGCLGwqZ
YPuxjTkeAJECTok=
           "]]}]}, {
        EdgeForm[], 
        Directive[
         RGBColor[0.560181, 0.691569, 0.194885], 
         Opacity[0.2]], 
        GraphicsGroupBox[{
          PolygonBox[CompressedData["
1:eJwl0nlTj1EABeBfZYsQZUm0kUq2KCVaKWtKhFAIlWiTypKm7+P7hCIUqVRU
ZC09xh/PnHfmnDvv3JkbX9Nc3hQcCASCeEaIj1LZI4+wh0U0cp4cUoii1+6m
PMl+YlnNYpqoIJcdbOK5/S15inTiCGcJzVwgj1SieWF/W54mg3jWsJQWLpLP
Tjbz0r5WlnCABNayjD5dnTxDJluJIJR+Xf2/e5PFNiJZzivdHVnGQRJZxwpe
6wZ4w1veMcgQ7/nAMB8ZYZQxPtHg/Fmy2c562rjMUfYSRiuXKGAXHVRxjC08
4ApFPOI6T0mjk2q6OM5jbjDu/3dlOYdIYgMrmdBN8pkvTDHNDF/5xizf+cFP
fvGbP8wxz9/A/0cVRDD3OMdhktnIKu5TSSG7iaGdqxSzj4dc4wRPqKGbBbLn
SWo=
           
           "]]}]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}, {{}, \
{}, {
        Directive[
         Opacity[1.], 
         AbsoluteThickness[1.6], 
         Thickness[Large], 
         RGBColor[0, 0, 1]], 
        LineBox[{1, 71, 65, 60, 56, 53, 51, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 
         12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 
         29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 
         46, 47, 48, 49, 72, 66, 61, 57, 54, 52, 73, 67, 62, 58, 55, 74, 68, 
         63, 59, 75, 69, 64, 76, 70, 77, 50}]}, {
        Directive[
         Opacity[1.], 
         AbsoluteThickness[1.6], 
         Thickness[Large], 
         RGBColor[1, 0, 0]], 
        LineBox[CompressedData["
1:eJwt0dVSFAAABdDlU/gjXECBB2JRRGppKUG6u1tSQUklRelUST+IwwwPZ+59
vXMjQ+FgTkQgEKilStmUk+Tyjx+M00wUP5mmlfe85Yo1RmggkRO+0sdH8njB
HjO0UUI6f1hnlEaSOOUb/VSTT5BfzNJOKe9I5owlBqihgGh+M0cHZWSQwjnL
DD5vLySGfebppJxMQsRywGe6qCCLVF5yyBe6+UA2r3lFHPEcsUAPleTwhgtW
GKKOIhI4ZpHep28I85fvjNFEGpesMkw9N2zxiWKu2WCCO3Zo4ZZtHpjinl3+
8whBBE19
         "]]}, {
        Directive[
         Opacity[1.], 
         AbsoluteThickness[1.6], 
         Thickness[Large], 
         GrayLevel[0.5]], 
        LineBox[CompressedData["
1:eJwVzelWDlAABdCvImUoqdBEmUoaFFFJIRSZKqQoSQNJRYaMq+fxQEKSRKhE
ESpk92Ovc9c6596b0tRV1RkUCASe0edQSjZLuMlZ9rOdOJ7bXZXH2cVGIlnK
4kPnKCadePrtm2UFu0lmNaF0cZ4SdpDAC/sWeYI8UohiGd3UcIAMEnlp3ypP
sodNrCGMV7o2eYq9bCaacAZ01+Rp8tlCDMt5rbsuz1DAVmJZwaDuDUO8ZZh3
jPCeD4zykU98Zoxx2t2vpJBtrKWHOg6zk5Xc4gIHyeQe9ZSRxB0ucoQHNPKE
HO7TwGPKecgVJvx/Q1axj1TWsYovukm+8o0ppvnOD2b4yS9+M8sc8/zhL/9Y
IOC9IILpoJoi0lhPBLep5RBZbOAulzhKLr1c5hiPaOIpIfwH2ONJGA==
         "]]}}}], {
    DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0., 0.}, DisplayFunction :> 
     Identity, Epilog -> {
       PointSize[Large], 
       TagBox[
        TooltipBox[
         PointBox[
          NCache[{4000, 420/Pi}, {4000, 133.69015219719208`}]], 
         "\"Operating Point\"", LabelStyle -> "TextStyling"], 
        Annotation[#, "Operating Point", "Tooltip"]& ], 
       Thickness[Large], 
       TagBox[
        TooltipBox[
         LineBox[{{10680., 0}, {10680., 6000}}], "\"Max Battery Current\"", 
         LabelStyle -> "TextStyling"], 
        Annotation[#, "Max Battery Current", "Tooltip"]& ], 
       RGBColor[0.5, 0, 0.5], 
       TagBox[
        TooltipBox[
         PointBox[{7000, 75}], "\"Operating Point with Safety Factor\"", 
         LabelStyle -> "TextStyling"], 
        Annotation[#, "Operating Point with Safety Factor", "Tooltip"]& ], 
       PointBox[{{995.5691836233261, 9.549296585513721}, {1040.4844308269317`,
          10.071821153585347`}, {1086.7755306803813`, 10.604701117843078`}, {
         1134.5525652164815`, 11.148041089703115`}, {1183.9345155819994`, 
         11.701997829621748`}, {1235.0494000219833`, 12.266784881976825`}, {
         1288.0346882017313`, 12.842681722173658`}, {1343.0367724907883`, 
         13.430027405354505`}, {1400.2116622543308`, 14.02923408094803}, {
         1459.7254121053008`, 14.640794853576114`}, {1521.7529156860458`, 
         15.265265775220744`}, {1586.4795457694022`, 15.90329215202231}, {
         1654.1008247560405`, 16.555602353207338`}, {1724.8226893596247`, 
         17.223010018979394`}, {1798.8619640653615`, 17.906418220778043`}, {
         1876.4469609000987`, 18.606823904554428`}, {1957.8178584951636`, 
         19.325317209360225`}, {2043.2275473067505`, 20.06308596751525}, {
         2132.9424416559286`, 20.821417478841788`}, {2227.2434524799596`, 
         21.601700301182532`}, {2326.4271880752417`, 22.405426818621326`}, {
         2430.8072833146994`, 23.234194918190447`}, {2540.7159483984556`, 
         24.089709891660213`}, {2656.5057219650084`, 24.973786128617245`}, {
         2778.551440006894, 25.888348656432054`}, {2907.252417363723, 
         26.835434432197278`}, {3043.034834446437, 27.817193368110747`}, {
         3186.3543002411443`, 28.835888757778537`}, {3337.6985407968796`, 
         29.893896908365864`}, {3497.590126832121, 30.993705563302203`}, {
         3666.5891478527356`, 32.1379112740833}, {3845.295611510212, 
         33.32921432902356}, {4034.351284516594, 34.57041034407151}, {
         4234.440557893759, 35.8643771653215}, {4446.289887872789, 
         37.214057372512755`}, {4670.664975465147, 38.622433357487026`}, {
         4908.3644412223375`, 40.092490018166}, {5160.208523646158, 
         41.6271624619475}, {5427.0209624827785`, 43.22926688565721}, {
         5709.60172376759, 44.901413203869}, {6008.685988593022, 
         46.64587792209962}, {6324.885293849367, 48.46443513923731}, {
         6658.60527814218, 50.358136148315005`}, {7009.935573744405, 
         52.32704932916576}, {7378.501049899378, 54.36990394326199}, {
         7763.268365353029, 56.483638205690504`}, {8162.303992089404, 
         58.66285381903847}, {8572.489822379956, 60.89922480356922}, {
         8989.194077844986, 63.18074522423944}, {9405.941998499597, 
         65.4910125684019}, {9814.120507314345, 67.80847052574984}, {
         10202.809894063741`, 70.10584573418333}, {10558.835017739382`, 
         72.34985931875751}, {10867.145931695311`, 74.5014037649902}, {
         11111.610995565996`, 76.51639360294917}, {11276.215233446925`, 
         78.34732884771137}, {11346.55252432924, 79.94562767112451}, {
         11311.349183939612`, 81.26443481283842}, {11163.693479503665`, 
         82.26156442861954}, {10901.662197597041`, 82.90209879717413}, {
         10528.177911968705`, 83.16017390710556}, {10050.137184891653`, 
         83.01967106218565}, {9477.035821581821, 82.47379215302864}, {
         8819.40818576108, 81.52366627287128}, {8087.384088993058, 
         80.17632245991646}, {7289.576826552698, 78.44236896443455}, {
         6432.401304218828, 76.33370492647009}, {5519.824095894711, 
         73.86143637704299}, {4553.494964038857, 71.03415215593014}, {
         3533.168953146699, 67.85656467602111}, {2457.340294549654, 
         64.32856012125953}, {1324.012728389883, 60.44464707165253}, {
         131.55832647143913`, 56.19382337312667}, {1120.3304668627181`, 
         51.55999966491989}, {2429.5707113710605`, 46.52298165636516}, {
         3790.405036089671, 41.060334142380356`}, {5191.824529809325, 
         35.150288640904165`}, {6615.701222406372, 28.775889541053097`}, {
         8034.890921298448, 21.930635637871458`}, {9412.009419357571, 
         14.62519620940159}, {10700.107000184385`, 6.894395613721735}, {
         11846.618415143432`, 1.197321831144701}, {12801.119251696677`, 
         9.554501404975854}, {13525.317118706373`, 18.05522917390289}, {
         14001.51511359666, 26.562186228975293`}, {14235.52207405325, 
         34.937407652284485`}, {14252.709809589494`, 43.056614707518854`}, {
         14089.572922868045`, 50.819246811985366`}, {13784.872396258312`, 
         58.1526533520537}, {13373.442530632223`, 65.01127072303228}, {
         12883.527078807332`, 71.37286978796682}, {12336.868527677081`, 
         77.23373555415996}, {11750.189975773801`, 82.60401403381134}, {
         11136.938477336933`, 87.50370682953722}, {10508.657852269165`, 
         91.95936655367541}, {9875.812998016188, 96.00139886350489}, {
         9248.160292029635, 99.66186828510547}, {8634.85076028202, 
         102.97275402196541`}, {8044.427906012914, 105.964637180004}, {
         7484.814225964446, 108.66580079097423`}, {6963.314268611896, 
         111.10171400176358`}, {6486.621350664586, 113.29485377579155`}, {
         6060.80042811278, 115.26480325349142`}, {5691.224359075729, 
         117.02855520336817`}, {5382.455599727601, 118.60096084622496`}, {
         5138.087034990045, 119.99521203677855`}, {4960.567660547293, 
         121.22333816873089`}, {4851.052946428079, 122.2966088150576}, {
         4809.315247469241, 123.22581736604812`}, {4833.740125904398, 
         124.02140623484168`}, {4921.415043749473, 124.6934280289905}, {
         5068.296482075305, 125.251356189606}, {5269.4250420104545`, 
         125.70377625225294`}, {5519.150099189974, 126.05799940078674`}, {
         5811.32735917215, 126.31964196403392`}, {6139.462619796554, 
         126.49221548141061`}, {6496.78863451347, 126.57673112787232`}, {
         6876.281453734495, 126.5714340262525}, {7270.631947315939, 
         126.47156388125995`}, {7672.207400750055, 126.26927303251755`}, {
         8073.045244027405, 125.95369130091728`}, {8464.927534931205, 
         125.51117119323813`}, {8839.583604763182, 124.9257385316729}, {
         9189.054540879195, 124.17973834568981`}, {9506.231189277807, 
         123.25469970064103`}, {9785.53148310694, 122.13233780401765`}, {
         10023.634159607449`, 120.795574128968}, {10220.149786644919`, 
         119.22954264420825`}, {10378.065985577401`, 117.42225780454253`}, {
         10503.850285698749`, 115.3650392564894}, {10607.1078781181, 
         113.05239173812322`}, {10699.812213412652`, 110.48158473356476`}, {
         10795.156847764929`, 107.65173156330602`}, {10906.188012798155`, 
         104.56277622416303`}, {11044.363640967966`, 101.21437478367265`}, {
         11218.21237754371, 97.60495138172686}, {11432.239343090609`, 
         93.73107103034813}, {11686.203984393846`, 89.58727886966665}, {
         11974.861270496629`, 85.16649659609813}, {12288.222147122977`, 
         80.46106014195762}, {12612.32690625187, 75.46432777732765}, {
         12930.456677344766`, 70.17270103318693}, {13224.65748833336, 
         64.58789459396374}, {13477.368834836718`, 58.71903562489221}, {
         13672.933937886248`, 52.5843282188453}, {13798.784617153151`, 
         46.21190281893842}, {13846.126170865109`, 39.639714946985215`}, {
         13810.061047685223`, 32.91454062287829}, {13689.178308658988`, 
         26.09006506460973}, {13484.750079983793`, 19.224536230713337`}, {
         13199.738102309444`, 12.37820250051399}, {12837.820368124541`, 
         5.610827597065776}, {12402.64123139508, 1.0204886731239646`}, {
         11897.40433416813, 7.463160061224693}, {11324.852426663021`, 
         13.670557360538533`}, {10687.597933858322`, 19.60316258263576}, {
         9988.695582219329, 25.229430510116057`}, {9232.312638326473, 
         30.526347375177124`}, {8424.324237746412, 35.47967770506472}, {
         7572.714154993085, 40.083822580520895`}, {6687.668682595997, 
         44.341233831734016`}, {5781.341233720843, 48.261439928045675`}, {
         4867.31842481642, 51.85968770812796}, {3959.8723728660652`, 
         55.15536318179102}, {3073.102436175942, 58.170352228300644`}, {
         2220.1036541235976`, 60.92748223939348}, {1412.2496306619523`, 
         63.44920415081071}, {658.6679222828174, 65.75656140587014}, {
         34.04441398889772, 67.86854160730272}, {661.888418827985, 
         69.8017164691496}, {1223.3248518859025`, 71.5701636255707}, {
         1718.9886921138227`, 73.18558009766313}, {2151.307995992558, 
         74.6575266682572}, {2524.082053908426, 75.99373407736039}, {
         2842.061427343825, 77.20042008940295}, {3110.5618875834325`, 
         78.28258776753552}, {3335.1283831230394`, 79.24429359741337}, {
         3521.2656881311764`, 80.08886525180053}, {3674.2257357635867`, 
         80.8190806537618}, {3798.855843472675, 81.43731132034415}, {
         3899.496114072245, 81.94563210175146}, {3979.9195314757467`, 
         82.3459087930398}, {4043.3062148952504`, 82.63986708543001}, {
         4092.244587691975, 82.82914940790145}, {4128.753929612724, 
         82.91536117292954}, {4154.3226191566655`, 82.90010973694777}, {
         4169.957705170713, 82.78504354363737}, {4176.243631724042, 
         82.57188125072913}, {4173.406682263697, 82.26243655773264}, {
         4161.382235349143, 81.85864318117211}, {4139.883202713809, 
         81.36257360066386}, {4108.467666042618, 80.77645169229537}, {
         4066.6037472643993`, 80.10266190741702}, {4013.7301414026574`, 
         79.34375143716389}, {3949.3107523446033`, 78.50242678659231}, {
         3872.8822107910355`, 77.58154337298855}, {3784.0933538606755`, 
         76.58408923183033}, {3682.7360054556707`, 75.51316289473974}, {
         3568.7667917938957`, 74.37194568051758}, {3442.3201528762083`, 
         73.16366991874968}, {0, 71.89158464916869}}]}, 
     Frame -> {{True, True}, {True, True}}, FrameLabel -> {{
        FormBox["\"Speed (rpm)\"", TraditionalForm], 
        FormBox["\"Duty Cycle (%)\"", TraditionalForm]}, {
        FormBox["\"Torque (mNm)\"", TraditionalForm], 
        FormBox["\"Current (A)\"", TraditionalForm]}}, 
     FrameTicks -> {{Automatic, {{40.71086534290774, 
          FormBox["10", TraditionalForm]}, {124.84840926533343`, 
          FormBox["20", TraditionalForm]}, {180.37216953414992`, 
          FormBox["30", TraditionalForm]}, {224.1326050927042, 
          FormBox["40", TraditionalForm]}, {261.224911024109, 
          FormBox["50", TraditionalForm]}, {293.92574876799756`, 
          FormBox["60", TraditionalForm]}, {323.469387107115, 
          FormBox["70", TraditionalForm]}, {350.60864557283963`, 
          FormBox["80", TraditionalForm]}, {375.8408171965254, 
          FormBox["90", TraditionalForm]}, {399.51390599999996`, 
          FormBox["100", TraditionalForm]}}}, {
       Automatic, Charting`ScaledFrameTicks[
         (Join[
          Map[{#, Null}& , 
           FindDivisions[{#, #2}, 50]], 
          Map[{#, 
            NumberForm[
             N[(#/$CellContext`km)/10], {5, 1}]}& , 
           FindDivisions[{#, #2}, 10]]]& )[
          SlotSequence[1]], {Identity, Identity}]& }}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], ImageSize -> Full, 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "ScalingFunctions" -> None, 
       "AxesInFront" -> True}, 
     PlotRange -> {{0, 41800}, {-0.9399912134693409, 884.4691282405128}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{
      "\"Speed-Torque Curve at Vnom\"", "\"Continuous Operation\"", 
       "\"Dangerous Operation\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    RGBColor[0, 0, 1]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    RGBColor[0, 0, 1]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    RGBColor[1, 0, 0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    RGBColor[1, 0, 0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {"Columns" -> {{0.8, 0.5}}}], "Grid"]}, {
              
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    GrayLevel[0.5]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    Thickness[Large], 
                    GrayLevel[0.5]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {"Columns" -> {{0.8, 0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxDividers -> {"Columns" -> {{None}}, "Rows" -> {{None}}}, 
             GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
             GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{1}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 0, 1], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> RGBColor[0., 0., 0.6666666666666666], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], "RGBColor[0, 0, 1]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0, 0, 1], Editable -> False, Selectable -> 
                    False]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], "RGBColor[1, 0, 0]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                   RowBox[{"Thickness", "[", "Large", "]"}], ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    RowBox[{
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "\[InvisibleSpace]"}], "GrayLevel[0.5]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    GrayLevel[0.5], Editable -> False, Selectable -> False]}],
                  "]"}]}], "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Row\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.631447122890318*^9, 3.631447168484761*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pcom", "[", "q_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m1", " ", 
       RowBox[{"GibbotQnts`Private`P1", "[", "q", "]"}]}], " ", "+", " ", 
      RowBox[{"m2", " ", 
       RowBox[{"GibbotQnts`Private`P2", "[", "q", "]"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"m1", "+", "m2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vcom", "[", 
    RowBox[{"q_", ",", " ", "qd_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"GibbotQnts`Private`dPcom", "[", 
     RowBox[{"mag", ",", " ", "q"}], "]"}], ".", "qd"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.629759403686988*^9, 3.629759421017277*^9}, {
  3.6297594568632455`*^9, 3.6297595772399006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", " ", "=", " ", 
   RowBox[{"2", "L1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x", " ", "=", " ", 
  RowBox[{"MinimizeFreeFlight", "[", 
   RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{"0", "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m2", " ", "g", " ", "r2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{"2", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "g", " ", "dy"}], "]"}], "/", "g"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", "\[IndentingNewLine]", "q", 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", " ", "=", " ", 
    RowBox[{
     RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"DrawGibbot", "[", 
      RowBox[{"mag", ",", " ", 
       RowBox[{"q", "[", "s", "]"}], ",", " ", 
       RowBox[{"PlotRange", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"L1", "+", "L2"}], ")"}]}], "/", "2"}], ",", " ", 
            RowBox[{"3", "dx"}]}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"L1", "+", "L2"}], ")"}]}], ",", " ", 
            RowBox[{"2", "dy"}]}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{"Epilog", "\[Rule]", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", " ", 
          RowBox[{"Point", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"dx", ",", " ", "dy"}], "}"}], "+", 
            RowBox[{"Pcom", "[", 
             RowBox[{"q", "[", "0", "]"}], "]"}]}], "]"}], ",", " ", "Blue", 
          ",", " ", 
          RowBox[{"Point", "[", 
           RowBox[{"Pcom", "[", 
            RowBox[{"q", "[", "s", "]"}], "]"}], "]"}]}], "}"}]}]}], "]"}], 
     ",", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"s", " ", ">", " ", "0"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "ParametricPlot", " ", "is", " ", "a", " ", "whiny", " ", "little", 
         " ", "function"}], " ", "*)"}], 
       RowBox[{"Quiet", "@", 
        RowBox[{"ParametricPlot", "[", 
         RowBox[{
          RowBox[{"Pcom", "[", 
           RowBox[{"q", "[", "a", "]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"a", ",", " ", "0", ",", " ", "s"}], "}"}]}], "]"}]}], ",",
        " ", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", "}"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6297547080228567`*^9, {3.6297548087273216`*^9, 3.6297548569779625`*^9}, {
   3.6297550733112416`*^9, 3.6297550741788635`*^9}, {3.6297551513407*^9, 
   3.629755270116463*^9}, {3.6297553314453526`*^9, 3.629755341883042*^9}, {
   3.629755377711646*^9, 3.6297554055869646`*^9}, {3.6297554539938574`*^9, 
   3.629755456493913*^9}, {3.629756535910117*^9, 3.6297565477540283`*^9}, 
   3.629756579660703*^9, {3.6297566140049133`*^9, 3.62975662509886*^9}, {
   3.6297566775682564`*^9, 3.6297566789276705`*^9}, {3.629756758788105*^9, 
   3.6297567638350496`*^9}, {3.6297568463673735`*^9, 
   3.6297569684158964`*^9}, {3.6297581472892766`*^9, 3.6297581484767923`*^9}, 
   3.62975821204011*^9, {3.6297582629627185`*^9, 3.629758304369521*^9}, {
   3.629758340807506*^9, 3.6297583433700104`*^9}, {3.629758440121299*^9, 
   3.629758446090128*^9}, {3.6297595869118986`*^9, 3.629759597927641*^9}, {
   3.6297597010071173`*^9, 3.629759738210757*^9}, {3.6297598346026955`*^9, 
   3.6297598530091605`*^9}, {3.6297598893846436`*^9, 3.62975990654115*^9}, {
   3.629759984198405*^9, 3.6297600194644794`*^9}, {3.629760110215736*^9, 
   3.6297601822224298`*^9}, {3.6297603037709*^9, 3.6297603050053444`*^9}, {
   3.629760359131014*^9, 3.6297603610685916`*^9}, {3.6297606044611297`*^9, 
   3.629760616955988*^9}, {3.629760817445223*^9, 3.6297608618357506`*^9}, {
   3.6297608996018476`*^9, 3.6297609374305058`*^9}, {3.6297609847279882`*^9, 
   3.629761110792143*^9}, {3.6297612101841364`*^9, 3.6297614026397905`*^9}, 
   3.629761461515573*^9, {3.6297615035161324`*^9, 3.629761536141597*^9}, {
   3.629761572407709*^9, 3.629761645986807*^9}, {3.6297620785550327`*^9, 
   3.6297620787581906`*^9}, {3.6297621579623384`*^9, 3.629762173962552*^9}, 
   3.6297660185077815`*^9, 3.6312907599247556`*^9, 3.6312908062691383`*^9}],

Cell[BoxData[
 RowBox[{"Max", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Max", "@", 
      RowBox[{"Abs", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"1", ",", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "th1", ",", " ", "th2"}], "}"}], ",", 
           " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], "]"}], ",",
          " ", 
         RowBox[{"0", " ", 
          RowBox[{"u", "[", 
           RowBox[{"0", ",", " ", "x"}], "]"}]}]}], "]"}]}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"th1", ",", " ", 
       RowBox[{"-", "\[Pi]"}], ",", " ", "\[Pi]", ",", " ", 
       RowBox[{"1", "/", "100"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"th2", ",", " ", 
       RowBox[{"-", "\[Pi]"}], ",", " ", "\[Pi]", ",", " ", 
       RowBox[{"1", "/", "100"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6312908168474097`*^9, 3.631290875910774*^9}, {
  3.6312960450401435`*^9, 3.6312961772919545`*^9}, {3.631297704437852*^9, 
  3.631297718453648*^9}, {3.6312978768247223`*^9, 3.6312978876998134`*^9}}],

Cell[BoxData[
 RowBox[{"374", " ", "N2lbf"}]], "Input",
 CellChangeTimes->{{3.6312978380428925`*^9, 3.6312978601682267`*^9}, {
  3.631302176392915*^9, 3.6313021768772907`*^9}}],

Cell[BoxData[{
 RowBox[{"q", "[", "0", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q", "'"}], "[", "0", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Pcom", "[", 
  RowBox[{"q", "[", "0", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Vcom", "[", 
  RowBox[{
   RowBox[{"q", "[", "0", "]"}], ",", " ", 
   RowBox[{
    RowBox[{"q", "'"}], "[", "0", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6297660830555153`*^9, 3.629766118571644*^9}, {
  3.6297661751660995`*^9, 3.6297661901819706`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"1", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", "t", "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ImpactQnts", "[", 
    RowBox[{"2", ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"q", "[", "t", "]"}], ",", " ", 
       RowBox[{
        RowBox[{"q", "'"}], "[", "t", "]"}]}], "]"}]}], "]"}], " ", "//", " ",
    "Chop"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"1", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"t", "/", "2"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"t", "/", "2"}], "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ImpactQnts", "[", 
   RowBox[{"2", ",", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"q", "[", 
       RowBox[{"t", "/", "2"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"q", "'"}], "[", 
       RowBox[{"t", "/", "2"}], "]"}]}], "]"}]}], "]"}], " ", "//", " ", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.629761784269868*^9, 3.629761786926182*^9}, {
  3.6297618473644867`*^9, 3.6297618868806367`*^9}, {3.6297621101804843`*^9, 
  3.629762125274433*^9}}],

Cell[BoxData[
 RowBox[{"TE", "@", "x"}]], "Input",
 CellChangeTimes->{{3.629764462898757*^9, 3.629764466617585*^9}}],

Cell[BoxData[
 RowBox[{"m2", " ", "r2", " ", "g"}]], "Input",
 CellChangeTimes->{{3.629851442247698*^9, 3.6298514433925123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specs-old", "Section",
 CellChangeTimes->{{3.5914870039053636`*^9, 3.591487004222381*^9}, {
  3.6289934659285192`*^9, 3.6289934886106005`*^9}, {3.629138508061183*^9, 
  3.629138516540187*^9}, {3.6296722233016214`*^9, 3.6296722236766243`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mag", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", " ", "=", " ", 
   RowBox[{"2", "L1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy", " ", "=", " ", "L1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{
    RowBox[{"MinimizeFreeFlight", "[", 
     RowBox[{"mag", ",", " ", "dx", ",", " ", "dy"}], "]"}], " ", "//", " ", 
    "Chop"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m2", " ", "g", " ", "r2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]", ",", " ", "x", ",", " ", "x1", ",", "x2", ",", "x3", ",", 
         "x4", ",", "x5", ",", "x6", ",", "x7", ",", "x8", ",", " ", "u", ",",
          " ", "rep", ",", " ", "A", ",", " ", "B"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "x7", 
           ",", "x8"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"GibbotQnts`Private`P3", "[", "x", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x3", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x4", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x7", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"x8", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"First", "@", 
            RowBox[{"DynamicQnts", "[", 
             RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "/.", " ", "rep"}], 
           " ", "//", " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "u", "}"}]}], "]"}], "/.", " ", "rep"}], " ", "//",
            " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"StateSpaceModel", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
               "\[RightDoubleBracket]"}], "}"}], "\[Transpose]"}], ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"LQRegulatorGains", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pump", " ", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", 
     RowBox[{"x_", ",", " ", "kp_", ",", " ", "kd_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"kp", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"72", "Degree", "  ", 
         RowBox[{"ArcTan", "[", 
          RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}],
           "]"}]}], " ", "-", " ", 
        RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}],
        ")"}]}], " ", "-", " ", 
     RowBox[{"kd", " ", 
      RowBox[{
      "x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"x_", ",", " ", "kp_", ",", " ", "kd_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"kp", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "2"}], "-", 
          RowBox[{
          "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
         ")"}]}], ")"}], " ", "+", " ", 
      RowBox[{"kd", " ", 
       RowBox[{"(", 
        RowBox[{"0", "-", 
         RowBox[{
         "x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}], 
        ")"}]}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"t_", ",", " ", "x_", ",", " ", 
      RowBox[{"kp_:", "0"}], ",", " ", 
      RowBox[{"kd_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"pump", " ", "\[Equal]", " ", "True"}], ",", " ", 
      RowBox[{"MotorInput", "[", 
       RowBox[{"mag", ",", " ", "x", ",", " ", "b", ",", " ", 
        RowBox[{"v", "[", 
         RowBox[{"x", ",", " ", "kp", ",", " ", "kd"}], "]"}]}], "]"}], ",", 
      " ", 
      RowBox[{"-", 
       RowBox[{"K", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
           "\[RightDoubleBracket]"}], " ", "-", " ", 
          RowBox[{"{", 
           RowBox[{"\[Pi]", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
         ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "verify", " ", "that", " ", "the", " ", "sign", " ", "is", " ", "correct",
      " ", "for", " ", "v"}], ",", " ", 
    RowBox[{"it", " ", "should", " ", "be", " ", "positive"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Chop", "@", 
    RowBox[{"Simplify", "@", 
     RowBox[{"First", "@", 
      RowBox[{"DynamicQnts", "[", 
       RowBox[{"mag", ",", " ", "x", ",", " ", 
        RowBox[{"MotorInput", "[", 
         RowBox[{"mag", ",", " ", "x", ",", " ", "b", ",", " ", "v"}], 
         "]"}]}], "]"}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pump", " ", "=", " ", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "8", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{
    RowBox[{"-", "1"}], "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"0", "\[Pi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
    "=", " ", 
    RowBox[{"0", "\[Pi]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", 
     RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", " ", "All", ",", " ", "3"}], 
       "\[RightDoubleBracket]"}]}], " ", 
     RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "ensure", " ", "that", " ", "constraints", " ", "are", " ", "satisfied"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Norm", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
     RowBox[{"x", "\[LeftDoubleBracket]", 
      RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], "]"}], " ", 
   "\[Equal]", "  ", "0"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kp", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kd", " ", "=", " ", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{
     RowBox[{"s_", "?", "NumericQ"}], ",", " ", "q_", ",", " ", "qd_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", " ", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"q", ",", "qd"}], "]"}]}], ";", " ", 
      RowBox[{"First", "@", 
       RowBox[{"DynamicQnts", "[", 
        RowBox[{"mag", ",", " ", "x", ",", " ", 
         RowBox[{"u", "[", 
          RowBox[{"s", ",", " ", "x", ",", " ", "kp", ",", " ", "kd"}], 
          "]"}]}], "]"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "q", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tsw", " ", "=", " ", "\[Infinity]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"catch", " ", "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"q", " ", "=", " ", 
    RowBox[{"q", "/.", 
     RowBox[{"First", "@", 
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"f", "[", 
            RowBox[{"s", ",", " ", 
             RowBox[{"q", "[", "s", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
          RowBox[{
           RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}], ",", " ", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "-", "\[Pi]"}], " ", 
             "\[Equal]", " ", "0"}], ",", " ", "\"\<StopIntegration\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "\[Pi]"}], " ", 
             "\[Equal]", " ", "0"}], ",", " ", "\"\<StopIntegration\>\""}], 
           "]"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "-", "catch"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             RowBox[{"pump", " ", "=", " ", "False"}], ";", " ", 
             "\"\<RemoveEvent\>\""}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WhenEvent", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ".", 
               RowBox[{"q", "[", "s", "]"}]}], "+", "catch"}], " ", 
             "\[Equal]", "   ", "0"}], ",", " ", 
            RowBox[{
             RowBox[{"tsw", " ", "=", " ", "s"}], ";", 
             RowBox[{"pump", " ", "=", " ", "False"}], ";", " ", 
             "\"\<RemoveEvent\>\""}]}], "]"}]}], "\[IndentingNewLine]", "}"}],
         ",", " ", "\[IndentingNewLine]", "q", ",", " ", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}]}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", "tsw", "\
\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", " ", "=", " ", 
   RowBox[{
    RowBox[{"q", "[", "\"\<Domain\>\"", "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"DrawGibbot", "[", 
    RowBox[{"mag", ",", " ", 
     RowBox[{"q", "[", "s", "]"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", " ", 
      RowBox[{"2.5", "L1"}]}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
   RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.629102572344222*^9, 3.629102616246416*^9}, {
   3.629102673889389*^9, 3.6291026757847357`*^9}, {3.629102707932582*^9, 
   3.629102724570407*^9}, {3.629102824212227*^9, 3.6291028515106297`*^9}, {
   3.629103458936345*^9, 3.6291034976568656`*^9}, 3.6291062660494623`*^9, {
   3.6291063315740194`*^9, 3.6291063522276955`*^9}, {3.6291366102133226`*^9, 
   3.6291366107096777`*^9}, 3.629136643988329*^9, {3.6291372660454154`*^9, 
   3.6291372709028816`*^9}, {3.6291383415458364`*^9, 
   3.6291383720585203`*^9}, {3.6291390979924393`*^9, 3.629139147196424*^9}, {
   3.6291391992364035`*^9, 3.629139229192713*^9}, {3.6291765125582294`*^9, 
   3.6291765172865906`*^9}, {3.629177725725466*^9, 3.6291777259075937`*^9}, {
   3.6293282671501536`*^9, 3.6293283058850317`*^9}, 3.6293295170504637`*^9, {
   3.629333934891714*^9, 3.6293339941893797`*^9}, {3.6293340285492115`*^9, 
   3.629334056815211*^9}, {3.6293340977845035`*^9, 3.6293341113471556`*^9}, {
   3.6293341942388697`*^9, 3.6293342335363126`*^9}, {3.6293347332929306`*^9, 
   3.6293347615745897`*^9}, {3.6293348669978657`*^9, 
   3.6293349089514947`*^9}, {3.6293349757805614`*^9, 3.629335033671955*^9}, {
   3.6293351113448687`*^9, 3.629335126798152*^9}, {3.6293359701187935`*^9, 
   3.6293361519805584`*^9}, {3.629337056883222*^9, 3.629337060602053*^9}, {
   3.629337190919478*^9, 3.6293372241542435`*^9}, {3.6293373715468507`*^9, 
   3.62933744793849*^9}, {3.629337537502183*^9, 3.629337579862133*^9}, {
   3.6293377090513124`*^9, 3.629337754317539*^9}, {3.6293378020369825`*^9, 
   3.6293378081464415`*^9}, {3.6293381656043015`*^9, 
   3.6293381689168615`*^9}, {3.6293383144812975`*^9, 
   3.6293383358409615`*^9}, {3.629482338782209*^9, 3.629482339269555*^9}, {
   3.629482444358246*^9, 3.6294824461835413`*^9}, 3.6294824873808217`*^9, {
   3.629482518515935*^9, 3.629482544523435*^9}, {3.629482589869665*^9, 
   3.6294827702617035`*^9}, {3.6294828729826837`*^9, 
   3.6294830743588376`*^9}, {3.629483136168738*^9, 3.6294831596624627`*^9}, {
   3.629484619658128*^9, 3.629484657839264*^9}, {3.6294905539597464`*^9, 
   3.629490557058961*^9}, 3.62949058708829*^9, {3.629490619586402*^9, 
   3.6294906876387568`*^9}, {3.6294907534325457`*^9, 
   3.6294907643873262`*^9}, {3.6294908273130283`*^9, 
   3.6294909984576793`*^9}, {3.629491030280282*^9, 3.6294910308747163`*^9}, {
   3.62949107109732*^9, 3.6294913174063816`*^9}, {3.6294913501066213`*^9, 
   3.62949138210036*^9}, {3.6294949768249083`*^9, 3.6294949769079523`*^9}, {
   3.6294992474005966`*^9, 3.629499278310549*^9}, {3.6294993197410135`*^9, 
   3.6294995141431646`*^9}, {3.6294995676181765`*^9, 
   3.6294996014982367`*^9}, {3.629499706259715*^9, 3.6294997882529964`*^9}, {
   3.6294998252422705`*^9, 3.6294999056494336`*^9}, 3.6294999543610477`*^9, {
   3.6294999939341526`*^9, 3.6294999941363087`*^9}, {3.62950002989371*^9, 
   3.629500035893975*^9}, {3.629500093936256*^9, 3.6295000998454423`*^9}, {
   3.6295003509299088`*^9, 3.6295003542052383`*^9}, {3.6295004409739056`*^9, 
   3.629500602462672*^9}, {3.629500637084278*^9, 3.629500638585352*^9}, 
   3.629500707095046*^9, {3.629500762646514*^9, 3.6295008022266536`*^9}, {
   3.6295008451201468`*^9, 3.629500915922449*^9}, {3.629500964685119*^9, 
   3.629500971789173*^9}, {3.629501006008494*^9, 3.6295010061165705`*^9}, {
   3.6295010904495077`*^9, 3.6295010931694136`*^9}, {3.6295011358807907`*^9, 
   3.6295011367093782`*^9}, {3.6295011864137135`*^9, 3.62950118917267*^9}, 
   3.629501230127781*^9, {3.629501378631328*^9, 3.6295013865279408`*^9}, {
   3.629501466785965*^9, 3.6295014704445553`*^9}, {3.6295016185278296`*^9, 
   3.629501638998379*^9}, 3.629501804837249*^9, {3.629501847519582*^9, 
   3.6295018481520314`*^9}, 3.629502142272071*^9, {3.62950220673889*^9, 
   3.6295022119956264`*^9}, {3.629502253739267*^9, 3.6295022636112833`*^9}, {
   3.629502306982129*^9, 3.6295023685759125`*^9}, {3.62950252145957*^9, 
   3.6295025495044966`*^9}, {3.6295028469919205`*^9, 
   3.6295029064051476`*^9}, {3.6295029408546467`*^9, 3.629502940903672*^9}, {
   3.6295029898114443`*^9, 3.6295030873517656`*^9}, {3.629503123961785*^9, 
   3.629503124027822*^9}, {3.6295031590717387`*^9, 3.629503159793256*^9}, {
   3.629503350772975*^9, 3.6295033636141176`*^9}, {3.6295035176716037`*^9, 
   3.629503525067839*^9}, {3.6295035906644897`*^9, 3.629503592926093*^9}, {
   3.6295036344005737`*^9, 3.629503637666895*^9}, {3.629503669960843*^9, 
   3.6295036736284513`*^9}, {3.629503714210288*^9, 3.6295037147216635`*^9}, 
   3.6295037471807303`*^9, {3.6295038196862593`*^9, 3.62950382032471*^9}, {
   3.629503896529877*^9, 3.6295039204408436`*^9}, {3.6295039549113665`*^9, 
   3.6295039944234457`*^9}, {3.6295040565916367`*^9, 3.629504326487461*^9}, {
   3.629504477708912*^9, 3.629504521959385*^9}, {3.629504626065366*^9, 
   3.629504809708902*^9}, {3.6295048955638933`*^9, 3.629504996104351*^9}, {
   3.6295051237631016`*^9, 3.6295052831273756`*^9}, 3.629505353708537*^9, {
   3.6295054742892237`*^9, 3.629505504706843*^9}, {3.629505542047398*^9, 
   3.6295055869783173`*^9}, {3.629505627147882*^9, 3.6295056331471453`*^9}, {
   3.6295056754702263`*^9, 3.629505682133956*^9}, {3.629505712695676*^9, 
   3.6295059725993996`*^9}, {3.6295061337809553`*^9, 3.629506408491209*^9}, {
   3.6295064409752865`*^9, 3.629506441268502*^9}, {3.629506479055352*^9, 
   3.6295066392591915`*^9}, {3.629506674209052*^9, 3.6295068401189785`*^9}, {
   3.6295069162460833`*^9, 3.629507054118059*^9}, {3.6295070941455235`*^9, 
   3.6295071105391626`*^9}, {3.6295071428661423`*^9, 
   3.6295072191573725`*^9}, {3.629507265107024*^9, 3.6295073623381376`*^9}, {
   3.62950752406207*^9, 3.6295080843752985`*^9}, 3.629508267606538*^9, {
   3.6295083036351376`*^9, 3.6295083423896766`*^9}, {3.629508377506647*^9, 
   3.629508421509922*^9}, {3.629508579062872*^9, 3.6295086209206495`*^9}, {
   3.6295086902809305`*^9, 3.629508837180337*^9}, {3.6295089356713533`*^9, 
   3.6295091214063597`*^9}, {3.6295091823576574`*^9, 3.629509227302618*^9}, {
   3.6295092577452526`*^9, 3.6295092738306885`*^9}, {3.6295093099843817`*^9, 
   3.62950931161654*^9}, {3.6295093534793015`*^9, 3.6295094498808165`*^9}, {
   3.6295094806556883`*^9, 3.6295094915834475`*^9}, {3.629509523024798*^9, 
   3.629509524574897*^9}, {3.6295095637637577`*^9, 3.629509657855632*^9}, {
   3.6295097393805676`*^9, 3.6295097394626245`*^9}, {3.6295097926554313`*^9, 
   3.6295098250824785`*^9}, {3.629509856424752*^9, 3.6295098789767833`*^9}, {
   3.6295099092392974`*^9, 3.6295099093013263`*^9}, {3.629509944009009*^9, 
   3.629509944070038*^9}, {3.6295099756965303`*^9, 3.6295100414052234`*^9}, {
   3.6295100824764147`*^9, 3.6295100825594654`*^9}, {3.6295101147803664`*^9, 
   3.6295101298940945`*^9}, {3.6295101942958965`*^9, 
   3.6295101988231077`*^9}, {3.6295102308008327`*^9, 3.629510243317732*^9}, {
   3.629510285299576*^9, 3.6295104585827255`*^9}, {3.6295104900751114`*^9, 
   3.629510556188098*^9}, {3.62951058988103*^9, 3.629510639001956*^9}, {
   3.6296718857346325`*^9, 3.6296718875627794`*^9}, 3.6296719269695234`*^9, {
   3.629671962985627*^9, 3.629671991111003*^9}, {3.6296720373616176`*^9, 
   3.62967206464323*^9}, 3.6296721109250965`*^9, {3.629672149425639*^9, 
   3.6296721710665207`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"K", " ", "=", " ", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Theta]", ",", " ", "x", ",", " ", "x1", ",", "x2", ",", "x3", ",", 
         "x4", ",", "x5", ",", "x6", ",", "x7", ",", "x8", ",", " ", "u", ",",
          " ", "rep"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "x3", ",", "x4", ",", "0", ",", "0", ",", "x7", 
           ",", "x8"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ".", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
         RowBox[{"-", 
          RowBox[{"GibbotQnts`Private`P3", "[", "x", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x3", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x4", "\[Rule]", " ", "\[Pi]"}], ",", " ", 
           RowBox[{"x7", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"x8", "\[Rule]", " ", "0"}], ",", " ", 
           RowBox[{"u", "\[Rule]", " ", "0"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Theta]", " ", "=", " ", 
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"{", 
           RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}], ",", " ", 
           RowBox[{"First", "@", 
            RowBox[{"DynamicQnts", "[", 
             RowBox[{"mag", ",", " ", "x", ",", " ", "u"}], "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "\[Theta]", "}"}]}], "]"}], "/.", " ", "rep"}], 
           " ", "//", " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"B", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"x", ",", " ", 
              RowBox[{"{", "u", "}"}]}], "]"}], "/.", " ", "rep"}], " ", "//",
            " ", "Simplify"}], " ", "//", " ", "Chop"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"x", " ", "=", " ", 
         RowBox[{"StateSpaceModel", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"B", "\[LeftDoubleBracket]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
               "\[RightDoubleBracket]"}], "}"}], "\[Transpose]"}], ",", " ", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"LQRegulatorGains", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "4", "]"}], ",", " ", 
            RowBox[{"IdentityMatrix", "[", "1", "]"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"t_", ",", " ", "x_", ",", " ", 
      RowBox[{"kp_:", "0"}], ",", " ", 
      RowBox[{"kd_:", "0"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"-", 
     RowBox[{"K", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "\[LeftDoubleBracket]", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "7", ",", "8"}], "}"}], 
         "\[RightDoubleBracket]"}], " ", "-", " ", 
        RowBox[{"{", 
         RowBox[{"\[Pi]", ",", "\[Pi]", ",", "0", ",", "0"}], "}"}]}], 
       ")"}]}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", " ", "=", " ", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", " ", "8"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}], " ", 
   "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], " ", 
   "=", " ", 
   RowBox[{"\[Pi]", " ", "-", " ", 
    RowBox[{"\[Pi]", "/", "10"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"x", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], " ", 
   "=", " ", "\[Pi]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "\[LeftDoubleBracket]", 
     RowBox[{"5", ";;", "6"}], "\[RightDoubleBracket]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"GibbotQnts`Private`J1", "[", "x", "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", " ", "All", ",", " ", "3"}], 
       "\[RightDoubleBracket]"}]}], " ", 
     RowBox[{"x", "\[LeftDoubleBracket]", "7", "\[RightDoubleBracket]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", " ", "=", " ", "5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Check", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "q", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"q", " ", "=", " ", 
     RowBox[{"q", "/.", 
      RowBox[{"First", "@", 
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"q", "''"}], "[", "s", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"f", "[", 
             RowBox[{"s", ",", " ", 
              RowBox[{"q", "[", "s", "]"}], ",", " ", 
              RowBox[{
               RowBox[{"q", "'"}], "[", "s", "]"}]}], "]"}]}], ",", " ", 
           RowBox[{
            RowBox[{"q", "[", "0", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"1", ";;", "4"}], "\[RightDoubleBracket]"}]}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"5", ";;", "8"}], "\[RightDoubleBracket]"}]}]}], "}"}], 
         ",", " ", "q", ",", " ", 
         RowBox[{"{", 
          RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}]}]}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Animate", "[", 
     RowBox[{
      RowBox[{"DrawGibbot", "[", 
       RowBox[{"mag", ",", " ", 
        RowBox[{"q", "[", "s", "]"}], ",", " ", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"2.5", "L1"}]}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"s", ",", " ", "0", ",", " ", "t"}], "}"}], ",", " ", 
      RowBox[{"AnimationRepetitions", "\[Rule]", "1"}]}], "]"}]}], ",", 
   "\[IndentingNewLine]", "\"\<NDSolve or Animate Failed.\>\""}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.629494374457761*^9, 3.6294944482462163`*^9}, {
   3.6294945064025493`*^9, 3.629494571884076*^9}, {3.6294946117254057`*^9, 
   3.629494612323839*^9}, {3.6294949485207815`*^9, 3.6294949535253487`*^9}, {
   3.629495016836317*^9, 3.629495074058013*^9}, {3.629495112521323*^9, 
   3.629495127961317*^9}, {3.6294951808919373`*^9, 3.6294952354236956`*^9}, {
   3.629495286185773*^9, 3.6294953167825136`*^9}, {3.6294953698272195`*^9, 
   3.629495380542836*^9}, {3.629495445283842*^9, 3.6294955032850747`*^9}, {
   3.6294955547486424`*^9, 3.6294956306766214`*^9}, {3.629495699591573*^9, 
   3.629495810453379*^9}, {3.6294958453601947`*^9, 3.629495879097166*^9}, {
   3.6294959340091934`*^9, 3.6294959498584757`*^9}, {3.6294960742538595`*^9, 
   3.629496107449472*^9}, {3.629496191860468*^9, 3.6294962264370394`*^9}, 
   3.62949652433075*^9, {3.6294966601703153`*^9, 3.629496698315421*^9}, 
   3.6294967676326747`*^9, {3.6294968843996677`*^9, 3.6294970789419394`*^9}, {
   3.629497112431743*^9, 3.6294971936724625`*^9}, 3.6294972273053665`*^9, {
   3.629497270286945*^9, 3.629497319080595*^9}, {3.62949743546131*^9, 
   3.6294974623904696`*^9}, {3.6294975127642727`*^9, 3.629497513097517*^9}, {
   3.629497812472268*^9, 3.6294978954702716`*^9}, {3.629497931042548*^9, 
   3.6294979957093353`*^9}, {3.6294980571319823`*^9, 
   3.6294980621265335`*^9}, {3.6294981257093678`*^9, 
   3.6294981435340347`*^9}, {3.629498225474272*^9, 3.629498229297993*^9}, {
   3.6294983057243185`*^9, 3.6294983065519056`*^9}, {3.6294983993988843`*^9, 
   3.6294985540698156`*^9}, {3.629498588176049*^9, 3.6294986184155474`*^9}, {
   3.629498686556981*^9, 3.6294987702274466`*^9}, {3.6294988013195443`*^9, 
   3.6294990090862193`*^9}, {3.62949907608383*^9, 3.629499096215144*^9}, {
   3.6294991365648174`*^9, 3.629499136650854*^9}, {3.629499180430971*^9, 
   3.6294992112499027`*^9}, {3.6295084503744373`*^9, 3.629508500371955*^9}}]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowSize->{783, 607},
WindowMargins->{{Automatic, 244}, {Automatic, 49}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 181, 2, 70, "Section"],
Cell[764, 26, 100174, 2425, 7354, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[100975, 2456, 148, 2, 56, "Section"],
Cell[101126, 2460, 6919, 178, 772, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[108082, 2643, 194, 3, 56, "Section"],
Cell[108279, 2648, 661, 20, 52, "Input"],
Cell[108943, 2670, 23551, 465, 1072, "Input"],
Cell[CellGroupData[{
Cell[132519, 3139, 13432, 187, 92, "Input"],
Cell[145954, 3328, 176, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146167, 3337, 16828, 292, 592, "Input"],
Cell[162998, 3631, 140, 2, 31, "Output"],
Cell[163141, 3635, 310, 7, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163488, 3647, 5870, 154, 192, "Input"],
Cell[169361, 3803, 27612, 467, 233, "Output"],
Cell[196976, 4272, 18765, 319, 230, "Output"],
Cell[215744, 4593, 14511, 249, 229, "Output"],
Cell[230258, 4844, 86, 1, 31, "Output"],
Cell[230347, 4847, 86, 1, 31, "Output"]
}, Open  ]],
Cell[230448, 4851, 2066, 55, 172, "Input"],
Cell[232517, 4908, 994, 25, 52, "Input"],
Cell[CellGroupData[{
Cell[233536, 4937, 1213, 31, 72, "Input"],
Cell[234752, 4970, 35029, 641, 512, "Output"]
}, Open  ]],
Cell[269796, 5614, 787, 21, 52, "Input"],
Cell[270586, 5637, 6557, 153, 572, "Input"],
Cell[277146, 5792, 1232, 30, 92, "Input"],
Cell[278381, 5824, 176, 3, 31, "Input"],
Cell[278560, 5829, 500, 12, 92, "Input"],
Cell[279063, 5843, 1463, 44, 112, "Input"],
Cell[280529, 5889, 116, 2, 31, "Input"],
Cell[280648, 5893, 129, 2, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280814, 5900, 248, 3, 70, "Section"],
Cell[281065, 5905, 22295, 490, 1392, "Input"],
Cell[303363, 6397, 10081, 227, 752, "Input"]
}, Closed]]
}
]
*)

(* End of internal cache information *)
