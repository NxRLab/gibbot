(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      7255,        174]
NotebookOptionsPosition[      6888,        156]
NotebookOutlinePosition[      7244,        172]
CellTagsIndexPosition[      7201,        169]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"x", "^", "2"}], "+", "3"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GradientDescent", "[", 
   RowBox[{
   "function_", ",", "maxSteps_", ",", "relTol_", ",", "absTol_", ",", "dx_", 
    ",", "x0_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xOld", " ", "=", " ", "x0"}], ",", 
      RowBox[{"xNew", " ", "=", " ", 
       RowBox[{"x0", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{"function", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
            RowBox[{"x", "\[Rule]", "x0"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"function", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
             RowBox[{"x", "\[Rule]", "x0"}]}], "]"}], ")"}]}], "*", 
         "dx"}]}]}], ",", 
      RowBox[{"steps", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"function", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
           RowBox[{"x", "->", "xNew"}]}], "]"}], ">", "absTol"}], " ", "&&", 
        " ", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"f", "[", "xNew", "]"}], "-", 
           RowBox[{"f", "[", "xOld", "]"}]}], "]"}], ">", "relTol"}], " ", "&&",
         " ", 
        RowBox[{"steps", "<", "maxSteps"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xOld", "=", "xNew"}], ";", "\[IndentingNewLine]", 
        RowBox[{"xNew", " ", "=", " ", 
         RowBox[{"xNew", "-", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{"function", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
              
              RowBox[{"x", "\[Rule]", "xOld"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"function", "[", "x", "]"}], ",", "x"}], "]"}], "/.", 
               RowBox[{"x", "\[Rule]", "xOld"}]}], "]"}], ")"}]}], "*", 
           "dx"}]}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"steps", "=", 
         RowBox[{"steps", "+", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"function", "[", "xNew", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.634145465237076*^9, 3.6341455036581783`*^9}, {
   3.634145534036117*^9, 3.6341455606811323`*^9}, {3.634145778391467*^9, 
   3.634145829793091*^9}, {3.634145908099123*^9, 3.634145913778664*^9}, {
   3.634145944472303*^9, 3.63414642212361*^9}, {3.63414646175471*^9, 
   3.634146481442926*^9}, 3.63423297383601*^9, {3.634233189800352*^9, 
   3.634233228997032*^9}, {3.63423378371227*^9, 3.6342338051356487`*^9}, {
   3.6342340294055243`*^9, 3.6342341045979137`*^9}, {3.634234248973949*^9, 
   3.6342342695659657`*^9}, {3.634234319154633*^9, 3.634234348300461*^9}, {
   3.634234427411244*^9, 3.634234465263917*^9}, {3.634234522984273*^9, 
   3.634234535398498*^9}, {3.634235691781375*^9, 3.634235701092815*^9}, {
   3.6342359169444523`*^9, 3.6342359173555613`*^9}, {3.634236095584503*^9, 
   3.634236155820835*^9}, {3.634236186594007*^9, 3.634236187318563*^9}, {
   3.6343009232872143`*^9, 3.634300923510458*^9}, {3.634300977525729*^9, 
   3.634300977710445*^9}, {3.63430107854685*^9, 3.634301079210514*^9}, {
   3.634301110251636*^9, 3.634301154175252*^9}, 3.634301257160409*^9, {
   3.634301444993949*^9, 3.634301457413505*^9}, {3.634301491270906*^9, 
   3.6343015119706507`*^9}, {3.634301577490032*^9, 3.634301607399365*^9}, {
   3.6343018870386057`*^9, 3.634301888025031*^9}, {3.634301969926115*^9, 
   3.634301970579125*^9}, {3.634302064344675*^9, 3.634302093042143*^9}, {
   3.634302135364777*^9, 3.634302216730817*^9}, {3.634302322825362*^9, 
   3.634302357878804*^9}, {3.634302403195318*^9, 3.634302430738124*^9}, {
   3.634307371692356*^9, 3.634307371804022*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GradientDescent", "[", 
  RowBox[{
  "f", ",", "50000", ",", "0.0001", ",", "0.0001", ",", "0.01", ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.634146424946411*^9, 3.634146452936459*^9}, {
   3.634232923104209*^9, 3.634232925391932*^9}, {3.634234139367728*^9, 
   3.634234139482345*^9}, {3.634236252686022*^9, 3.6342362675232687`*^9}, {
   3.6342680901873407`*^9, 3.634268142081863*^9}, {3.634268189995966*^9, 
   3.634268190084915*^9}, {3.634268260632001*^9, 3.634268260743516*^9}, {
   3.634268305446083*^9, 3.6342683271800137`*^9}, {3.634300898658813*^9, 
   3.634300913820449*^9}, {3.634300967542831*^9, 3.634300968242584*^9}, {
   3.634301019220169*^9, 3.634301027719171*^9}, {3.634301903231656*^9, 
   3.634301943698265*^9}, {3.634302191895253*^9, 3.63430219473313*^9}, 
   3.634302225891581*^9, {3.634302273193668*^9, 3.634302312133172*^9}, {
   3.634302377695986*^9, 3.634302398839926*^9}}],

Cell[BoxData["3.`"], "Output",
 CellChangeTimes->{
  3.634234487263803*^9, 3.634234528888488*^9, 3.634235941604138*^9, 
   3.634236167939827*^9, 3.63423621156665*^9, {3.6342362545075407`*^9, 
   3.6342362679904013`*^9}, {3.634268072540813*^9, 3.634268142593671*^9}, 
   3.634268191738484*^9, 3.6342682645890923`*^9, {3.6342682972208242`*^9, 
   3.634268341268056*^9}, {3.634300861382927*^9, 3.6343009309141293`*^9}, {
   3.634300973482802*^9, 3.6343010198902187`*^9}, {3.6343010858130293`*^9, 
   3.634301141019326*^9}, {3.634301260959447*^9, 3.6343012633768873`*^9}, {
   3.6343014663211308`*^9, 3.634301496209558*^9}, {3.634301540742989*^9, 
   3.63430154868988*^9}, {3.634301586316779*^9, 3.634301610624504*^9}, {
   3.63430195497687*^9, 3.6343019749487333`*^9}, {3.634302087787261*^9, 
   3.634302095648952*^9}, {3.634302143832502*^9, 3.6343022276557703`*^9}, {
   3.634302273854837*^9, 3.634302434296418*^9}, {3.6343073687255783`*^9, 
   3.6343073762173443`*^9}}]
}, Open  ]]
},
WindowSize->{1031, 755},
WindowMargins->{{Automatic, 74}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 4388, 98, 148, "Input"],
Cell[CellGroupData[{
Cell[4970, 122, 931, 15, 28, "Input"],
Cell[5904, 139, 968, 14, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
